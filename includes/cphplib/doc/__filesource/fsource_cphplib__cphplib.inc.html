<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
  <html xmlns="http://www.w3.org/1999/xhtml">
		<head>
			<!-- template designed by Marco Von Ballmoos -->
			<title>File Source for cphplib.inc</title>
			<link rel="stylesheet" href="../media/stylesheet.css" />
			<meta http-equiv='Content-Type' content='text/html; charset=iso-8859-1'/>
		</head>
		<body>
						<h1>Source for file cphplib.inc</h1>
<p>Documentation is available at <a href="../cphplib/_cphplib_inc.html">cphplib.inc</a></p>
<div class="src-code">
<pre><ol><li><a name="a1"></a><span class="src-php">&lt;?php</span></li>
<li><a name="a2"></a><span class="src-doc">/**</span></li>
<li><a name="a3"></a><span class="src-doc"> * cphplib is a PHP-functions library. Those could simply be integrated into existing PHP-Scripts and allow an easy use.</span></li>
<li><a name="a4"></a><span class="src-doc"> * These functions are very flexible to use because they are kept very common.</span></li>
<li><a name="a5"></a><span class="src-doc"> *</span></li>
<li><a name="a6"></a><span class="src-doc"> * PHP versions 4 and 5</span></li>
<li><a name="a7"></a><span class="src-doc"> *</span></li>
<li><a name="a8"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@category</span><span class="src-doc">    Utilities</span></li>
<li><a name="a9"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@package</span><span class="src-doc">        cphplib</span></li>
<li><a name="a10"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc">        Alexander Meindl &lt;am@meindlsoft.com&gt;</span></li>
<li><a name="a11"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@author</span><span class="src-doc">        Sven Reul &lt;heffer@quaddamage.de&gt;</span></li>
<li><a name="a12"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@copyright</span><span class="src-doc">    (c) 2002-2005 meindlSOFT</span></li>
<li><a name="a13"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@license</span><span class="src-doc">        Released under v2 of the GNU LGPL</span></li>
<li><a name="a14"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@version</span><span class="src-doc">        Version 0.50 CVS: $Id: cphplib.inc,v 1.20 2005/11/11 09:12:25 alex Exp $</span></li>
<li><a name="a15"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@link</span><span class="src-doc">        http://www.meindlsoft.com/tools.php</span></li>
<li><a name="a16"></a><span class="src-doc"> */</span></li>
<li><a name="a17"></a>&nbsp;</li>
<li><a name="a18"></a>&nbsp;</li>
<li><a name="a19"></a><span class="src-doc">/**</span></li>
<li><a name="a20"></a><span class="src-doc"> * Replacement for useless PHP empty function</span></li>
<li><a name="a21"></a><span class="src-doc"> * Returns true, if string is empty</span></li>
<li><a name="a22"></a><span class="src-doc"> *</span></li>
<li><a name="a23"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   string to validate</span></li>
<li><a name="a24"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   true for compatible with echo {default: false}</span></li>
<li><a name="a25"></a><span class="src-doc"> * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a26"></a><span class="src-doc"> */</span></li>
<li><a name="a27"></a><span class="src-key">function </span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a28"></a><span class="src-sym">{</span></li>
<li><a name="a29"></a>    <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a30"></a>&nbsp;</li>
<li><a name="a31"></a>    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">))</span></li>
<li><a name="a32"></a>    <span class="src-sym">{</span></li>
<li><a name="a33"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a34"></a>        <span class="src-sym">{</span></li>
<li><a name="a35"></a>            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a36"></a>        <span class="src-sym">}</span></li>
<li><a name="a37"></a>    <span class="src-sym">}</span></li>
<li><a name="a38"></a>    <span class="src-key">else</span></li>
<li><a name="a39"></a>    <span class="src-sym">{</span></li>
<li><a name="a40"></a>        <span class="src-var">$str </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a41"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a42"></a>        <span class="src-sym">{</span></li>
<li><a name="a43"></a>            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a44"></a>        <span class="src-sym">}</span></li>
<li><a name="a45"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$str</span>==<span class="src-str">&quot;0&quot;</span><span class="src-sym">))</span></li>
<li><a name="a46"></a>        <span class="src-sym">{</span></li>
<li><a name="a47"></a>            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a48"></a>        <span class="src-sym">}</span></li>
<li><a name="a49"></a>    <span class="src-sym">}</span></li>
<li><a name="a50"></a>&nbsp;</li>
<li><a name="a51"></a>    <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a52"></a><span class="src-sym">}</span></li>
<li><a name="a53"></a>&nbsp;</li>
<li><a name="a54"></a><span class="src-doc">/**</span></li>
<li><a name="a55"></a><span class="src-doc"> * cphplib class</span></li>
<li><a name="a56"></a><span class="src-doc"> */</span></li>
<li><a name="a57"></a><span class="src-key">class </span><a href="../cphplib/cphplib.html">cphplib</a></li>
<li><a name="a58"></a><span class="src-sym">{</span></li>
<li><a name="a59"></a>    <span class="src-doc">/**</span></li>
<li><a name="a60"></a><span class="src-doc">     * cphplib version</span></li>
<li><a name="a61"></a><span class="src-doc">     *</span></li>
<li><a name="a62"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a63"></a><span class="src-doc">     */</span></li>
<li><a name="a64"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$version">$version</a> = <span class="src-str">&quot;0.50&quot;</span><span class="src-sym">;</span></li>
<li><a name="a65"></a>&nbsp;</li>
<li><a name="a66"></a>    <span class="src-doc">/**</span></li>
<li><a name="a67"></a><span class="src-doc">     * Error level</span></li>
<li><a name="a68"></a><span class="src-doc">     *    0: show no error message</span></li>
<li><a name="a69"></a><span class="src-doc">     *  1: only print message</span></li>
<li><a name="a70"></a><span class="src-doc">     *  2: die, if error occurres</span></li>
<li><a name="a71"></a><span class="src-doc">     *  3: user defined function (callback) =&gt; error_user_function required</span></li>
<li><a name="a72"></a><span class="src-doc">     *</span></li>
<li><a name="a73"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a74"></a><span class="src-doc">     */</span></li>
<li><a name="a75"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$error_level">$error_level</a> = <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a76"></a>&nbsp;</li>
<li><a name="a77"></a>    <span class="src-doc">/**</span></li>
<li><a name="a78"></a><span class="src-doc">     * User defined function</span></li>
<li><a name="a79"></a><span class="src-doc">     *</span></li>
<li><a name="a80"></a><span class="src-doc">     * Required for error_level=3</span></li>
<li><a name="a81"></a><span class="src-doc">     *</span></li>
<li><a name="a82"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span></li>
<li><a name="a83"></a><span class="src-doc">     */</span></li>
<li><a name="a84"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$error_user_function">$error_user_function</a><span class="src-sym">;</span></li>
<li><a name="a85"></a>&nbsp;</li>
<li><a name="a86"></a>    <span class="src-doc">/**</span></li>
<li><a name="a87"></a><span class="src-doc">     * Date format</span></li>
<li><a name="a88"></a><span class="src-doc">     *</span></li>
<li><a name="a89"></a><span class="src-doc">     *    I    = International date identifier (MM/DD/YYYY)</span></li>
<li><a name="a90"></a><span class="src-doc">     *  S    = Science date identifier (YYYY-MM-DD)</span></li>
<li><a name="a91"></a><span class="src-doc">     *  C    = Date without seperators (YYYYMMDD)</span></li>
<li><a name="a92"></a><span class="src-doc">     *  L    = German date identifier (DD.MM.YYYY)</span></li>
<li><a name="a93"></a><span class="src-doc">     *</span></li>
<li><a name="a94"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">char </span></li>
<li><a name="a95"></a><span class="src-doc">     */</span></li>
<li><a name="a96"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$date_format">$date_format</a><span class="src-sym">;</span></li>
<li><a name="a97"></a>&nbsp;</li>
<li><a name="a98"></a>    <span class="src-doc">/**</span></li>
<li><a name="a99"></a><span class="src-doc">     * Time format</span></li>
<li><a name="a100"></a><span class="src-doc">     *</span></li>
<li><a name="a101"></a><span class="src-doc">     *    Y = 24 hours mode</span></li>
<li><a name="a102"></a><span class="src-doc">     *    N = 12 hours mode</span></li>
<li><a name="a103"></a><span class="src-doc">     *</span></li>
<li><a name="a104"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">char </span></li>
<li><a name="a105"></a><span class="src-doc">     */</span></li>
<li><a name="a106"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$time_format">$time_format</a><span class="src-sym">;</span></li>
<li><a name="a107"></a>&nbsp;</li>
<li><a name="a108"></a>    <span class="src-doc">/**</span></li>
<li><a name="a109"></a><span class="src-doc">     * locale to use (see &quot;man locale&quot;)</span></li>
<li><a name="a110"></a><span class="src-doc">     *</span></li>
<li><a name="a111"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a112"></a><span class="src-doc">     */</span></li>
<li><a name="a113"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$locale">$locale</a><span class="src-sym">;</span></li>
<li><a name="a114"></a>&nbsp;</li>
<li><a name="a115"></a>    <span class="src-doc">/**</span></li>
<li><a name="a116"></a><span class="src-doc">     * xhtml output</span></li>
<li><a name="a117"></a><span class="src-doc">     *</span></li>
<li><a name="a118"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a119"></a><span class="src-doc">     */</span></li>
<li><a name="a120"></a>    <span class="src-key">var    </span><a href="../cphplib/cphplib.html#var$xhtml">$xhtml</a> = <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a121"></a>&nbsp;</li>
<li><a name="a122"></a>    <span class="src-doc">/**</span></li>
<li><a name="a123"></a><span class="src-doc">     * Max. entries on one page of a list</span></li>
<li><a name="a124"></a><span class="src-doc">     *</span></li>
<li><a name="a125"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a126"></a><span class="src-doc">     */</span></li>
<li><a name="a127"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$page_entries">$page_entries</a> = <span class="src-num">20</span><span class="src-sym">;</span></li>
<li><a name="a128"></a>&nbsp;</li>
<li><a name="a129"></a>    <span class="src-doc">/**</span></li>
<li><a name="a130"></a><span class="src-doc">     * Type of database</span></li>
<li><a name="a131"></a><span class="src-doc">     *</span></li>
<li><a name="a132"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a133"></a><span class="src-doc">     */</span></li>
<li><a name="a134"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$db_type">$db_type</a><span class="src-sym">;</span></li>
<li><a name="a135"></a>&nbsp;</li>
<li><a name="a136"></a>    <span class="src-doc">/**</span></li>
<li><a name="a137"></a><span class="src-doc">     * Database pear object</span></li>
<li><a name="a138"></a><span class="src-doc">     * (mysql or pgsql)</span></li>
<li><a name="a139"></a><span class="src-doc">     *</span></li>
<li><a name="a140"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">resource </span></li>
<li><a name="a141"></a><span class="src-doc">     */</span></li>
<li><a name="a142"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$db">$db</a><span class="src-sym">;</span></li>
<li><a name="a143"></a>&nbsp;</li>
<li><a name="a144"></a>    <span class="src-doc">/**</span></li>
<li><a name="a145"></a><span class="src-doc">     * like not case sensitive for SQL</span></li>
<li><a name="a146"></a><span class="src-doc">     *</span></li>
<li><a name="a147"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">resource </span></li>
<li><a name="a148"></a><span class="src-doc">     */</span></li>
<li><a name="a149"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$sql_like">$sql_like</a><span class="src-sym">;</span></li>
<li><a name="a150"></a>&nbsp;</li>
<li><a name="a151"></a>    <span class="src-doc">/**</span></li>
<li><a name="a152"></a><span class="src-doc">     * International seperator</span></li>
<li><a name="a153"></a><span class="src-doc">     *</span></li>
<li><a name="a154"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">char </span></li>
<li><a name="a155"></a><span class="src-doc">     */</span></li>
<li><a name="a156"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_sep_i">$m_sep_i</a>         = <span class="src-str">&quot;/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a157"></a>&nbsp;</li>
<li><a name="a158"></a>    <span class="src-doc">/**</span></li>
<li><a name="a159"></a><span class="src-doc">     * Science seperator</span></li>
<li><a name="a160"></a><span class="src-doc">     *</span></li>
<li><a name="a161"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">char </span></li>
<li><a name="a162"></a><span class="src-doc">     */</span></li>
<li><a name="a163"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_sep_s">$m_sep_s</a>         = <span class="src-str">&quot;-&quot;</span><span class="src-sym">;</span></li>
<li><a name="a164"></a>&nbsp;</li>
<li><a name="a165"></a>    <span class="src-doc">/**</span></li>
<li><a name="a166"></a><span class="src-doc">     * German seperator</span></li>
<li><a name="a167"></a><span class="src-doc">     *</span></li>
<li><a name="a168"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">char </span></li>
<li><a name="a169"></a><span class="src-doc">     */</span></li>
<li><a name="a170"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_sep_l">$m_sep_l</a>         = <span class="src-str">&quot;.&quot;</span><span class="src-sym">;</span></li>
<li><a name="a171"></a>&nbsp;</li>
<li><a name="a172"></a>    <span class="src-doc">/**</span></li>
<li><a name="a173"></a><span class="src-doc">     * Image URL to all images</span></li>
<li><a name="a174"></a><span class="src-doc">     *</span></li>
<li><a name="a175"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a176"></a><span class="src-doc">     */</span></li>
<li><a name="a177"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$image_url">$image_url</a>        = <span class="src-str">&quot;images&quot;</span><span class="src-sym">;</span></li>
<li><a name="a178"></a>&nbsp;</li>
<li><a name="a179"></a>    <span class="src-comm">// db session variables</span></li>
<li><a name="a179"></a>    </li>
<li><a name="a180"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_handler">$m_dbsession_handler</a>      = <span class="src-id">false</span><span class="src-sym">;              </span><span class="src-comm">// must be true for handling session_id</span></li>
<li><a name="a180"></a>    </li>
<li><a name="a181"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_id">$m_dbsession_id</a>           = <span class="src-str">&quot;&quot;</span><span class="src-sym">;                 </span><span class="src-comm">// dbsession ID</span></li>
<li><a name="a181"></a>    </li>
<li><a name="a182"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">$m_dbsession_id_name</a>      = <span class="src-str">&quot;SID&quot;</span><span class="src-sym">;              </span><span class="src-comm">// dbsession ID name</span></li>
<li><a name="a182"></a>    </li>
<li><a name="a183"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_table">$m_dbsession_table</a>        = <span class="src-str">&quot;dbsession&quot;</span><span class="src-sym">;        </span><span class="src-comm">// table name for dbsession use</span></li>
<li><a name="a183"></a>    </li>
<li><a name="a184"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">$m_dbsession_detail_table</a> = <span class="src-str">&quot;dbsession_detail&quot;</span><span class="src-sym">; </span><span class="src-comm">// table name for dbsession use</span></li>
<li><a name="a184"></a>    </li>
<li><a name="a185"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_timeout">$m_dbsession_timeout</a>      = <span class="src-num">60</span><span class="src-sym">;                 </span><span class="src-comm">// dbsession timeout</span></li>
<li><a name="a186"></a>&nbsp;</li>
<li><a name="a185"></a>    </li>
<li><a name="a186"></a>&nbsp;</li>
<li><a name="a187"></a>    <span class="src-doc">/**</span></li>
<li><a name="a188"></a><span class="src-doc">     * cookies can be used for dbsession</span></li>
<li><a name="a189"></a><span class="src-doc">     *</span></li>
<li><a name="a190"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">bool </span></li>
<li><a name="a191"></a><span class="src-doc">     */</span></li>
<li><a name="a192"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$m_dbsession_cookies">$m_dbsession_cookies</a>      = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a193"></a>&nbsp;</li>
<li><a name="a194"></a>    <span class="src-doc">/**</span></li>
<li><a name="a195"></a><span class="src-doc">     * take special care for mod_rewrite</span></li>
<li><a name="a196"></a><span class="src-doc">     *</span></li>
<li><a name="a197"></a><span class="src-doc">     * at the moment only url() is supported</span></li>
<li><a name="a198"></a><span class="src-doc">     *</span></li>
<li><a name="a199"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@var </span><span class="src-doc-type">bool </span></li>
<li><a name="a200"></a><span class="src-doc">     */</span></li>
<li><a name="a201"></a>    <span class="src-key">var </span><a href="../cphplib/cphplib.html#var$mod_rewrite">$mod_rewrite</a> = <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a202"></a>&nbsp;</li>
<li><a name="a203"></a>    <span class="src-doc">/**</span></li>
<li><a name="a204"></a><span class="src-doc">     * constructor</span></li>
<li><a name="a205"></a><span class="src-doc">     *</span></li>
<li><a name="a206"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$locale </span><span class="src-doc">       if no empty, locale and string will be initialised</span></li>
<li><a name="a207"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">cphplib </span></li>
<li><a name="a208"></a><span class="src-doc">     */</span></li>
<li><a name="a209"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcphplib">cphplib</a><span class="src-sym">(</span><span class="src-var">$locale</span>=<span class="src-str">&quot;de_DE&quot;</span><span class="src-sym">)</span></li>
<li><a name="a210"></a>    <span class="src-sym">{</span></li>
<li><a name="a211"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$locale</span><span class="src-sym">))</span></li>
<li><a name="a212"></a>        <span class="src-sym">{</span></li>
<li><a name="a213"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$locale">locale</a> = <span class="src-var">$locale</span><span class="src-sym">;</span></li>
<li><a name="a214"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodset_locale">set_locale</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a215"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodset_strings">set_strings</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a216"></a>        <span class="src-sym">}</span></li>
<li><a name="a217"></a>    <span class="src-sym">}</span></li>
<li><a name="a218"></a>&nbsp;</li>
<li><a name="a219"></a>    <span class="src-doc">/**</span></li>
<li><a name="a220"></a><span class="src-doc">     * Set locale</span></li>
<li><a name="a221"></a><span class="src-doc">     *</span></li>
<li><a name="a222"></a><span class="src-doc">     */</span></li>
<li><a name="a223"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodset_locale">set_locale</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a224"></a>    <span class="src-sym">{</span></li>
<li><a name="a225"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$locale">locale</a>==<span class="src-str">&quot;de_DE&quot;</span><span class="src-sym">)</span></li>
<li><a name="a226"></a>        <span class="src-sym">{</span></li>
<li><a name="a227"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a> = <span class="src-str">&quot;L&quot;</span><span class="src-sym">;</span></li>
<li><a name="a228"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a> = <span class="src-str">&quot;Y&quot;</span><span class="src-sym">;</span></li>
<li><a name="a229"></a>&nbsp;</li>
<li><a name="a230"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodcheck_php_version">check_php_version</a><span class="src-sym">(</span><span class="src-str">&quot;4.3.0&quot;</span><span class="src-sym">))</span></li>
<li><a name="a231"></a>            <span class="src-sym">{</span></li>
<li><a name="a232"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-str">'de_DE@euro'</span><span class="src-sym">, </span><span class="src-str">'de_DE'</span><span class="src-sym">, </span><span class="src-str">'german'</span><span class="src-sym">, </span><span class="src-str">'deu'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a233"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_CTYPE</span><span class="src-sym">, </span><span class="src-str">'de_DE@euro'</span><span class="src-sym">, </span><span class="src-str">'de_DE'</span><span class="src-sym">, </span><span class="src-str">'german'</span><span class="src-sym">, </span><span class="src-str">'deu'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a234"></a>            <span class="src-sym">}</span></li>
<li><a name="a235"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodos_type">os_type</a><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">) </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">)</span></li>
<li><a name="a236"></a>            <span class="src-sym">{</span></li>
<li><a name="a237"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-str">'german'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a238"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_CTYPE</span><span class="src-sym">, </span><span class="src-str">'german'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a239"></a>            <span class="src-sym">}</span></li>
<li><a name="a240"></a>            <span class="src-key">else</span></li>
<li><a name="a241"></a>            <span class="src-sym">{</span></li>
<li><a name="a242"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-str">'de_DE'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a243"></a>                <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_CTYPE</span><span class="src-sym">, </span><span class="src-str">'de_DE'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a244"></a>            <span class="src-sym">}</span></li>
<li><a name="a245"></a>        <span class="src-sym">}</span></li>
<li><a name="a246"></a>        <span class="src-key">else</span></li>
<li><a name="a247"></a>        <span class="src-sym">{</span></li>
<li><a name="a248"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodset_format">set_format</a><span class="src-sym">(</span><span class="src-str">&quot;I&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;N&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a249"></a>&nbsp;</li>
<li><a name="a250"></a>            <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$locale">locale</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a251"></a>               <a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_CTYPE</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$locale">locale</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a252"></a>        <span class="src-sym">}</span></li>
<li><a name="a253"></a>    <span class="src-sym">}</span></li>
<li><a name="a254"></a>&nbsp;</li>
<li><a name="a255"></a>    <span class="src-doc">/**</span></li>
<li><a name="a256"></a><span class="src-doc">     * Set date and time format to cphplib</span></li>
<li><a name="a257"></a><span class="src-doc">     *</span></li>
<li><a name="a258"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$date_format </span><span class="src-doc">   see $this-&gt;date_format for valid values</span></li>
<li><a name="a259"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$time_format </span><span class="src-doc">   see $this-&gt;time_format for valid values</span></li>
<li><a name="a260"></a><span class="src-doc">     */</span></li>
<li><a name="a261"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodset_format">set_format</a><span class="src-sym">(</span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-var">$time_format</span><span class="src-sym">)</span></li>
<li><a name="a262"></a>    <span class="src-sym">{</span></li>
<li><a name="a263"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a> = <span class="src-var">$date_format</span><span class="src-sym">;</span></li>
<li><a name="a264"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a> = <span class="src-var">$time_format</span><span class="src-sym">;</span></li>
<li><a name="a265"></a>    <span class="src-sym">}</span></li>
<li><a name="a266"></a>&nbsp;</li>
<li><a name="a267"></a>    <span class="src-doc">/**</span></li>
<li><a name="a268"></a><span class="src-doc">     * Set strings for pager and Date methods</span></li>
<li><a name="a269"></a><span class="src-doc">     *</span></li>
<li><a name="a270"></a><span class="src-doc">     */</span></li>
<li><a name="a271"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodset_strings">set_strings</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a272"></a>    <span class="src-sym">{</span></li>
<li><a name="a273"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$locale">locale</a><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">2</span><span class="src-sym">) </span>==<span class="src-str">&quot;de&quot;</span><span class="src-sym">)</span></li>
<li><a name="a274"></a>        <span class="src-sym">{</span></li>
<li><a name="a275"></a>            <span class="src-inc">include_once</span><span class="src-sym">(</span><span class="src-str">&quot;i18n/german.inc&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a276"></a>        <span class="src-sym">}</span></li>
<li><a name="a277"></a>        <span class="src-key">else</span></li>
<li><a name="a278"></a>        <span class="src-sym">{</span></li>
<li><a name="a279"></a>            <span class="src-inc">include_once</span><span class="src-sym">(</span><span class="src-str">&quot;i18n/english.inc&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a280"></a>        <span class="src-sym">}</span></li>
<li><a name="a281"></a>    <span class="src-sym">}</span></li>
<li><a name="a282"></a>&nbsp;</li>
<li><a name="a283"></a>    <span class="src-doc">/**</span></li>
<li><a name="a284"></a><span class="src-doc">     * Opens a connection to a database server and select database</span></li>
<li><a name="a285"></a><span class="src-doc">     * Furthermore it sets $this-&gt;db to the PEAR database object,</span></li>
<li><a name="a286"></a><span class="src-doc">     * which is required for dbsession</span></li>
<li><a name="a287"></a><span class="src-doc">     *</span></li>
<li><a name="a288"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dsn </span><span class="src-doc">   Data Source Name ( for more information see PEAR documentation)</span></li>
<li><a name="a289"></a><span class="src-doc">     *                             addon array key:</span></li>
<li><a name="a290"></a><span class="src-doc">     *                                 persistent    = true for persistent {default: false}</span></li>
<li><a name="a291"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">    </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$set_db </span><span class="src-doc">   if true, db object will be set to $this-&gt;db</span></li>
<li><a name="a292"></a><span class="src-doc">     *                             (and db_tyle and sql_like, too)</span></li>
<li><a name="a293"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">object </span><span class="src-doc">           </span><span class="src-doc-type">PEAR </span><span class="src-doc">database object</span></li>
<li><a name="a294"></a><span class="src-doc">     */</span></li>
<li><a name="a295"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_connect">db_connect</a><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">, </span><span class="src-var">$set_db</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a296"></a>    <span class="src-sym">{</span></li>
<li><a name="a297"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-str">&quot;DB.php&quot;</span><span class="src-sym">))</span></li>
<li><a name="a298"></a>        <span class="src-sym">{</span></li>
<li><a name="a299"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-sym">(</span><a href="http://www.php.net/extension_loaded">extension_loaded</a><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span><span class="src-sym">))))</span></li>
<li><a name="a300"></a>            <span class="src-sym">{</span></li>
<li><a name="a301"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_connect&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;PHP database module &amp;quot;&quot;</span>.<span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;quot; is not supported by your system.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a302"></a>            <span class="src-sym">}</span></li>
<li><a name="a303"></a>&nbsp;</li>
<li><a name="a304"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;DB.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a305"></a>        <span class="src-sym">}</span></li>
<li><a name="a306"></a>        <span class="src-key">else</span></li>
<li><a name="a307"></a>        <span class="src-sym">{</span></li>
<li><a name="a308"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_connect&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Pear \&quot;DB Package\&quot; required.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a309"></a>        <span class="src-sym">}</span></li>
<li><a name="a310"></a>&nbsp;</li>
<li><a name="a311"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'persistent'</span><span class="src-sym">]</span><span class="src-sym">)    </span><span class="src-var">$db </span>=<span class="src-sym">&amp; </span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">connect</span><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">, </span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a312"></a>        <span class="src-key">else                    </span><span class="src-var">$db </span>=<span class="src-sym">&amp; </span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">connect</span><span class="src-sym">(</span><span class="src-var">$dsn </span><span class="src-sym">,</span><span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a313"></a>&nbsp;</li>
<li><a name="a314"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$db</span><span class="src-sym">))</span></li>
<li><a name="a315"></a>        <span class="src-sym">{</span></li>
<li><a name="a316"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_connect&quot;</span><span class="src-sym">, </span><span class="src-var">$db</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$db</span><span class="src-sym">-&gt;</span><span class="src-id">getCode</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a317"></a>        <span class="src-sym">}</span></li>
<li><a name="a318"></a>&nbsp;</li>
<li><a name="a319"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$set_db</span><span class="src-sym">)</span></li>
<li><a name="a320"></a>        <span class="src-sym">{</span></li>
<li><a name="a321"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a> =<span class="src-sym">&amp; </span><span class="src-var">$db</span><span class="src-sym">;</span></li>
<li><a name="a322"></a>&nbsp;</li>
<li><a name="a323"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span>==<span class="src-str">&quot;mysqli&quot;</span><span class="src-sym">)    </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db_type">db_type</a> = <span class="src-str">&quot;mysql&quot;</span><span class="src-sym">;</span></li>
<li><a name="a324"></a>            <span class="src-key">else                            </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db_type">db_type</a> = <span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a325"></a>&nbsp;</li>
<li><a name="a326"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$dsn</span><span class="src-sym">[</span><span class="src-str">'phptype'</span><span class="src-sym">]</span>==<span class="src-str">&quot;pgsql&quot;</span><span class="src-sym">)    </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$sql_like">sql_like</a> = <span class="src-str">&quot;ILIKE&quot;</span><span class="src-sym">;</span></li>
<li><a name="a327"></a>            <span class="src-key">else                            </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$sql_like">sql_like</a> = <span class="src-str">&quot;LIKE&quot;</span><span class="src-sym">;</span></li>
<li><a name="a328"></a>        <span class="src-sym">}</span></li>
<li><a name="a329"></a>&nbsp;</li>
<li><a name="a330"></a>        <span class="src-key">return </span><span class="src-var">$db</span><span class="src-sym">;</span></li>
<li><a name="a331"></a>    <span class="src-sym">}</span></li>
<li><a name="a332"></a>&nbsp;</li>
<li><a name="a333"></a>    <span class="src-doc">/**</span></li>
<li><a name="a334"></a><span class="src-doc">     * disconnect current database connection</span></li>
<li><a name="a335"></a><span class="src-doc">     *             (change $this-&gt;db for select the right one, if you</span></li>
<li><a name="a336"></a><span class="src-doc">     *              use more the one connection)</span></li>
<li><a name="a337"></a><span class="src-doc">     *</span></li>
<li><a name="a338"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">bool </span><span class="src-doc">       true if no errors occurred, otherwise false</span></li>
<li><a name="a339"></a><span class="src-doc">     */</span></li>
<li><a name="a340"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_close">db_close</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a341"></a>    <span class="src-sym">{</span></li>
<li><a name="a342"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a343"></a>        <span class="src-sym">{</span></li>
<li><a name="a344"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_close&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a345"></a>        <span class="src-sym">}</span></li>
<li><a name="a346"></a>&nbsp;</li>
<li><a name="a347"></a>        <span class="src-key">return </span><span class="src-sym">@ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">disconnect</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a348"></a>    <span class="src-sym">}</span></li>
<li><a name="a349"></a>&nbsp;</li>
<li><a name="a350"></a>    <span class="src-doc">/**</span></li>
<li><a name="a351"></a><span class="src-doc">     * Get the id generated from the previous INSERT operation</span></li>
<li><a name="a352"></a><span class="src-doc">     *</span></li>
<li><a name="a353"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a354"></a><span class="src-doc">     */</span></li>
<li><a name="a355"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_insert_id">db_insert_id</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a356"></a>    <span class="src-sym">{</span></li>
<li><a name="a357"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a358"></a>        <span class="src-sym">{</span></li>
<li><a name="a359"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_insert_id&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a360"></a>        <span class="src-sym">}</span></li>
<li><a name="a361"></a>&nbsp;</li>
<li><a name="a362"></a>        <span class="src-var">$rc </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-str">&quot;SELECT last_insert_id()&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a363"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">))</span></li>
<li><a name="a364"></a>        <span class="src-sym">{</span></li>
<li><a name="a365"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_insert_id&quot;</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a366"></a>        <span class="src-sym">}</span></li>
<li><a name="a367"></a>&nbsp;</li>
<li><a name="a368"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a369"></a>    <span class="src-sym">}</span></li>
<li><a name="a370"></a>&nbsp;</li>
<li><a name="a371"></a>    <span class="src-doc">/**</span></li>
<li><a name="a372"></a><span class="src-doc">     * Get next available number</span></li>
<li><a name="a373"></a><span class="src-doc">     *</span></li>
<li><a name="a374"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$table </span><span class="src-doc">       database table to use</span></li>
<li><a name="a375"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$column </span><span class="src-doc">       database column to use</span></li>
<li><a name="a376"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$where </span><span class="src-doc">       SQL WHERE restriction, e.g. &quot;thisvalue&gt;0&quot;</span></li>
<li><a name="a377"></a><span class="src-doc">     *                                 (without &quot;WHERE&quot; in string!)</span></li>
<li><a name="a378"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">                   highst number in column + 1</span></li>
<li><a name="a379"></a><span class="src-doc">     */</span></li>
<li><a name="a380"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_next_id">db_next_id</a><span class="src-sym">(</span><span class="src-var">$table</span><span class="src-sym">, </span><span class="src-var">$column</span><span class="src-sym">, </span><span class="src-var">$where</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a381"></a>    <span class="src-sym">{</span></li>
<li><a name="a382"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a383"></a>        <span class="src-sym">{</span></li>
<li><a name="a384"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_next_id&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a385"></a>        <span class="src-sym">}</span></li>
<li><a name="a386"></a>&nbsp;</li>
<li><a name="a387"></a>        <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">SELECT</span> <span class="src-id">MAX</span>(<span class="src-var">$column</span>)+1 <span class="src-id">FROM</span> <span class="src-var">$table</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a388"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$where</span><span class="src-sym">)) </span><span class="src-var">$sqlstr </span>.= <span class="src-str">&quot; WHERE &quot;</span>.<span class="src-var">$where</span><span class="src-sym">;</span></li>
<li><a name="a389"></a>&nbsp;</li>
<li><a name="a390"></a>        <span class="src-var">$tmp_id </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a391"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$tmp_id</span><span class="src-sym">))</span></li>
<li><a name="a392"></a>        <span class="src-sym">{</span></li>
<li><a name="a393"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_next_id&quot;</span><span class="src-sym">, </span><span class="src-var">$tmp_id</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a394"></a>        <span class="src-sym">}</span></li>
<li><a name="a395"></a>&nbsp;</li>
<li><a name="a396"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$tmp_id</span><span class="src-sym">))</span></li>
<li><a name="a397"></a>        <span class="src-sym">{</span></li>
<li><a name="a398"></a>            <span class="src-key">return </span><span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a399"></a>        <span class="src-sym">}</span></li>
<li><a name="a400"></a>        <span class="src-key">else</span></li>
<li><a name="a401"></a>        <span class="src-sym">{</span></li>
<li><a name="a402"></a>            <span class="src-key">return </span><span class="src-var">$tmp_id</span><span class="src-sym">;</span></li>
<li><a name="a403"></a>        <span class="src-sym">}</span></li>
<li><a name="a404"></a>    <span class="src-sym">}</span></li>
<li><a name="a405"></a>&nbsp;</li>
<li><a name="a406"></a>    <span class="src-doc">/**</span></li>
<li><a name="a407"></a><span class="src-doc">     * Get next available number</span></li>
<li><a name="a408"></a><span class="src-doc">     *</span></li>
<li><a name="a409"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$seq_name </span><span class="src-doc">   name of sequence</span></li>
<li><a name="a410"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a411"></a><span class="src-doc">     */</span></li>
<li><a name="a412"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_seq_id">db_seq_id</a><span class="src-sym">(</span><span class="src-var">$seq_name</span><span class="src-sym">)</span></li>
<li><a name="a413"></a>    <span class="src-sym">{</span></li>
<li><a name="a414"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a415"></a>        <span class="src-sym">{</span></li>
<li><a name="a416"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_seq_id&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a417"></a>        <span class="src-sym">}</span></li>
<li><a name="a418"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$seq_name</span><span class="src-sym">))</span></li>
<li><a name="a419"></a>        <span class="src-sym">{</span></li>
<li><a name="a420"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_seq_id&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;seq_name is missing&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a421"></a>        <span class="src-sym">}</span></li>
<li><a name="a422"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_object">is_object</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a423"></a>        <span class="src-sym">{</span></li>
<li><a name="a424"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_seq_id&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\$this-&amp;gt;db is not an database object&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a425"></a>        <span class="src-sym">}</span></li>
<li><a name="a426"></a>&nbsp;</li>
<li><a name="a427"></a>        <span class="src-var">$tmp_id </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">nextId</span><span class="src-sym">(</span><span class="src-var">$seq_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a428"></a>&nbsp;</li>
<li><a name="a429"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$tmp_id</span><span class="src-sym">))</span></li>
<li><a name="a430"></a>        <span class="src-sym">{</span></li>
<li><a name="a431"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_seq_id&quot;</span><span class="src-sym">, </span><span class="src-var">$tmp_id</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a432"></a>        <span class="src-sym">}</span></li>
<li><a name="a433"></a>&nbsp;</li>
<li><a name="a434"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$tmp_id</span><span class="src-sym">))    </span><span class="src-key">return </span><span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a435"></a>        <span class="src-key">else                </span><span class="src-key">return </span><span class="src-var">$tmp_id</span><span class="src-sym">;</span></li>
<li><a name="a436"></a>    <span class="src-sym">}</span></li>
<li><a name="a437"></a>&nbsp;</li>
<li><a name="a438"></a>    <span class="src-doc">/**</span></li>
<li><a name="a439"></a><span class="src-doc">    *  Get number of lowest unused number in a column)</span></li>
<li><a name="a440"></a><span class="src-doc">    *</span></li>
<li><a name="a441"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$table </span><span class="src-doc">           database table to use</span></li>
<li><a name="a442"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$column </span><span class="src-doc">           database column to use</span></li>
<li><a name="a443"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$where_key </span><span class="src-doc">       database column name for limitation {default: void}</span></li>
<li><a name="a444"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$where_value </span><span class="src-doc">   limitation value {default: void}</span></li>
<li><a name="a445"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">                       lowest unused number in a column</span></li>
<li><a name="a446"></a><span class="src-doc">    */</span></li>
<li><a name="a447"></a>   <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_free_id">db_free_id</a><span class="src-sym">(</span><span class="src-var">$table</span><span class="src-sym">, </span><span class="src-var">$column</span><span class="src-sym">, </span><span class="src-var">$where_key</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$where_value</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a448"></a>   <span class="src-sym">{</span></li>
<li><a name="a449"></a>      <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a450"></a>      <span class="src-sym">{</span></li>
<li><a name="a451"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_free_id&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a452"></a>      <span class="src-sym">}</span></li>
<li><a name="a453"></a>&nbsp;</li>
<li><a name="a454"></a>      <span class="src-var">$rc</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a455"></a>&nbsp;</li>
<li><a name="a456"></a>      <span class="src-key">if </span><span class="src-sym">((</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$where_key</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$where_value</span><span class="src-sym">)))</span></li>
<li><a name="a457"></a>         <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">SELECT</span> <span class="src-var">$column</span> <span class="src-id">FROM</span> <span class="src-var">$table</span> <span class="src-id">ORDER</span> <span class="src-id">BY</span> <span class="src-var">$column</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a458"></a>      <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$where_key</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$where_value</span><span class="src-sym">)))</span></li>
<li><a name="a459"></a>         <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;</span><span class="src-str"><span class="src-id">SELECT</span> <span class="src-var">$column</span> <span class="src-id">FROM</span> <span class="src-var">$table</span> <span class="src-id">WHERE</span> <span class="src-var">$where_key</span>='<span class="src-var">$where_value</span>' <span class="src-id">ORDER</span> <span class="src-id">BY</span> <span class="src-var">$column</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a460"></a>&nbsp;</li>
<li><a name="a461"></a>      <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">))</span></li>
<li><a name="a462"></a>      <span class="src-sym">{</span></li>
<li><a name="a463"></a>         <span class="src-var">$que </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a464"></a>         <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$que</span><span class="src-sym">-&gt;</span><span class="src-id">numRows</span><span class="src-sym">(</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a465"></a>         <span class="src-sym">{</span></li>
<li><a name="a466"></a>            <span class="src-var">$count</span>=<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a467"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$row </span>= <span class="src-var">$que</span><span class="src-sym">-&gt;</span><span class="src-id">fetchRow</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a468"></a>            <span class="src-sym">{</span></li>
<li><a name="a469"></a>               <span class="src-var">$tmp_id </span>= <span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a470"></a>               <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$count</span>==<span class="src-var">$tmp_id</span><span class="src-sym">)</span></li>
<li><a name="a471"></a>                  <span class="src-var">$count</span>++<span class="src-sym">;</span></li>
<li><a name="a472"></a>               <span class="src-key">else</span></li>
<li><a name="a473"></a>               <span class="src-sym">{</span></li>
<li><a name="a474"></a>                  <span class="src-var">$rc </span>= <span class="src-var">$count</span><span class="src-sym">;</span></li>
<li><a name="a475"></a>                  <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a476"></a>               <span class="src-sym">}</span></li>
<li><a name="a477"></a>            <span class="src-sym">}</span></li>
<li><a name="a478"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rc</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a479"></a>               <span class="src-var">$rc</span>=<span class="src-var">$count</span><span class="src-sym">;</span></li>
<li><a name="a480"></a>         <span class="src-sym">}</span></li>
<li><a name="a481"></a>         <span class="src-key">else</span></li>
<li><a name="a482"></a>            <span class="src-var">$rc</span>=<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a483"></a>      <span class="src-sym">}</span></li>
<li><a name="a484"></a>      <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a485"></a>   <span class="src-sym">}</span></li>
<li><a name="a486"></a>&nbsp;</li>
<li><a name="a487"></a>    <span class="src-doc">/**</span></li>
<li><a name="a488"></a><span class="src-doc">     * check right database version</span></li>
<li><a name="a489"></a><span class="src-doc">     *</span></li>
<li><a name="a490"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$mav </span><span class="src-doc">   major release number {default: 3.23}</span></li>
<li><a name="a491"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$miv </span><span class="src-doc">   minor release number {default: 6}</span></li>
<li><a name="a492"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">           active database version, if false empty</span></li>
<li><a name="a493"></a><span class="src-doc">     */</span></li>
<li><a name="a494"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddb_version">db_version</a><span class="src-sym">(</span><span class="src-var">$mav</span>=<span class="src-str">&quot;3.23&quot;</span><span class="src-sym">, </span><span class="src-var">$miv</span>=<span class="src-str">&quot;6&quot;</span><span class="src-sym">)</span></li>
<li><a name="a495"></a>    <span class="src-sym">{</span></li>
<li><a name="a496"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a497"></a>        <span class="src-sym">{</span></li>
<li><a name="a498"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_version&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a499"></a>        <span class="src-sym">}</span></li>
<li><a name="a500"></a>&nbsp;</li>
<li><a name="a501"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;unknown&quot;</span><span class="src-sym">;</span></li>
<li><a name="a502"></a>&nbsp;</li>
<li><a name="a503"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db_type">db_type</a><span class="src-sym">)</span>==<span class="src-str">&quot;mysql&quot;</span><span class="src-sym">)</span></li>
<li><a name="a504"></a>        <span class="src-sym">{</span></li>
<li><a name="a505"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">phptype</span>==<span class="src-str">&quot;mysqli&quot;</span><span class="src-sym">)    </span><span class="src-var">$tmp_rc </span>= <span class="src-id">mysqli_get_server_info</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">connection</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a506"></a>            <span class="src-key">else                                 </span><span class="src-var">$tmp_rc </span>= <a href="http://www.php.net/mysql_get_server_info">mysql_get_server_info</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a507"></a>&nbsp;</li>
<li><a name="a508"></a>            <span class="src-var">$t_mav1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">,</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a509"></a>            <span class="src-var">$t_mav2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a510"></a>            <span class="src-var">$t_miv  </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a511"></a>            <span class="src-var">$t_mav  </span>= <span class="src-var">$t_mav1</span>.<span class="src-str">&quot;.&quot;</span>.<span class="src-var">$t_mav2</span><span class="src-sym">;</span></li>
<li><a name="a512"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$t_mav </span>&gt; <span class="src-var">$mav</span><span class="src-sym">) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;MySQL &quot;</span>.<span class="src-var">$tmp_rc</span><span class="src-sym">;</span></li>
<li><a name="a513"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$t_mav </span>== <span class="src-var">$mav</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$t_miv</span><span class="src-sym">) </span>&gt;= <span class="src-var">$miv</span><span class="src-sym">)) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;MySQL &quot;</span>.<span class="src-var">$tmp_rc</span><span class="src-sym">;</span></li>
<li><a name="a514"></a>            <span class="src-key">else</span></li>
<li><a name="a515"></a>            <span class="src-sym">{</span></li>
<li><a name="a516"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;db_version&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">MySQL</span> <span class="src-id">version</span> <span class="src-id">to</span> <span class="src-id">old</span> (<span class="src-id">version</span> <span class="src-var">$mav</span>.<span class="src-var">$miv</span> <span class="src-id">or</span> <span class="src-id">higher</span> <span class="src-id">required</span>), &lt;<span class="src-id">b</span>&gt;<span class="src-id">program</span> <span class="src-id">aborted</span>&lt;/<span class="src-id">b</span>&gt;.</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a517"></a>            <span class="src-sym">}</span></li>
<li><a name="a518"></a>        <span class="src-sym">}</span></li>
<li><a name="a519"></a>        <span class="src-key">else</span></li>
<li><a name="a520"></a>        <span class="src-sym">{</span></li>
<li><a name="a521"></a>            <span class="src-var">$tmp_rc </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-str">&quot;SELECT version()&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a522"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">))</span></li>
<li><a name="a523"></a>            <span class="src-sym">{</span></li>
<li><a name="a524"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">,</span><span class="src-str">&quot; on&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a525"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">)) </span><span class="src-var">$rc </span>= <span class="src-var">$tmp_rc</span><span class="src-sym">; </span><span class="src-comm">// just to be sure</span></li>
<li><a name="a526"></a>            <span class="src-sym">}</span></li>
<li><a name="a527"></a>        <span class="src-sym">}</span></li>
<li><a name="a528"></a>&nbsp;</li>
<li><a name="a529"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a530"></a>    <span class="src-sym">}</span></li>
<li><a name="a531"></a>&nbsp;</li>
<li><a name="a532"></a>    <span class="src-doc">/**</span></li>
<li><a name="a533"></a><span class="src-doc">     * starts dbsession. Enables session fallback handling. This functions</span></li>
<li><a name="a534"></a><span class="src-doc">     * will be required, if you want to handle the session_id with</span></li>
<li><a name="a535"></a><span class="src-doc">     * url or formstart</span></li>
<li><a name="a536"></a><span class="src-doc">     * Required    : read README file</span></li>
<li><a name="a537"></a><span class="src-doc">     *</span></li>
<li><a name="a538"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">       session id to use, if empty new unique id</span></li>
<li><a name="a539"></a><span class="src-doc">     *                                   will be generated</span></li>
<li><a name="a540"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$table_error </span><span class="src-doc">   show error message, if dbsession tables doesn't exist</span></li>
<li><a name="a541"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   session_id</span></li>
<li><a name="a542"></a><span class="src-doc">     */</span></li>
<li><a name="a543"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsession_start">dbsession_start</a><span class="src-sym">(</span><span class="src-var">$session_id</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$table_error</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a544"></a>    <span class="src-sym">{</span></li>
<li><a name="a545"></a>        <span class="src-key">global </span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">;</span></li>
<li><a name="a546"></a>&nbsp;</li>
<li><a name="a547"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_handler">m_dbsession_handler</a>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a548"></a>        <span class="src-var">$IDpassed </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a549"></a>&nbsp;</li>
<li><a name="a550"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a551"></a>        <span class="src-sym">{</span></li>
<li><a name="a552"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_start&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a553"></a>        <span class="src-sym">}</span></li>
<li><a name="a554"></a>        <span class="src-key">else</span></li>
<li><a name="a555"></a>        <span class="src-sym">{</span></li>
<li><a name="a556"></a>            <span class="src-var">$tdata </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getListOf</span><span class="src-sym">(</span><span class="src-str">&quot;tables&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a557"></a>              <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a><span class="src-sym">,</span><span class="src-var">$tdata</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a><span class="src-sym">,</span><span class="src-var">$tdata</span><span class="src-sym">)))</span></li>
<li><a name="a558"></a>                <span class="src-var">$dbtables_found </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a559"></a>            <span class="src-key">else</span></li>
<li><a name="a560"></a>                <span class="src-var">$dbtables_found </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a561"></a>&nbsp;</li>
<li><a name="a562"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$dbtables_found</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$table_error</span><span class="src-sym">))</span></li>
<li><a name="a563"></a>            <span class="src-sym">{</span></li>
<li><a name="a564"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_start&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;missing dbsession database table&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a565"></a>            <span class="src-sym">}</span></li>
<li><a name="a566"></a>        <span class="src-sym">}</span></li>
<li><a name="a567"></a>&nbsp;</li>
<li><a name="a568"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">))    </span><span class="src-var">$SID </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_user_var">get_user_var</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a><span class="src-sym">,</span><span class="src-str">'POST,GET,COOKIE'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a569"></a>        <span class="src-key">else                    </span><span class="src-var">$SID </span>= <span class="src-var">$session_id</span><span class="src-sym">;</span></li>
<li><a name="a570"></a>&nbsp;</li>
<li><a name="a571"></a>        <span class="src-comm">// generate session_is</span></li>
<li><a name="a572"></a>        <span class="src-var">$session_is </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a573"></a>&nbsp;</li>
<li><a name="a574"></a>        <span class="src-comm">// validate session_id</span></li>
<li><a name="a575"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$SID</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$SID</span><span class="src-sym">)</span>==<span class="src-num">32</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$dbtables_found</span><span class="src-sym">))</span></li>
<li><a name="a576"></a>        <span class="src-sym">{</span></li>
<li><a name="a577"></a>            <span class="src-var">$t_sec   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;s&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a578"></a>            <span class="src-var">$t_min   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;i&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a579"></a>            <span class="src-var">$t_hours </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;H&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a580"></a>            <span class="src-var">$t_day   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;d&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a581"></a>            <span class="src-var">$t_month </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;m&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a582"></a>            <span class="src-var">$t_year  </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a583"></a>            <span class="src-var">$session_start </span>= <span class="src-var">$t_year</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$t_month</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$t_day</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$t_hours</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$t_min</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$t_sec</span><span class="src-sym">;</span></li>
<li><a name="a584"></a>&nbsp;</li>
<li><a name="a585"></a>            <span class="src-var">$stempel     </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-var">$t_hours</span><span class="src-sym">,</span><span class="src-sym">(</span><span class="src-var">$t_min</span>+<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_timeout">m_dbsession_timeout</a><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$t_sec</span><span class="src-sym">,</span><span class="src-var">$t_month</span><span class="src-sym">,</span><span class="src-var">$t_day</span><span class="src-sym">,</span><span class="src-var">$t_year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a586"></a>            <span class="src-var">$faellig     </span>= <a href="http://www.php.net/getdate">getdate</a><span class="src-sym">(</span><span class="src-var">$stempel</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a587"></a>            <span class="src-var">$session_end </span>= <span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">]</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'mon'</span><span class="src-sym">]</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'mday'</span><span class="src-sym">]</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'hours'</span><span class="src-sym">]</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'minutes'</span><span class="src-sym">]</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'seconds'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a588"></a>&nbsp;</li>
<li><a name="a589"></a>            <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT COUNT(*) FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_id</span>='<span class="src-var">$SID</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a590"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a591"></a>            <span class="src-sym">{</span></li>
<li><a name="a592"></a>                <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT session_is,session_end FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_id</span>='<span class="src-var">$SID</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a593"></a>                <span class="src-var">$sdata </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getRow</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">,</span><span class="src-id">DB_FETCHMODE_ASSOC</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a594"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sdata</span><span class="src-sym">[</span><span class="src-str">'session_end'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a595"></a>                <span class="src-sym">{</span></li>
<li><a name="a596"></a>                    <span class="src-var">$tmp_stamp_db  </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">convtoTimestamp</span><span class="src-sym">(</span><span class="src-var">$sdata</span><span class="src-sym">[</span><span class="src-str">'session_end'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-str">'datetime'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a597"></a>                    <span class="src-var">$tmp_stamp_now </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">convtoTimestamp</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a598"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$sdata</span><span class="src-sym">[</span><span class="src-str">'session_is'</span><span class="src-sym">]</span>==<span class="src-var">$session_is</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$tmp_stamp_db </span>&gt; <span class="src-var">$tmp_stamp_now</span><span class="src-sym">))</span></li>
<li><a name="a599"></a>                    <span class="src-sym">{</span></li>
<li><a name="a600"></a>                        <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;UPDATE &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; SET session_end=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_end</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a601"></a>                        <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_id</span>='<span class="src-var">$SID</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a602"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a603"></a>                        <span class="src-var">$IDpassed </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a604"></a>                    <span class="src-sym">}</span></li>
<li><a name="a605"></a>                    <span class="src-key">else</span></li>
<li><a name="a606"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methoddbsession_end">dbsession_end</a><span class="src-sym">(</span><span class="src-var">$SID</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a607"></a>                <span class="src-sym">}</span></li>
<li><a name="a608"></a>            <span class="src-sym">}</span></li>
<li><a name="a609"></a>            <span class="src-key">else</span></li>
<li><a name="a610"></a>            <span class="src-sym">{</span></li>
<li><a name="a611"></a>                <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;INSERT INTO &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; (session_id,session_start,session_end,session_is)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a612"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">VALUES</span> ('<span class="src-var">$SID</span>',</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a613"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_start</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a614"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_end</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a615"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_is</span><span class="src-sym">) </span>.<span class="src-str">&quot;)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a616"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a617"></a>                <span class="src-var">$IDpassed </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a618"></a>            <span class="src-sym">}</span></li>
<li><a name="a619"></a>        <span class="src-sym">}</span></li>
<li><a name="a620"></a>&nbsp;</li>
<li><a name="a621"></a>        <span class="src-comm">// calculate new SID and session_is</span></li>
<li><a name="a622"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$IDpassed</span><span class="src-sym">) </span><span class="src-var">$SID </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a623"></a>&nbsp;</li>
<li><a name="a624"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id">m_dbsession_id</a> = <span class="src-var">$SID</span><span class="src-sym">;</span></li>
<li><a name="a625"></a>        <a href="http://www.php.net/setcookie">setcookie</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id">m_dbsession_id</a><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a626"></a>&nbsp;</li>
<li><a name="a627"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$IDpassed</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$dbtables_found</span><span class="src-sym">))  </span><span class="src-comm">// no valid session_id in url found</span></li>
<li><a name="a628"></a>        <span class="src-sym">{</span></li>
<li><a name="a629"></a>            <span class="src-var">$tmp_script_name  </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SCRIPT_NAME'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a630"></a>            <span class="src-var">$tmp_server_name  </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_NAME'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a631"></a>            <span class="src-var">$tmp_server_port  </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_PORT'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a632"></a>            <span class="src-var">$tmp_query_string </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'QUERY_STRING'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a633"></a>&nbsp;</li>
<li><a name="a634"></a>            <span class="src-var">$query    </span>= <span class="src-var">$tmp_query_string </span>!= <span class="src-str">&quot;&quot;</span></li>
<li><a name="a635"></a>                ? <span class="src-str">&quot;?&quot;</span>.<span class="src-var">$tmp_query_string</span></li>
<li><a name="a636"></a>                : <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a637"></a>&nbsp;</li>
<li><a name="a638"></a>            <span class="src-var">$url </span>= <span class="src-var">$tmp_script_name</span>.<span class="src-var">$query</span><span class="src-sym">;</span></li>
<li><a name="a639"></a>&nbsp;</li>
<li><a name="a640"></a>            <span class="src-comm">// non-standard port?</span></li>
<li><a name="a641"></a>            <span class="src-var">$portMatch </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a642"></a>            <span class="src-var">$port </span>= <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^(80|443)$/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$tmp_server_port</span><span class="src-sym">, </span><span class="src-var">$portMatch</span><span class="src-sym">)</span></li>
<li><a name="a643"></a>                ? <span class="src-str">&quot;:&quot;</span>.<span class="src-var">$tmp_server_port</span></li>
<li><a name="a644"></a>                : <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a645"></a>&nbsp;</li>
<li><a name="a646"></a>            <span class="src-var">$new_location  </span>= <span class="src-sym">((</span><span class="src-var">$portMatch</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>== <span class="src-num">443</span><span class="src-sym">) </span>? <span class="src-str">&quot;https://&quot; </span>: <span class="src-str">&quot;http://&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a647"></a>            <span class="src-var">$new_location </span>.= <span class="src-var">$tmp_server_name</span>.<span class="src-var">$port</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a648"></a>&nbsp;</li>
<li><a name="a649"></a>            <span class="src-comm">// redirect</span></li>
<li><a name="a650"></a>            <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">Location</span>: <span class="src-var">$new_location</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a651"></a>            <span class="src-key">exit</span><span class="src-sym">;</span></li>
<li><a name="a652"></a>        <span class="src-sym">}</span></li>
<li><a name="a653"></a>&nbsp;</li>
<li><a name="a654"></a>        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_cookies">m_dbsession_cookies</a> = <span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a><span class="src-sym">]</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">@</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a><span class="src-sym">]</span><span class="src-sym">) </span>== <span class="src-num">32</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a655"></a>&nbsp;</li>
<li><a name="a656"></a>        <span class="src-key">return </span><span class="src-var">$SID</span><span class="src-sym">;</span></li>
<li><a name="a657"></a>    <span class="src-sym">}</span></li>
<li><a name="a658"></a>&nbsp;</li>
<li><a name="a659"></a>    <span class="src-doc">/**</span></li>
<li><a name="a660"></a><span class="src-doc">     * starts sub session within a session. You can use it to group the session</span></li>
<li><a name="a661"></a><span class="src-doc">     * in different parts</span></li>
<li><a name="a662"></a><span class="src-doc">     * Required   : read README file</span></li>
<li><a name="a663"></a><span class="src-doc">     *</span></li>
<li><a name="a664"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">       session id to use (main session)</span></li>
<li><a name="a665"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_subid </span><span class="src-doc">   session_subid.  If empty new unique id</span></li>
<li><a name="a666"></a><span class="src-doc">     *                                     will be generated if required</span></li>
<li><a name="a667"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   session_subid</span></li>
<li><a name="a668"></a><span class="src-doc">     */</span></li>
<li><a name="a669"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsessionsub_start">dbsessionsub_start</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">, </span><span class="src-var">$session_subid</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a670"></a>    <span class="src-sym">{</span></li>
<li><a name="a671"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a672"></a>        <span class="src-sym">{</span></li>
<li><a name="a673"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsessionsub_start&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a674"></a>        <span class="src-sym">}</span></li>
<li><a name="a675"></a>&nbsp;</li>
<li><a name="a676"></a>        <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT COUNT(*) FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_id</span>='<span class="src-var">$session_id</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a677"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a678"></a>        <span class="src-sym">{</span></li>
<li><a name="a679"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsessionsub_start&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;invalid session_id&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a680"></a>        <span class="src-sym">}</span></li>
<li><a name="a681"></a>&nbsp;</li>
<li><a name="a682"></a>        <span class="src-comm">// generate session_is</span></li>
<li><a name="a683"></a>        <span class="src-var">$session_is </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a684"></a>&nbsp;</li>
<li><a name="a685"></a>        <span class="src-comm">// validate session_subid</span></li>
<li><a name="a686"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$session_subid</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$session_subid</span><span class="src-sym">)</span>!=<span class="src-num">32</span><span class="src-sym">))</span></li>
<li><a name="a687"></a>            <span class="src-var">$session_subid </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a688"></a>&nbsp;</li>
<li><a name="a689"></a>        <span class="src-var">$t_sec   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;s&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a690"></a>        <span class="src-var">$t_min   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;i&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a691"></a>        <span class="src-var">$t_hours </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;H&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a692"></a>        <span class="src-var">$t_day   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;d&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a693"></a>        <span class="src-var">$t_month </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;m&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a694"></a>        <span class="src-var">$t_year  </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a695"></a>        <span class="src-var">$session_start </span>= <span class="src-var">$t_year</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$t_month</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$t_day</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$t_hours</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$t_min</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$t_sec</span><span class="src-sym">;</span></li>
<li><a name="a696"></a>&nbsp;</li>
<li><a name="a697"></a>        <span class="src-var">$stempel     </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-var">$t_hours</span><span class="src-sym">,</span><span class="src-sym">(</span><span class="src-var">$t_min</span>+<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_timeout">m_dbsession_timeout</a><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$t_sec</span><span class="src-sym">,</span><span class="src-var">$t_month</span><span class="src-sym">,</span><span class="src-var">$t_day</span><span class="src-sym">,</span><span class="src-var">$t_year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a698"></a>        <span class="src-var">$faellig     </span>= <a href="http://www.php.net/getdate">getdate</a><span class="src-sym">(</span><span class="src-var">$stempel</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a699"></a>        <span class="src-var">$session_end </span>= <span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">]</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'mon'</span><span class="src-sym">]</span>.<span class="src-str">&quot;-&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'mday'</span><span class="src-sym">]</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'hours'</span><span class="src-sym">]</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'minutes'</span><span class="src-sym">]</span>.<span class="src-str">&quot;:&quot;</span>.<span class="src-var">$faellig</span><span class="src-sym">[</span><span class="src-str">'seconds'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a700"></a>&nbsp;</li>
<li><a name="a701"></a>        <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT COUNT(*) FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_subid</span>='<span class="src-var">$session_subid</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a702"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span><span class="src-comm">// maybe update is overkill, but it's safer.</span></li>
<li><a name="a703"></a>        <span class="src-sym">{</span></li>
<li><a name="a704"></a>            <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;UPDATE &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; SET session_end=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_end</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a705"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">WHERE</span> <span class="src-id">session_subid</span>='<span class="src-var">$session_subid</span>'</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a706"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a707"></a>        <span class="src-sym">}</span></li>
<li><a name="a708"></a>        <span class="src-key">else</span></li>
<li><a name="a709"></a>        <span class="src-sym">{</span></li>
<li><a name="a710"></a>            <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;INSERT INTO &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; (session_id,session_subid,session_start,session_end,session_is)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a711"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">VALUES</span> ('<span class="src-var">$session_id</span>','<span class="src-var">$session_subid</span>',</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a712"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_start</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a713"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_end</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a714"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_is</span><span class="src-sym">) </span>.<span class="src-str">&quot;)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a715"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a716"></a>        <span class="src-sym">}</span></li>
<li><a name="a717"></a>&nbsp;</li>
<li><a name="a718"></a>        <span class="src-key">return </span><span class="src-var">$session_subid</span><span class="src-sym">;</span></li>
<li><a name="a719"></a>   <span class="src-sym">}</span></li>
<li><a name="a720"></a>&nbsp;</li>
<li><a name="a721"></a>    <span class="src-doc">/**</span></li>
<li><a name="a722"></a><span class="src-doc">     * ends dbsession or dbsessionsub</span></li>
<li><a name="a723"></a><span class="src-doc">     * (Read the README file for requirements)</span></li>
<li><a name="a724"></a><span class="src-doc">     *</span></li>
<li><a name="a725"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">   session id which should end ( and expired dbsession will automatically be removed)</span></li>
<li><a name="a726"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">               true if successfully end dbsession</span></li>
<li><a name="a727"></a><span class="src-doc">     */</span></li>
<li><a name="a728"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsession_end">dbsession_end</a><span class="src-sym">(</span><span class="src-var">$session_id</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a729"></a>    <span class="src-sym">{</span></li>
<li><a name="a730"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a731"></a>        <span class="src-sym">{</span></li>
<li><a name="a732"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_end&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a733"></a>        <span class="src-sym">}</span></li>
<li><a name="a734"></a>&nbsp;</li>
<li><a name="a735"></a>        <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT session_id, session_subid FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; WHERE session_end&lt;=NOW()&quot;</span><span class="src-sym">;</span></li>
<li><a name="a736"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">))</span></li>
<li><a name="a737"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot; OR session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot; OR session_subid=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a738"></a>        <span class="src-sym">@ </span><span class="src-var">$que </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a739"></a>        <span class="src-sym">@ </span><span class="src-var">$num </span>= <span class="src-var">$que</span><span class="src-sym">-&gt;</span><span class="src-id">numRows</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a740"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$num</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a741"></a>        <span class="src-sym">{</span></li>
<li><a name="a742"></a>            <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$row </span>= <span class="src-var">$que</span><span class="src-sym">-&gt;</span><span class="src-id">fetchRow</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a743"></a>            <span class="src-sym">{</span></li>
<li><a name="a744"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-comm">// sub session</span></li>
<li><a name="a745"></a>                <span class="src-sym">{</span></li>
<li><a name="a746"></a>                    <span class="src-var">$sqlstr1 </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; WHERE session_subid=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a747"></a>                    <span class="src-var">$sqlstr2 </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a748"></a>                <span class="src-sym">}</span></li>
<li><a name="a749"></a>                <span class="src-key">else                        </span><span class="src-comm">// session with all sub sessions</span></li>
<li><a name="a750"></a>                <span class="src-sym">{</span></li>
<li><a name="a751"></a>                    <span class="src-var">$sqlstr1 </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a752"></a>                    <span class="src-var">$sqlstr2 </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a753"></a>&nbsp;</li>
<li><a name="a754"></a>                    <span class="src-comm">// take care of sub sessions /////////////</span></li>
<li><a name="a755"></a>                    <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT session_subid FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_table">m_dbsession_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a756"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">))</span></li>
<li><a name="a757"></a>                    <span class="src-sym">@ </span><span class="src-var">$sub_que </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a758"></a>                    <span class="src-sym">@ </span><span class="src-var">$num </span>= <span class="src-var">$sub_que</span><span class="src-sym">-&gt;</span><span class="src-id">numRows</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a759"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$num</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a760"></a>                    <span class="src-sym">{</span></li>
<li><a name="a761"></a>                        <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$sub_row </span>= <span class="src-var">$sub_que</span><span class="src-sym">-&gt;</span><span class="src-id">fetchRow</span><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a762"></a>                        <span class="src-sym">{</span></li>
<li><a name="a763"></a>                            <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$sub_row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a764"></a>                            <span class="src-sym">@ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a765"></a>                        <span class="src-sym">}</span></li>
<li><a name="a766"></a>                    <span class="src-sym">}</span></li>
<li><a name="a767"></a>                    <span class="src-comm">//////////////////////////////////////////</span></li>
<li><a name="a768"></a>                <span class="src-sym">}</span></li>
<li><a name="a769"></a>                <span class="src-sym">@ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a770"></a>                <span class="src-sym">@ </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a771"></a>            <span class="src-sym">}</span></li>
<li><a name="a772"></a>        <span class="src-sym">}</span></li>
<li><a name="a773"></a>&nbsp;</li>
<li><a name="a774"></a>        <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a775"></a>    <span class="src-sym">}</span></li>
<li><a name="a776"></a>&nbsp;</li>
<li><a name="a777"></a>    <span class="src-doc">/**</span></li>
<li><a name="a778"></a><span class="src-doc">     * register variable in dbsession</span></li>
<li><a name="a779"></a><span class="src-doc">     * Required   : read README file</span></li>
<li><a name="a780"></a><span class="src-doc">     *</span></li>
<li><a name="a781"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">   session id to use</span></li>
<li><a name="a782"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$var_name </span><span class="src-doc">   variable to add</span></li>
<li><a name="a783"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$var_value </span><span class="src-doc">   value of variable</span></li>
<li><a name="a784"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">               value of variable</span></li>
<li><a name="a785"></a><span class="src-doc">     */</span></li>
<li><a name="a786"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsession_write">dbsession_write</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">, </span><span class="src-var">$var_name</span><span class="src-sym">, </span><span class="src-var">$var_value</span><span class="src-sym">)</span></li>
<li><a name="a787"></a>    <span class="src-sym">{</span></li>
<li><a name="a788"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a789"></a>&nbsp;</li>
<li><a name="a790"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a791"></a>        <span class="src-sym">{</span></li>
<li><a name="a792"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_write&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a793"></a>        <span class="src-sym">}</span></li>
<li><a name="a794"></a>&nbsp;</li>
<li><a name="a795"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)))</span></li>
<li><a name="a796"></a>        <span class="src-sym">{</span></li>
<li><a name="a797"></a>            <span class="src-var">$error_string </span>= <span class="src-str">&quot;dbsession_write error: var_name missing&quot;</span><span class="src-sym">;</span></li>
<li><a name="a798"></a>            <a href="http://www.php.net/trigger_error">trigger_error</a><span class="src-sym">(</span><span class="src-var">$error_string</span><span class="src-sym">, </span><span class="src-id">E_USER_ERROR</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a799"></a>        <span class="src-sym">}</span></li>
<li><a name="a800"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$var_value</span><span class="src-sym">))</span></li>
<li><a name="a801"></a>        <span class="src-sym">{</span></li>
<li><a name="a802"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methoddbsession_delete">dbsession_delete</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">, </span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a803"></a>        <span class="src-sym">}</span></li>
<li><a name="a804"></a>        <span class="src-key">else</span></li>
<li><a name="a805"></a>        <span class="src-sym">{</span></li>
<li><a name="a806"></a>            <span class="src-comm">// if already stored, delete it</span></li>
<li><a name="a807"></a>            <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;SELECT COUNT(session_id) FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot; AND session_var=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a808"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getOne</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span><span class="src-comm">// update</span></li>
<li><a name="a809"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methoddbsession_delete">dbsession_delete</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">,</span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a810"></a>&nbsp;</li>
<li><a name="a811"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$var_value</span><span class="src-sym">))</span></li>
<li><a name="a812"></a>            <span class="src-sym">{</span></li>
<li><a name="a813"></a>                <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;INSERT INTO &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; (session_id,session_array,session_var,session_value) VALUES (&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot;,'Y',&quot;</span><span class="src-sym">;</span></li>
<li><a name="a814"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;</span><span class="src-str">'<span class="src-var">$var_name</span>',</span><span class="src-str">&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><a href="http://www.php.net/serialize">serialize</a><span class="src-sym">(</span><span class="src-var">$var_value</span><span class="src-sym">))</span>.<span class="src-str">&quot;)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a815"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a816"></a>            <span class="src-sym">}</span></li>
<li><a name="a817"></a>            <span class="src-key">else</span></li>
<li><a name="a818"></a>            <span class="src-sym">{</span></li>
<li><a name="a819"></a>                <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;INSERT INTO &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; (session_id,session_array,session_var,session_value) VALUES (&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot;,'N',&quot;</span><span class="src-sym">;</span></li>
<li><a name="a820"></a>                <span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">) </span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a821"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$var_value</span><span class="src-sym">)) </span><span class="src-var">$sqlstr </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$var_value</span><span class="src-sym">) </span>.<span class="src-str">&quot;)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a822"></a>                <span class="src-key">else </span><span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;NULL)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a823"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a824"></a>            <span class="src-sym">}</span></li>
<li><a name="a825"></a>&nbsp;</li>
<li><a name="a826"></a>            <span class="src-var">$rc </span>= <span class="src-var">$var_value</span><span class="src-sym">;</span></li>
<li><a name="a827"></a>        <span class="src-sym">}</span></li>
<li><a name="a828"></a>&nbsp;</li>
<li><a name="a829"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a830"></a>    <span class="src-sym">}</span></li>
<li><a name="a831"></a>&nbsp;</li>
<li><a name="a832"></a>    <span class="src-doc">/**</span></li>
<li><a name="a833"></a><span class="src-doc">     * register variable in dbsession</span></li>
<li><a name="a834"></a><span class="src-doc">     *</span></li>
<li><a name="a835"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">       session id to use</span></li>
<li><a name="a836"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$var_name </span><span class="src-doc">       name of variable</span></li>
<li><a name="a837"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   value of variable</span></li>
<li><a name="a838"></a><span class="src-doc">     */</span></li>
<li><a name="a839"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsession_read">dbsession_read</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">, </span><span class="src-var">$var_name</span><span class="src-sym">)</span></li>
<li><a name="a840"></a>    <span class="src-sym">{</span></li>
<li><a name="a841"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a842"></a>&nbsp;</li>
<li><a name="a843"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a844"></a>        <span class="src-sym">{</span></li>
<li><a name="a845"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_read&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a846"></a>        <span class="src-sym">}</span></li>
<li><a name="a847"></a>&nbsp;</li>
<li><a name="a848"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)))</span></li>
<li><a name="a849"></a>        <span class="src-sym">{</span></li>
<li><a name="a850"></a>            <span class="src-var">$error_string </span>= <span class="src-str">&quot;dbsession_read error: var_name missing&quot;</span><span class="src-sym">;</span></li>
<li><a name="a851"></a>            <a href="http://www.php.net/trigger_error">trigger_error</a><span class="src-sym">(</span><span class="src-var">$error_string</span><span class="src-sym">, </span><span class="src-id">E_USER_ERROR</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a852"></a>        <span class="src-sym">}</span></li>
<li><a name="a853"></a>        <span class="src-key">else</span></li>
<li><a name="a854"></a>        <span class="src-sym">{</span></li>
<li><a name="a855"></a>            <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;SELECT session_array,session_value FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a><span class="src-sym">;</span></li>
<li><a name="a856"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot; AND session_var=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a857"></a>            <span class="src-var">$row </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getRow</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a858"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">))</span></li>
<li><a name="a859"></a>            <span class="src-sym">{</span></li>
<li><a name="a860"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span>==<span class="src-str">&quot;N&quot;</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a861"></a>                <span class="src-key">else                </span><span class="src-var">$rc </span>= <a href="http://www.php.net/unserialize">unserialize</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a862"></a>            <span class="src-sym">}</span></li>
<li><a name="a863"></a>        <span class="src-sym">}</span></li>
<li><a name="a864"></a>&nbsp;</li>
<li><a name="a865"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a866"></a>    <span class="src-sym">}</span></li>
<li><a name="a867"></a>&nbsp;</li>
<li><a name="a868"></a>    <span class="src-doc">/**</span></li>
<li><a name="a869"></a><span class="src-doc">     * unregister variable in dbsession</span></li>
<li><a name="a870"></a><span class="src-doc">     * Required   : read README file</span></li>
<li><a name="a871"></a><span class="src-doc">     *</span></li>
<li><a name="a872"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$session_id </span><span class="src-doc">   session id which will be used for the variabel</span></li>
<li><a name="a873"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$var_name </span><span class="src-doc">   variable to remove</span></li>
<li><a name="a874"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">               true if successfully removed variable</span></li>
<li><a name="a875"></a><span class="src-doc">     */</span></li>
<li><a name="a876"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddbsession_delete">dbsession_delete</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">, </span><span class="src-var">$var_name</span><span class="src-sym">)</span></li>
<li><a name="a877"></a>    <span class="src-sym">{</span></li>
<li><a name="a878"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a879"></a>        <span class="src-sym">{</span></li>
<li><a name="a880"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;dbsession_delete&quot;</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a881"></a>        <span class="src-sym">}</span></li>
<li><a name="a882"></a>&nbsp;</li>
<li><a name="a883"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)))</span></li>
<li><a name="a884"></a>        <span class="src-sym">{</span></li>
<li><a name="a885"></a>            <span class="src-var">$error_string </span>= <span class="src-str">&quot;dbsession_delete error: var_name missing&quot;</span><span class="src-sym">;</span></li>
<li><a name="a886"></a>            <a href="http://www.php.net/trigger_error">trigger_error</a><span class="src-sym">(</span><span class="src-var">$error_string</span><span class="src-sym">, </span><span class="src-id">E_USER_ERROR</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a887"></a>&nbsp;</li>
<li><a name="a888"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a889"></a>        <span class="src-sym">}</span></li>
<li><a name="a890"></a>        <span class="src-key">else</span></li>
<li><a name="a891"></a>        <span class="src-sym">{</span></li>
<li><a name="a892"></a>            <span class="src-var">$sqlstr </span>= <span class="src-str">&quot;DELETE FROM &quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_detail_table">m_dbsession_detail_table</a>.<span class="src-str">&quot; WHERE session_id=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$session_id</span><span class="src-sym">)</span>.<span class="src-str">&quot; AND session_var=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a893"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a894"></a>&nbsp;</li>
<li><a name="a895"></a>            <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a896"></a>        <span class="src-sym">}</span></li>
<li><a name="a897"></a>    <span class="src-sym">}</span></li>
<li><a name="a898"></a>&nbsp;</li>
<li><a name="a899"></a>    <span class="src-doc">/**</span></li>
<li><a name="a900"></a><span class="src-doc">     * prints url as html tag</span></li>
<li><a name="a901"></a><span class="src-doc">     * (this function can only handle the session_id, if dbsession_start has</span></li>
<li><a name="a902"></a><span class="src-doc">     * been called immediately after creating the class object)</span></li>
<li><a name="a903"></a><span class="src-doc">     *</span></li>
<li><a name="a904"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$url </span><span class="src-doc">       url</span></li>
<li><a name="a905"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$name </span><span class="src-doc">       name of url {default: url}</span></li>
<li><a name="a906"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$mode </span><span class="src-doc">       0: no session_id</span></li>
<li><a name="a907"></a><span class="src-doc">     *                                 1: with session_id if required {default: 1}</span></li>
<li><a name="a908"></a><span class="src-doc">     *                                 2: just url with session_id (without TAG)</span></li>
<li><a name="a909"></a><span class="src-doc">     *                                 3: just url with session_id (without TAG), but with delimiter &amp;amp; instead of &amp;</span></li>
<li><a name="a910"></a><span class="src-doc">     *                                 4: with session_id (always)</span></li>
<li><a name="a911"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$title </span><span class="src-doc">       url title (hover text)</span></li>
<li><a name="a912"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$customize </span><span class="src-doc">   other parameters like target, style or class</span></li>
<li><a name="a913"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">               created url</span></li>
<li><a name="a914"></a><span class="src-doc">     */</span></li>
<li><a name="a915"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">, </span><span class="src-var">$name</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$title</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$customize</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a916"></a>    <span class="src-sym">{</span></li>
<li><a name="a917"></a>        <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$mode</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_cookies">m_dbsession_cookies</a><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$mod_rewrite">mod_rewrite</a><span class="src-sym">))</span></li>
<li><a name="a918"></a>            || <span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-num">4</span><span class="src-sym">))</span></li>
<li><a name="a919"></a>        <span class="src-sym">{</span></li>
<li><a name="a920"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_handler">m_dbsession_handler</a><span class="src-sym">) </span><span class="src-comm">// if cphplib handles session fallback</span></li>
<li><a name="a921"></a>            <span class="src-sym">{</span></li>
<li><a name="a922"></a>                <span class="src-comm">// only add session_id if its on same host as script was executed (server).</span></li>
<li><a name="a923"></a>                <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl_on_scripthost">url_on_scripthost</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-num">4</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a924"></a>                    <span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">,</span><span class="src-str">&quot;mailto:&quot;</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a925"></a>                <span class="src-sym">{</span></li>
<li><a name="a926"></a>                    <span class="src-comm">// Anchor-Fragment extrahieren</span></li>
<li><a name="a927"></a>                    <span class="src-var">$dummyArray </span>= <a href="http://www.php.net/split">split</a><span class="src-sym">(</span><span class="src-str">&quot;#&quot;</span><span class="src-sym">,</span><span class="src-var">$url</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a928"></a>                    <span class="src-var">$pathInfo </span>= <span class="src-var">$dummyArray</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a929"></a>&nbsp;</li>
<li><a name="a930"></a>                    <span class="src-comm">// evtl. (defekte) Session-ID(s) aus dem Querystring entfernen</span></li>
<li><a name="a931"></a>                    <span class="src-var">$pathInfo </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/[?|&amp;]&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a>.<span class="src-str">&quot;=[^?|&amp;]*/&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$pathInfo</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a932"></a>&nbsp;</li>
<li><a name="a933"></a>                    <span class="src-comm">// evtl. Query-Delimiter korrigieren</span></li>
<li><a name="a934"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/&amp;/&quot;</span><span class="src-sym">,</span><span class="src-var">$pathInfo</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/\?/&quot;</span><span class="src-sym">,</span><span class="src-var">$pathInfo</span><span class="src-sym">))</span></li>
<li><a name="a935"></a>                        <span class="src-var">$pathInfo </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/&amp;/&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;?&quot;</span><span class="src-sym">,</span><span class="src-var">$pathInfo</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a936"></a>&nbsp;</li>
<li><a name="a937"></a>                    <span class="src-comm">// clear trash</span></li>
<li><a name="a938"></a>                    <span class="src-var">$match </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a939"></a>                    <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/(.*)(?&lt;!&amp;|\?)/&quot;</span><span class="src-sym">,</span><span class="src-var">$pathInfo</span><span class="src-sym">,</span><span class="src-var">$match</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a940"></a>                    <span class="src-var">$url </span>= <span class="src-var">$match</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a941"></a>&nbsp;</li>
<li><a name="a942"></a>                    <span class="src-comm">// add new session name and session id</span></li>
<li><a name="a943"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span>==<span class="src-num">1</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-num">3</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-num">4</span><span class="src-sym">))    </span><span class="src-var">$url </span>.= <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/\?/&quot;</span><span class="src-sym">,</span><span class="src-var">$url</span><span class="src-sym">) </span>? <span class="src-str">&quot;&amp;amp;&quot; </span>: <span class="src-str">&quot;?&quot;</span><span class="src-sym">;</span></li>
<li><a name="a944"></a>                    <span class="src-key">else                                         </span><span class="src-var">$url </span>.= <a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/\?/&quot;</span><span class="src-sym">,</span><span class="src-var">$url</span><span class="src-sym">) </span>? <span class="src-str">&quot;&amp;&quot; </span>: <span class="src-str">&quot;?&quot;</span><span class="src-sym">;</span></li>
<li><a name="a945"></a>                    <span class="src-var">$url </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id_name">m_dbsession_id_name</a>.<span class="src-str">&quot;=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id">m_dbsession_id</a><span class="src-sym">;</span></li>
<li><a name="a946"></a>&nbsp;</li>
<li><a name="a947"></a>                    <span class="src-comm">// add anchor part again</span></li>
<li><a name="a948"></a>                    <span class="src-var">$url </span>.= isset<span class="src-sym">(</span><span class="src-var">$dummyArray</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">) </span>? <span class="src-str">&quot;#&quot;</span>.<span class="src-var">$dummyArray</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">] </span>: <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a949"></a>                <span class="src-sym">}</span></li>
<li><a name="a950"></a>            <span class="src-sym">}</span></li>
<li><a name="a951"></a>        <span class="src-sym">}</span></li>
<li><a name="a952"></a>&nbsp;</li>
<li><a name="a953"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span>==<span class="src-num">2</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-num">3</span><span class="src-sym">))  </span><span class="src-key">return </span><span class="src-var">$url</span><span class="src-sym">;</span></li>
<li><a name="a954"></a>        <span class="src-key">else</span></li>
<li><a name="a955"></a>        <span class="src-sym">{</span></li>
<li><a name="a956"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)) </span><span class="src-var">$name </span>= <span class="src-var">$url</span><span class="src-sym">;</span></li>
<li><a name="a957"></a>            <span class="src-key">else               </span><span class="src-var">$name </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a958"></a>&nbsp;</li>
<li><a name="a959"></a>            <span class="src-var">$rc </span>= <span class="src-str">&quot;&lt;a href=\&quot;&quot;</span>.<span class="src-var">$url</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a960"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$title</span><span class="src-sym">))        </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; title=\&quot;&quot;</span>.<span class="src-var">$title</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a961"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">))    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;</span><span class="src-str"> <span class="src-var">$customize</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a962"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$name</span>.<span class="src-str">&quot;&lt;/a&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a963"></a>            <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a964"></a>        <span class="src-sym">}</span></li>
<li><a name="a965"></a>    <span class="src-sym">}</span></li>
<li><a name="a966"></a>&nbsp;</li>
<li><a name="a967"></a>    <span class="src-doc">/**</span></li>
<li><a name="a968"></a><span class="src-doc">     * removes magic quotes</span></li>
<li><a name="a969"></a><span class="src-doc">     *</span></li>
<li><a name="a970"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">array </span><span class="src-doc-var">$array </span></li>
<li><a name="a971"></a><span class="src-doc">     */</span></li>
<li><a name="a972"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$array</span><span class="src-sym">)</span></li>
<li><a name="a973"></a>    <span class="src-sym">{</span></li>
<li><a name="a974"></a>        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))    </span><span class="src-key">return</span><span class="src-sym">;</span></li>
<li><a name="a975"></a>&nbsp;</li>
<li><a name="a976"></a>        <span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$array </span><span class="src-key">as </span><span class="src-var">$key </span>=&gt; <span class="src-var">$value</span><span class="src-sym">)</span></li>
<li><a name="a977"></a>        <span class="src-sym">{</span></li>
<li><a name="a978"></a>            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">))    </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a979"></a>            <span class="src-key">else                    </span><span class="src-var">$array</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">] </span>= <a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a980"></a>        <span class="src-sym">}</span></li>
<li><a name="a981"></a>    <span class="src-sym">}</span></li>
<li><a name="a982"></a>&nbsp;</li>
<li><a name="a983"></a>    <span class="src-doc">/**</span></li>
<li><a name="a984"></a><span class="src-doc">     * returns value of special variable type from user input</span></li>
<li><a name="a985"></a><span class="src-doc">     * (If register_globals is Off (default since 4.2.0), this function</span></li>
<li><a name="a986"></a><span class="src-doc">     * can be used, to handle user variables (insecure variables).</span></li>
<li><a name="a987"></a><span class="src-doc">     * You can use more than one type (seperated with &quot;,&quot;)</span></li>
<li><a name="a988"></a><span class="src-doc">     * DBSESSION only works if dbsession_start has been called before.</span></li>
<li><a name="a989"></a><span class="src-doc">     *</span></li>
<li><a name="a990"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$var_name </span><span class="src-doc">   name of variable</span></li>
<li><a name="a991"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$var_type </span><span class="src-doc">   type of variable (POST, GET, COOKIE, SCRIPT, SESSION or DBSESSION)</span></li>
<li><a name="a992"></a><span class="src-doc">     *                                 (note: SCRIPT means, declared variable above the function)</span></li>
<li><a name="a993"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">               value of variable or &quot;&quot;, if invalid</span></li>
<li><a name="a994"></a><span class="src-doc">     */</span></li>
<li><a name="a995"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_user_var">get_user_var</a><span class="src-sym">(</span><span class="src-var">$var_name</span><span class="src-sym">, </span><span class="src-var">$var_type</span><span class="src-sym">)</span></li>
<li><a name="a996"></a>    <span class="src-sym">{</span></li>
<li><a name="a997"></a>        <span class="src-key">global </span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">, </span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">, </span><span class="src-var">$HTTP_SESSION_VARS</span><span class="src-sym">, </span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">;</span></li>
<li><a name="a998"></a>&nbsp;</li>
<li><a name="a999"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1000"></a>&nbsp;</li>
<li><a name="a1001"></a>        <span class="src-var">$types </span>= <a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-str">&quot;,&quot;</span><span class="src-sym">, </span><span class="src-var">$var_type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1002"></a>&nbsp;</li>
<li><a name="a1003"></a>        <span class="src-key">while </span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">) </span>= <a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$types</span><span class="src-sym">))</span></li>
<li><a name="a1004"></a>        <span class="src-sym">{</span></li>
<li><a name="a1005"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>== <span class="src-str">&quot;POST&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1006"></a>            <span class="src-sym">{</span></li>
<li><a name="a1007"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">))</span></li>
<li><a name="a1008"></a>                <span class="src-sym">{</span></li>
<li><a name="a1009"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1010"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1011"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1012"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1013"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1014"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1015"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1016"></a>                                <span class="src-key">return </span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1017"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1018"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1019"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1020"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$_POST</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1021"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1022"></a>                <span class="src-sym">}</span></li>
<li><a name="a1023"></a>                <span class="src-key">else</span></li>
<li><a name="a1024"></a>                <span class="src-sym">{</span></li>
<li><a name="a1025"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1026"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1027"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1028"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1029"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1030"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1031"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1032"></a>                                <span class="src-key">return </span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1033"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1034"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1035"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1036"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$HTTP_POST_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1037"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1038"></a>                <span class="src-sym">}</span></li>
<li><a name="a1039"></a>            <span class="src-sym">}</span></li>
<li><a name="a1040"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>== <span class="src-str">&quot;GET&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1041"></a>            <span class="src-sym">{</span></li>
<li><a name="a1042"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">))</span></li>
<li><a name="a1043"></a>                <span class="src-sym">{</span></li>
<li><a name="a1044"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1045"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1046"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1047"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1048"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1049"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1050"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1051"></a>                                <span class="src-key">return </span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1052"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1053"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1054"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1055"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$_GET</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1056"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1057"></a>                <span class="src-sym">}</span></li>
<li><a name="a1058"></a>                <span class="src-key">else</span></li>
<li><a name="a1059"></a>                <span class="src-sym">{</span></li>
<li><a name="a1060"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1061"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1062"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1063"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1064"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1065"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1066"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1067"></a>                                <span class="src-key">return </span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1068"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1069"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1070"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1071"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$HTTP_GET_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1072"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1073"></a>                <span class="src-sym">}</span></li>
<li><a name="a1074"></a>            <span class="src-sym">}</span></li>
<li><a name="a1075"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>== <span class="src-str">&quot;COOKIE&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1076"></a>            <span class="src-sym">{</span></li>
<li><a name="a1077"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">))</span></li>
<li><a name="a1078"></a>                <span class="src-sym">{</span></li>
<li><a name="a1079"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1080"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1081"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1082"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1083"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1084"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1085"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1086"></a>                                <span class="src-key">return </span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1087"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1088"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1089"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1090"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$_COOKIE</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1091"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1092"></a>                <span class="src-sym">}</span></li>
<li><a name="a1093"></a>                <span class="src-key">else</span></li>
<li><a name="a1094"></a>                <span class="src-sym">{</span></li>
<li><a name="a1095"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1096"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1097"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/get_magic_quotes_gpc">get_magic_quotes_gpc</a><span class="src-sym">(</span><span class="src-sym">))</span></li>
<li><a name="a1098"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1099"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1100"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1101"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodremove_magic_quotes">remove_magic_quotes</a><span class="src-sym">(</span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1102"></a>                                <span class="src-key">return </span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1103"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1104"></a>                            <span class="src-key">else    </span><span class="src-key">return </span><a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1105"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1106"></a>                        <span class="src-key">else        </span><span class="src-key">return </span><span class="src-var">$HTTP_COOKIE_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1107"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1108"></a>                <span class="src-sym">}</span></li>
<li><a name="a1109"></a>            <span class="src-sym">}</span></li>
<li><a name="a1110"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>== <span class="src-str">&quot;SESSION&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1111"></a>            <span class="src-sym">{</span></li>
<li><a name="a1112"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">))</span></li>
<li><a name="a1113"></a>                <span class="src-sym">{</span></li>
<li><a name="a1114"></a>                   <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1115"></a>                        <span class="src-key">return </span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1116"></a>                <span class="src-sym">}</span></li>
<li><a name="a1117"></a>                <span class="src-key">else</span></li>
<li><a name="a1118"></a>                <span class="src-sym">{</span></li>
<li><a name="a1119"></a>                    <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$HTTP_SESSION_VARS</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$HTTP_SESSION_VARS</span><span class="src-sym">)))</span></li>
<li><a name="a1120"></a>                        <span class="src-key">return </span><span class="src-var">$HTTP_SESSION_VARS</span><span class="src-sym">[</span><span class="src-var">$var_name</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1121"></a>                <span class="src-sym">}</span></li>
<li><a name="a1122"></a>            <span class="src-sym">}</span></li>
<li><a name="a1123"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">) </span>== <span class="src-str">&quot;DBSESSION&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_handler">m_dbsession_handler</a><span class="src-sym">))</span></li>
<li><a name="a1124"></a>            <span class="src-sym">{</span></li>
<li><a name="a1125"></a>                <span class="src-var">$SID </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_dbsession_id">m_dbsession_id</a><span class="src-sym">;</span></li>
<li><a name="a1126"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$SID</span><span class="src-sym">))</span></li>
<li><a name="a1127"></a>                <span class="src-sym">{</span></li>
<li><a name="a1128"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;get_user_var&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;dbsession_id is missing (DBSESSION)&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1129"></a>                <span class="src-sym">}</span></li>
<li><a name="a1130"></a>&nbsp;</li>
<li><a name="a1131"></a>                <span class="src-var">$tmp_rc </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methoddbsession_read">dbsession_read</a><span class="src-sym">(</span><span class="src-var">$SID</span><span class="src-sym">,</span><span class="src-var">$var_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1132"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">))    </span><span class="src-key">return </span><span class="src-var">$tmp_rc</span><span class="src-sym">;</span></li>
<li><a name="a1133"></a>            <span class="src-sym">}</span></li>
<li><a name="a1134"></a>        <span class="src-sym">}</span></li>
<li><a name="a1135"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1136"></a>    <span class="src-sym">}</span></li>
<li><a name="a1137"></a>&nbsp;</li>
<li><a name="a1138"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1139"></a><span class="src-doc">     * search needle in multi array</span></li>
<li><a name="a1140"></a><span class="src-doc">     *</span></li>
<li><a name="a1141"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$needle </span></li>
<li><a name="a1142"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$haystack </span></li>
<li><a name="a1143"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a1144"></a><span class="src-doc">     */</span></li>
<li><a name="a1145"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodin_multi_array">in_multi_array</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">, </span><span class="src-var">$haystack</span><span class="src-sym">)</span></li>
<li><a name="a1146"></a>    <span class="src-sym">{</span></li>
<li><a name="a1147"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1148"></a>&nbsp;</li>
<li><a name="a1149"></a>        <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">))</span></li>
<li><a name="a1150"></a>        <span class="src-sym">{</span></li>
<li><a name="a1151"></a>            <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">, </span><span class="src-var">$haystack</span><span class="src-sym">))</span></li>
<li><a name="a1152"></a>            <span class="src-sym">{</span></li>
<li><a name="a1153"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1154"></a>            <span class="src-sym">}</span></li>
<li><a name="a1155"></a>            <span class="src-key">else</span></li>
<li><a name="a1156"></a>            <span class="src-sym">{</span></li>
<li><a name="a1157"></a>                <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">)</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a1158"></a>                <span class="src-sym">{</span></li>
<li><a name="a1159"></a>                    <span class="src-key">if</span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1160"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1161"></a>                        <span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodin_multi_array">in_multi_array</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">, </span><span class="src-var">$haystack</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1162"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1163"></a>                            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1164"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1165"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1166"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1167"></a>                <span class="src-sym">}</span></li>
<li><a name="a1168"></a>            <span class="src-sym">}</span></li>
<li><a name="a1169"></a>        <span class="src-sym">}</span></li>
<li><a name="a1170"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1171"></a>    <span class="src-sym">}</span></li>
<li><a name="a1172"></a>&nbsp;</li>
<li><a name="a1173"></a>   <span class="src-doc">/**</span></li>
<li><a name="a1174"></a><span class="src-doc">    * Removes duplicate values from an array (recursive)</span></li>
<li><a name="a1175"></a><span class="src-doc">    *             (this function is much slower than the internal php function)</span></li>
<li><a name="a1176"></a><span class="src-doc">    *</span></li>
<li><a name="a1177"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$thearray </span><span class="src-doc">   array to unique</span></li>
<li><a name="a1178"></a><span class="src-doc">    * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">array </span></li>
<li><a name="a1179"></a><span class="src-doc">    */</span></li>
<li><a name="a1180"></a>   <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodarray_unique">array_unique</a><span class="src-sym">(</span><span class="src-sym">&amp;</span><span class="src-var">$thearray</span><span class="src-sym">)</span></li>
<li><a name="a1181"></a>   <span class="src-sym">{</span></li>
<li><a name="a1182"></a>      <a href="http://www.php.net/sort">sort</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1183"></a>      <a href="http://www.php.net/reset">reset</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1184"></a>&nbsp;</li>
<li><a name="a1185"></a>      <span class="src-var">$newarray </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1186"></a>      <span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1187"></a>      <span class="src-var">$element </span>= <a href="http://www.php.net/current">current</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1188"></a>      <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$n</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$n</span>&lt;<a href="http://www.php.net/sizeof">sizeof</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$n</span>++<span class="src-sym">)</span></li>
<li><a name="a1189"></a>      <span class="src-sym">{</span></li>
<li><a name="a1190"></a>         <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/next">next</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">) </span>!= <span class="src-var">$element</span><span class="src-sym">)</span></li>
<li><a name="a1191"></a>         <span class="src-sym">{</span></li>
<li><a name="a1192"></a>            <span class="src-var">$newarray</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">] </span>= <span class="src-var">$element</span><span class="src-sym">;</span></li>
<li><a name="a1193"></a>            <span class="src-var">$element </span>= <a href="http://www.php.net/current">current</a><span class="src-sym">(</span><span class="src-var">$thearray</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1194"></a>            <span class="src-var">$i</span>++<span class="src-sym">;</span></li>
<li><a name="a1195"></a>         <span class="src-sym">}</span></li>
<li><a name="a1196"></a>      <span class="src-sym">}</span></li>
<li><a name="a1197"></a>      <span class="src-key">return </span><span class="src-var">$newarray</span><span class="src-sym">;</span></li>
<li><a name="a1198"></a>   <span class="src-sym">}</span></li>
<li><a name="a1199"></a>&nbsp;</li>
<li><a name="a1200"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1201"></a><span class="src-doc">     * sort array (subfunction for usort)</span></li>
<li><a name="a1202"></a><span class="src-doc">     *</span></li>
<li><a name="a1203"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$a </span><span class="src-doc">   keys</span></li>
<li><a name="a1204"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$b </span><span class="src-doc">   values</span></li>
<li><a name="a1205"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">array </span></li>
<li><a name="a1206"></a><span class="src-doc">     */</span></li>
<li><a name="a1207"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodarray_sort">array_sort</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">, </span><span class="src-var">$b</span><span class="src-sym">)</span></li>
<li><a name="a1208"></a>    <span class="src-sym">{</span></li>
<li><a name="a1209"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1210"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1211"></a>&nbsp;</li>
<li><a name="a1212"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;A&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1213"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;O&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1214"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;U&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1215"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1216"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;A&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1217"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;O&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1218"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;U&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1219"></a>&nbsp;</li>
<li><a name="a1220"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$as </span>== <span class="src-var">$bs</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1221"></a>        <span class="src-key">else </span><span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$as </span>&gt; <span class="src-var">$bs</span><span class="src-sym">)</span>?<span class="src-num">1</span>:-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1222"></a>    <span class="src-sym">}</span></li>
<li><a name="a1223"></a>&nbsp;</li>
<li><a name="a1224"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1225"></a><span class="src-doc">     *reverse sort array (subfunction for usort)</span></li>
<li><a name="a1226"></a><span class="src-doc">     *</span></li>
<li><a name="a1227"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$a </span><span class="src-doc">   keys</span></li>
<li><a name="a1228"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$b </span><span class="src-doc">   values</span></li>
<li><a name="a1229"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">array </span></li>
<li><a name="a1230"></a><span class="src-doc">     */</span></li>
<li><a name="a1231"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodarray_rsort">array_rsort</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">, </span><span class="src-var">$b</span><span class="src-sym">)</span></li>
<li><a name="a1232"></a>    <span class="src-sym">{</span></li>
<li><a name="a1233"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$a</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1234"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$b</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1235"></a>&nbsp;</li>
<li><a name="a1236"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;A&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1237"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;O&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1238"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;U&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1239"></a>        <span class="src-var">$as </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$as</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1240"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;A&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1241"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;O&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1242"></a>        <span class="src-var">$bs </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$bs</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;U&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1243"></a>&nbsp;</li>
<li><a name="a1244"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$as </span>== <span class="src-var">$bs</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1245"></a>        <span class="src-key">else </span><span class="src-key">return </span><span class="src-sym">(</span><span class="src-var">$as </span>&lt; <span class="src-var">$bs</span><span class="src-sym">)</span>?<span class="src-num">1</span>:-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1246"></a>    <span class="src-sym">}</span></li>
<li><a name="a1247"></a>&nbsp;</li>
<li><a name="a1248"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1249"></a><span class="src-doc">     * the current date</span></li>
<li><a name="a1250"></a><span class="src-doc">     *</span></li>
<li><a name="a1251"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$date_format </span><span class="src-doc">   see member variables $this-&gt;date_format below</span></li>
<li><a name="a1252"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">date </span></li>
<li><a name="a1253"></a><span class="src-doc">     */</span></li>
<li><a name="a1254"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcurrentDate">currentDate</a><span class="src-sym">(</span><span class="src-var">$date_format</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1255"></a>    <span class="src-sym">{</span></li>
<li><a name="a1256"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$date_format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$date_format</span><span class="src-sym">)))    </span><span class="src-var">$date_format </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a><span class="src-sym">;</span></li>
<li><a name="a1257"></a>&nbsp;</li>
<li><a name="a1258"></a>        <span class="src-var">$day   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;d&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1259"></a>        <span class="src-var">$month </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;m&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1260"></a>        <span class="src-var">$year  </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1261"></a>&nbsp;</li>
<li><a name="a1262"></a>        <span class="src-key">if      </span><span class="src-sym">(</span><span class="src-var">$date_format</span>==<span class="src-str">&quot;I&quot;</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a>.<span class="src-var">$day  </span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1263"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_format</span>==<span class="src-str">&quot;S&quot;</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-var">$year </span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a>.<span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a>.<span class="src-var">$day</span><span class="src-sym">;</span></li>
<li><a name="a1264"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_format</span>==<span class="src-str">&quot;C&quot;</span><span class="src-sym">) </span><span class="src-key">return </span><span class="src-var">$year                </span>.<span class="src-var">$month</span>.               <span class="src-var">$day</span><span class="src-sym">;</span></li>
<li><a name="a1265"></a>        <span class="src-key">else                        </span><span class="src-key">return </span><span class="src-var">$day  </span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a>.<span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1266"></a>    <span class="src-sym">}</span></li>
<li><a name="a1267"></a>&nbsp;</li>
<li><a name="a1268"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1269"></a><span class="src-doc">     * the current time</span></li>
<li><a name="a1270"></a><span class="src-doc">     *</span></li>
<li><a name="a1271"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$time_format </span><span class="src-doc">   see member variable $this-&gt;time_format below</span></li>
<li><a name="a1272"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">time </span></li>
<li><a name="a1273"></a><span class="src-doc">     */</span></li>
<li><a name="a1274"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcurrentTime">currentTime</a><span class="src-sym">(</span><span class="src-var">$time_format</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1275"></a>    <span class="src-sym">{</span></li>
<li><a name="a1276"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)))    </span><span class="src-var">$time_format </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a><span class="src-sym">;</span></li>
<li><a name="a1277"></a>&nbsp;</li>
<li><a name="a1278"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$time_format</span>==<span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1279"></a>            <span class="src-key">return </span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;H&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;:&quot;</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;i&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;:&quot;</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;s&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1280"></a>        <span class="src-key">else</span></li>
<li><a name="a1281"></a>            <span class="src-key">return </span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;h&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;:&quot;</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;i&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;:&quot;</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;s&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot; &quot;</span>.<a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;a&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1282"></a>    <span class="src-sym">}</span></li>
<li><a name="a1283"></a>&nbsp;</li>
<li><a name="a1284"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1285"></a><span class="src-doc">     * Get date from db-date format</span></li>
<li><a name="a1286"></a><span class="src-doc">     * (short form of convDate)</span></li>
<li><a name="a1287"></a><span class="src-doc">     *</span></li>
<li><a name="a1288"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dbdate </span></li>
<li><a name="a1289"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$short_mode </span></li>
<li><a name="a1290"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a1291"></a><span class="src-doc">     */</span></li>
<li><a name="a1292"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodshow_dbdate">show_dbdate</a><span class="src-sym">(</span><span class="src-var">$dbdate</span><span class="src-sym">, </span><span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a1293"></a>    <span class="src-sym">{</span></li>
<li><a name="a1294"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$short_mode</span>==<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a1295"></a>        <span class="src-sym">{</span></li>
<li><a name="a1296"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$dbdate</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a><span class="src-sym">, </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'short_mode'</span>=&gt;<span class="src-id">true</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1297"></a>        <span class="src-sym">}</span></li>
<li><a name="a1298"></a>        <span class="src-key">else</span></li>
<li><a name="a1299"></a>        <span class="src-sym">{</span></li>
<li><a name="a1300"></a>            <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$dbdate</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1301"></a>        <span class="src-sym">}</span></li>
<li><a name="a1302"></a>    <span class="src-sym">}</span></li>
<li><a name="a1303"></a>&nbsp;</li>
<li><a name="a1304"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1305"></a><span class="src-doc">     * Get Datetime from db-date format</span></li>
<li><a name="a1306"></a><span class="src-doc">     * (short form of convDate)</span></li>
<li><a name="a1307"></a><span class="src-doc">     *</span></li>
<li><a name="a1308"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dbdate </span></li>
<li><a name="a1309"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_seconds </span></li>
<li><a name="a1310"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$short_mode </span></li>
<li><a name="a1311"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$at </span></li>
<li><a name="a1312"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a1313"></a><span class="src-doc">     */</span></li>
<li><a name="a1314"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodshow_dbdatetime">show_dbdatetime</a><span class="src-sym">(</span><span class="src-var">$dbdate</span><span class="src-sym">, </span><span class="src-var">$with_seconds</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$at</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1315"></a>    <span class="src-sym">{</span></li>
<li><a name="a1316"></a>        <span class="src-key">return </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDateTime">convDateTime</a><span class="src-sym">(</span><span class="src-var">$dbdate</span><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a><span class="src-sym">, </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a><span class="src-sym">, </span><span class="src-var">$with_seconds</span><span class="src-sym">, </span><span class="src-var">$short_mode</span><span class="src-sym">, </span><span class="src-var">$at</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1317"></a>    <span class="src-sym">}</span></li>
<li><a name="a1318"></a>&nbsp;</li>
<li><a name="a1319"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1320"></a><span class="src-doc">     * Removes all whitespaces in a string</span></li>
<li><a name="a1321"></a><span class="src-doc">     *</span></li>
<li><a name="a1322"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span></li>
<li><a name="a1323"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a1324"></a><span class="src-doc">     */</span></li>
<li><a name="a1325"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodkillSpace">killSpace</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span></li>
<li><a name="a1326"></a>    <span class="src-sym">{</span></li>
<li><a name="a1327"></a>        <span class="src-var">$rc </span>= <a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1328"></a>        <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;nbsp;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1329"></a>        <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;#160;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1330"></a>        <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1331"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1332"></a>    <span class="src-sym">}</span></li>
<li><a name="a1333"></a>&nbsp;</li>
<li><a name="a1334"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1335"></a><span class="src-doc">     * validate given date</span></li>
<li><a name="a1336"></a><span class="src-doc">     *</span></li>
<li><a name="a1337"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$timestamp </span><span class="src-doc">   array of date for validating or timestamp</span></li>
<li><a name="a1338"></a><span class="src-doc">     *                                     array keys:    timestamp['year']</span></li>
<li><a name="a1339"></a><span class="src-doc">     *                                               timestamp['month']</span></li>
<li><a name="a1340"></a><span class="src-doc">      *                                                 timestamp['day']</span></li>
<li><a name="a1341"></a><span class="src-doc">     *                                                timestamp['hour']</span></li>
<li><a name="a1342"></a><span class="src-doc">     *                                                  timestamp['minute']</span></li>
<li><a name="a1343"></a><span class="src-doc">     *                                                   timestamp['second']</span></li>
<li><a name="a1344"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">       if true, input date is a timestamp {default: false}</span></li>
<li><a name="a1345"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">timestamp </span><span class="src-doc">           timestamp with valid date, if invalid input datas, return timestamp will</span></li>
<li><a name="a1346"></a><span class="src-doc">     *                                 be return the nearest valid date</span></li>
<li><a name="a1347"></a><span class="src-doc">     */</span></li>
<li><a name="a1348"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodvalidate_timestamp">validate_timestamp</a><span class="src-sym">(</span><span class="src-var">$timestamp</span><span class="src-sym">,</span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a1349"></a>    <span class="src-sym">{</span></li>
<li><a name="a1350"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a1351"></a>        <span class="src-sym">{</span></li>
<li><a name="a1352"></a>            <span class="src-var">$timestamp </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'hour'</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1353"></a>                            <span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'minute'</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1354"></a>                            <span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'second'</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1355"></a>                            <span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'month'</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1356"></a>                            <span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'day'</span><span class="src-sym">]</span><span class="src-sym">,</span></li>
<li><a name="a1357"></a>                            <span class="src-var">$timestamp</span><span class="src-sym">[</span><span class="src-str">'year'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1358"></a>        <span class="src-sym">}</span></li>
<li><a name="a1359"></a>&nbsp;</li>
<li><a name="a1360"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$timestamp</span>&lt;<a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1970</span><span class="src-sym">))</span></li>
<li><a name="a1361"></a>            <span class="src-key">return </span><a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1970</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1362"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$timestamp</span>&gt;<a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">,</span><span class="src-num">31</span><span class="src-sym">,</span><span class="src-num">2037</span><span class="src-sym">))</span></li>
<li><a name="a1363"></a>            <span class="src-key">return </span><a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">12</span><span class="src-sym">,</span><span class="src-num">31</span><span class="src-sym">,</span><span class="src-num">2037</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1364"></a>        <span class="src-key">else</span></li>
<li><a name="a1365"></a>            <span class="src-key">return </span><span class="src-var">$timestamp</span><span class="src-sym">;</span></li>
<li><a name="a1366"></a>    <span class="src-sym">}</span></li>
<li><a name="a1367"></a>&nbsp;</li>
<li><a name="a1368"></a>       <span class="src-doc">/**</span></li>
<li><a name="a1369"></a><span class="src-doc">        *    calculates days to a given date</span></li>
<li><a name="a1370"></a><span class="src-doc">        *</span></li>
<li><a name="a1371"></a><span class="src-doc">        * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">date </span><span class="src-doc">   </span><span class="src-doc-var">$start_date </span><span class="src-doc">       first date</span></li>
<li><a name="a1372"></a><span class="src-doc">        * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">date </span><span class="src-doc">   </span><span class="src-doc-var">$end_date </span><span class="src-doc">       last date</span></li>
<li><a name="a1373"></a><span class="src-doc">        * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$date_format </span><span class="src-doc">   see member variables $this-&gt;date_format below</span></li>
<li><a name="a1374"></a><span class="src-doc">        * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">                       number of days, if date is out of range -1</span></li>
<li><a name="a1375"></a><span class="src-doc">        */</span></li>
<li><a name="a1376"></a>       <span class="src-key">function </span><a href="../cphplib/cphplib.html#methoddate2days">date2days</a><span class="src-sym">(</span><span class="src-var">$start_date</span><span class="src-sym">, </span><span class="src-var">$end_date</span><span class="src-sym">, </span><span class="src-var">$date_format</span>=<span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1377"></a>    <span class="src-sym">{</span></li>
<li><a name="a1378"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_format</span>!=<span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1379"></a>        <span class="src-sym">{</span></li>
<li><a name="a1380"></a>            <span class="src-var">$start_date </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$start_date</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1381"></a>            <span class="src-var">$end_date   </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$end_date</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1382"></a>        <span class="src-sym">}</span></li>
<li><a name="a1383"></a>&nbsp;</li>
<li><a name="a1384"></a>           <span class="src-var">$start_year  </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$start_date</span><span class="src-sym">,</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1385"></a>           <span class="src-var">$start_month </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1386"></a>           <span class="src-var">$start_day   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1387"></a>&nbsp;</li>
<li><a name="a1388"></a>           <span class="src-var">$end_year  </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$end_date</span><span class="src-sym">,</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1389"></a>           <span class="src-var">$end_month </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1390"></a>           <span class="src-var">$end_day   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1391"></a>&nbsp;</li>
<li><a name="a1392"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-str">&quot;Date.php&quot;</span><span class="src-sym">))</span></li>
<li><a name="a1393"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;Date.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1394"></a>        <span class="src-key">else</span></li>
<li><a name="a1395"></a>        <span class="src-sym">{</span></li>
<li><a name="a1396"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;date2days&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Pear \&quot;Date Package\&quot; required.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1397"></a>        <span class="src-sym">}</span></li>
<li><a name="a1398"></a>&nbsp;</li>
<li><a name="a1399"></a>        <span class="src-key">return </span><span class="src-id">Date_Calc</span><span class="src-sym">::</span><span class="src-id">dateDiff</span><span class="src-sym">(</span><span class="src-var">$start_day</span><span class="src-sym">,</span><span class="src-var">$start_month</span><span class="src-sym">,</span><span class="src-var">$start_year</span><span class="src-sym">,</span><span class="src-var">$end_day</span><span class="src-sym">,</span><span class="src-var">$end_month</span><span class="src-sym">,</span><span class="src-var">$end_year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1400"></a>    <span class="src-sym">}</span></li>
<li><a name="a1401"></a>&nbsp;</li>
<li><a name="a1402"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1403"></a><span class="src-doc">     * return file extension</span></li>
<li><a name="a1404"></a><span class="src-doc">     *</span></li>
<li><a name="a1405"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$filename </span></li>
<li><a name="a1406"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a1407"></a><span class="src-doc">     */</span></li>
<li><a name="a1408"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodfileExtension">fileExtension</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span></li>
<li><a name="a1409"></a>    <span class="src-sym">{</span></li>
<li><a name="a1410"></a>        <span class="src-var">$rc</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1411"></a>        <span class="src-var">$max_length </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1412"></a>        <span class="src-var">$counter</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1413"></a>&nbsp;</li>
<li><a name="a1414"></a>        <span class="src-key">while</span><span class="src-sym">(</span><span class="src-var">$max_length</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1415"></a>        <span class="src-sym">{</span></li>
<li><a name="a1416"></a>            <span class="src-var">$ch </span>= <span class="src-var">$filename</span><span class="src-sym">[</span><span class="src-var">$max_length</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1417"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ch </span>== <span class="src-str">&quot;.&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1418"></a>                <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a1419"></a>            <span class="src-var">$rc </span>.= <span class="src-var">$ch</span><span class="src-sym">;</span></li>
<li><a name="a1420"></a>            <span class="src-var">$max_length</span>--<span class="src-sym">;</span></li>
<li><a name="a1421"></a>            <span class="src-var">$counter</span>++<span class="src-sym">;</span></li>
<li><a name="a1422"></a>        <span class="src-sym">}</span></li>
<li><a name="a1423"></a>&nbsp;</li>
<li><a name="a1424"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rc</span>!=<span class="src-str">&quot;&quot;</span><span class="src-sym">) </span><span class="src-var">$rc </span>= <a href="http://www.php.net/strrev">strrev</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1425"></a>&nbsp;</li>
<li><a name="a1426"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1427"></a>    <span class="src-sym">}</span></li>
<li><a name="a1428"></a>&nbsp;</li>
<li><a name="a1429"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1430"></a><span class="src-doc">     * convert string to number while converting old seperator with &quot;.&quot;</span></li>
<li><a name="a1431"></a><span class="src-doc">     *</span></li>
<li><a name="a1432"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$value </span><span class="src-doc">       string to convert {default: &quot;,&quot;}</span></li>
<li><a name="a1433"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$sep_old </span><span class="src-doc">   old seperator</span></li>
<li><a name="a1434"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">float </span></li>
<li><a name="a1435"></a><span class="src-doc">     */</span></li>
<li><a name="a1436"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvToNum">convToNum</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">,</span><span class="src-var">$sep_old</span>=<span class="src-str">&quot;,&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1437"></a>    <span class="src-sym">{</span></li>
<li><a name="a1438"></a>       <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1439"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span></li>
<li><a name="a1440"></a>       <span class="src-sym">{</span></li>
<li><a name="a1441"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;convtoNum&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;missing parameter sep_old&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1442"></a>       <span class="src-sym">}</span></li>
<li><a name="a1443"></a>&nbsp;</li>
<li><a name="a1444"></a>       <span class="src-var">$st      </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1445"></a>       <span class="src-var">$sep_new </span>= <span class="src-str">&quot;.&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1446"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">))</span></li>
<li><a name="a1447"></a>       <span class="src-sym">{</span></li>
<li><a name="a1448"></a>          <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">))</span></li>
<li><a name="a1449"></a>          <span class="src-sym">{</span></li>
<li><a name="a1450"></a>             <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sep_old </span>!= <span class="src-var">$sep_new</span><span class="src-sym">)</span></li>
<li><a name="a1451"></a>             <span class="src-sym">{</span></li>
<li><a name="a1452"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">))</span></li>
<li><a name="a1453"></a>                <span class="src-sym">{</span></li>
<li><a name="a1454"></a>                   <span class="src-var">$num_sep </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1455"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$num_sep</span>==<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a1456"></a>                      <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">,</span><span class="src-var">$sep_new</span><span class="src-sym">,</span><span class="src-var">$st</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1457"></a>                   <span class="src-key">else</span></li>
<li><a name="a1458"></a>                      <span class="src-var">$rc </span>= <span class="src-var">$st</span><span class="src-sym">;</span></li>
<li><a name="a1459"></a>                <span class="src-sym">}</span></li>
<li><a name="a1460"></a>             <span class="src-sym">}</span></li>
<li><a name="a1461"></a>             <span class="src-key">else</span></li>
<li><a name="a1462"></a>                <span class="src-var">$rc </span>= <span class="src-var">$st</span><span class="src-sym">;</span></li>
<li><a name="a1463"></a>          <span class="src-sym">}</span></li>
<li><a name="a1464"></a>       <span class="src-sym">}</span></li>
<li><a name="a1465"></a>       <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1466"></a>    <span class="src-sym">}</span></li>
<li><a name="a1467"></a>&nbsp;</li>
<li><a name="a1468"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1469"></a><span class="src-doc">     * convert seperator in number and fill number to specified length</span></li>
<li><a name="a1470"></a><span class="src-doc">     *</span></li>
<li><a name="a1471"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">float </span><span class="src-doc">   </span><span class="src-doc-var">$st </span><span class="src-doc">           number to convert</span></li>
<li><a name="a1472"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$sep_new </span><span class="src-doc">   new seperator {default: &quot;.&quot;}</span></li>
<li><a name="a1473"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$precision </span><span class="src-doc">   numbers behind seperator  {default: 0 }</span></li>
<li><a name="a1474"></a><span class="src-doc">     *                                 (filling with 0; this function doesn't cut or round numbers)</span></li>
<li><a name="a1475"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$group </span><span class="src-doc">       if set, this group seperator will be used</span></li>
<li><a name="a1476"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">               converted string with number</span></li>
<li><a name="a1477"></a><span class="src-doc">     */</span></li>
<li><a name="a1478"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvnumSep">convnumSep</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">, </span><span class="src-var">$sep_new</span>=<span class="src-str">&quot;.&quot;</span><span class="src-sym">, </span><span class="src-var">$precision</span>=<span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$group</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1479"></a>    <span class="src-sym">{</span></li>
<li><a name="a1480"></a>        <span class="src-var">$rc</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1481"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">))</span></li>
<li><a name="a1482"></a>        <span class="src-sym">{</span></li>
<li><a name="a1483"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">))</span></li>
<li><a name="a1484"></a>            <span class="src-sym">{</span></li>
<li><a name="a1485"></a>                <span class="src-var">$sep_old </span>= <span class="src-str">&quot;.&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1486"></a>                <span class="src-var">$num_sep </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1487"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$num_sep</span>==<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$precision</span>&gt;<span class="src-num">0</span><span class="src-sym">))    </span><span class="src-comm">// no old seperator</span></li>
<li><a name="a1488"></a>                <span class="src-sym">{</span></li>
<li><a name="a1489"></a>                    <span class="src-var">$tmp_st </span>= <span class="src-var">$st</span>.<span class="src-var">$sep_new</span><span class="src-sym">;</span></li>
<li><a name="a1490"></a>                    <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$ix</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$ix</span>&lt;<span class="src-var">$precision</span><span class="src-sym">;</span><span class="src-var">$ix</span>++<span class="src-sym">)</span></li>
<li><a name="a1491"></a>                    <span class="src-var">$tmp_st </span>.= <span class="src-str">&quot;0&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1492"></a>                    <span class="src-var">$rc </span>= <span class="src-var">$tmp_st</span><span class="src-sym">;</span></li>
<li><a name="a1493"></a>                <span class="src-sym">}</span></li>
<li><a name="a1494"></a>                <span class="src-key">else                                    </span><span class="src-comm">// with old seperator</span></li>
<li><a name="a1495"></a>                <span class="src-sym">{</span></li>
<li><a name="a1496"></a>                    <span class="src-var">$ln     </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1497"></a>                    <span class="src-var">$pos    </span>= <a href="http://www.php.net/strrpos">strrpos</a><span class="src-sym">(</span><span class="src-var">$st</span><span class="src-sym">, </span><span class="src-var">$sep_old</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1498"></a>                    <span class="src-var">$ln_ext </span>= <span class="src-var">$ln</span>-<span class="src-var">$pos</span>-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1499"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ln_ext</span>&lt;<span class="src-var">$precision</span><span class="src-sym">)</span></li>
<li><a name="a1500"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1501"></a>                        <span class="src-var">$ln_miss </span>= <span class="src-var">$precision </span>- <span class="src-var">$ln_ext</span><span class="src-sym">;</span></li>
<li><a name="a1502"></a>                        <span class="src-var">$tmp_st</span>=<span class="src-var">$st</span><span class="src-sym">;</span></li>
<li><a name="a1503"></a>                        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$ix</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$ix</span>&lt;<span class="src-var">$ln_miss</span><span class="src-sym">;</span><span class="src-var">$ix</span>++<span class="src-sym">)</span></li>
<li><a name="a1504"></a>                            <span class="src-var">$tmp_st </span>.= <span class="src-str">&quot;0&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1505"></a>&nbsp;</li>
<li><a name="a1506"></a>                        <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">, </span><span class="src-var">$sep_new</span><span class="src-sym">, </span><span class="src-var">$tmp_st</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1507"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1508"></a>                    <span class="src-key">else</span></li>
<li><a name="a1509"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1510"></a>                        <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">, </span><span class="src-var">$sep_new</span><span class="src-sym">, </span><span class="src-var">$st</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1511"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1512"></a>                <span class="src-sym">}</span></li>
<li><a name="a1513"></a>&nbsp;</li>
<li><a name="a1514"></a>                <span class="src-comm">// fill group seperator, if defined</span></li>
<li><a name="a1515"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$group</span><span class="src-sym">))</span></li>
<li><a name="a1516"></a>                <span class="src-sym">{</span></li>
<li><a name="a1517"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span>==<span class="src-str">&quot;-&quot;</span><span class="src-sym">)    </span><span class="src-var">$g_rc </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1518"></a>                    <span class="src-key">else                </span><span class="src-var">$g_rc </span>= <span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1519"></a>                    <span class="src-var">$ln        </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$g_rc</span><span class="src-sym">)</span><span class="src-sym">;    </span><span class="src-comm">// get new length</span></li>
<li><a name="a1520"></a>                    <span class="src-var">$pos    </span>= <a href="http://www.php.net/strrpos">strrpos</a><span class="src-sym">(</span><span class="src-var">$g_rc</span><span class="src-sym">, </span><span class="src-var">$sep_new</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1521"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pos</span>&gt;<span class="src-num">3</span><span class="src-sym">)</span></li>
<li><a name="a1522"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1523"></a>                        <span class="src-var">$suffix_ln    </span>= <span class="src-var">$ln</span>-<span class="src-var">$pos</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1524"></a>                        <span class="src-var">$prefix_ln    </span>= <span class="src-var">$ln</span>-<span class="src-var">$suffix_ln</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a1525"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$prefix_ln</span>&gt;<span class="src-num">3</span><span class="src-sym">)</span></li>
<li><a name="a1526"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1527"></a>                            <span class="src-var">$tmp_rc  </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1528"></a>                            <span class="src-var">$prefix </span>= <a href="http://www.php.net/strrev">strrev</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$g_rc</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$prefix_ln</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1529"></a>                            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$ix</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$ix</span>&lt;<span class="src-var">$prefix_ln</span><span class="src-sym">; </span><span class="src-var">$ix</span>++<span class="src-sym">)</span></li>
<li><a name="a1530"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1531"></a>                                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$ix</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$ix</span>%<span class="src-num">3</span>==<span class="src-num">0</span><span class="src-sym">))    </span><span class="src-var">$tmp_rc </span>.= <span class="src-var">$group</span><span class="src-sym">;</span></li>
<li><a name="a1532"></a>                                <span class="src-var">$tmp_rc </span>.= <span class="src-var">$prefix</span><span class="src-sym">[</span><span class="src-var">$ix</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1533"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1534"></a>                            <span class="src-var">$g_rc </span>= <a href="http://www.php.net/strrev">strrev</a><span class="src-sym">(</span><span class="src-var">$tmp_rc</span><span class="src-sym">)</span>.<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$g_rc</span><span class="src-sym">, </span><span class="src-var">$pos</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1535"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1536"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1537"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span>==<span class="src-str">&quot;-&quot;</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-str">&quot;-&quot;</span>.<span class="src-var">$g_rc</span><span class="src-sym">;</span></li>
<li><a name="a1538"></a>                    <span class="src-key">else                 </span><span class="src-var">$rc </span>= <span class="src-var">$g_rc</span><span class="src-sym">;</span></li>
<li><a name="a1539"></a>                <span class="src-sym">}</span></li>
<li><a name="a1540"></a>            <span class="src-sym">}</span></li>
<li><a name="a1541"></a>        <span class="src-sym">}</span></li>
<li><a name="a1542"></a>        <span class="src-key">else</span></li>
<li><a name="a1543"></a>            <span class="src-var">$rc </span>= <span class="src-var">$st</span><span class="src-sym">;</span></li>
<li><a name="a1544"></a>&nbsp;</li>
<li><a name="a1545"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1546"></a>    <span class="src-sym">}</span></li>
<li><a name="a1547"></a>&nbsp;</li>
<li><a name="a1548"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1549"></a><span class="src-doc">     * validate time format and convert it into right format</span></li>
<li><a name="a1550"></a><span class="src-doc">     *</span></li>
<li><a name="a1551"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$time </span><span class="src-doc">   time (or date) to convert, if empty NOW will be used</span></li>
<li><a name="a1552"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$format </span><span class="src-doc">   if empty or time, e.g. 19:45:59</span></li>
<li><a name="a1553"></a><span class="src-doc">     *                             datetime, e.g. 2002-07-20 21:02:55</span></li>
<li><a name="a1554"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">           converted time, if wrong input false</span></li>
<li><a name="a1555"></a><span class="src-doc">     */</span></li>
<li><a name="a1556"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvToTimestamp">convToTimestamp</a><span class="src-sym">(</span><span class="src-var">$time</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$format</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1557"></a>    <span class="src-sym">{</span></li>
<li><a name="a1558"></a>       <span class="src-var">$timestamp </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1559"></a>&nbsp;</li>
<li><a name="a1560"></a>       <span class="src-key">if </span><span class="src-sym">((</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$format</span>==<span class="src-str">&quot;time&quot;</span><span class="src-sym">))    </span><span class="src-comm">// only time</span></li>
<li><a name="a1561"></a>       <span class="src-sym">{</span></li>
<li><a name="a1562"></a>          <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">)) </span><span class="src-var">$timestamp </span>= <a href="http://www.php.net/strtotime">strtotime</a><span class="src-sym">(</span><span class="src-str">&quot;now&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1563"></a>          <span class="src-key">else</span></li>
<li><a name="a1564"></a>          <span class="src-sym">{</span></li>
<li><a name="a1565"></a>             <span class="src-var">$t_hours </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1566"></a>             <span class="src-var">$t_min   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1567"></a>             <span class="src-var">$t_sec   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1568"></a>             <span class="src-var">$t_day   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;d&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1569"></a>             <span class="src-var">$t_month </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;m&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1570"></a>             <span class="src-var">$t_year  </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1571"></a>             <span class="src-var">$tmp_stamp </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-var">$t_hours</span><span class="src-sym">,</span><span class="src-var">$t_min</span><span class="src-sym">,</span><span class="src-var">$t_sec</span><span class="src-sym">,</span><span class="src-var">$t_month</span><span class="src-sym">,</span><span class="src-var">$t_day</span><span class="src-sym">,</span><span class="src-var">$t_year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1572"></a>             <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tmp_stamp</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1573"></a>                <span class="src-var">$timestamp </span>= <span class="src-var">$tmp_stamp</span><span class="src-sym">;</span></li>
<li><a name="a1574"></a>          <span class="src-sym">}</span></li>
<li><a name="a1575"></a>       <span class="src-sym">}</span></li>
<li><a name="a1576"></a>       <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$format</span>==<span class="src-str">&quot;datetime&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">))) </span><span class="src-comm">// datetime</span></li>
<li><a name="a1577"></a>       <span class="src-sym">{</span></li>
<li><a name="a1578"></a>          <span class="src-var">$tdate </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-str">&quot; &quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1579"></a>          <span class="src-var">$ttime </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1580"></a>&nbsp;</li>
<li><a name="a1581"></a>          <span class="src-var">$t_year  </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$tdate</span><span class="src-sym">,</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1582"></a>          <span class="src-var">$t_month </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1583"></a>          <span class="src-var">$t_day   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1584"></a>&nbsp;</li>
<li><a name="a1585"></a>          <span class="src-var">$t_hours </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$ttime</span><span class="src-sym">,</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1586"></a>          <span class="src-var">$t_min   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1587"></a>          <span class="src-var">$t_sec   </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1588"></a>&nbsp;</li>
<li><a name="a1589"></a>          <span class="src-var">$tmp_stamp </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-var">$t_hours</span><span class="src-sym">,</span><span class="src-var">$t_min</span><span class="src-sym">,</span><span class="src-var">$t_sec</span><span class="src-sym">,</span><span class="src-var">$t_month</span><span class="src-sym">,</span><span class="src-var">$t_day</span><span class="src-sym">,</span><span class="src-var">$t_year</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1590"></a>          <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tmp_stamp</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1591"></a>             <span class="src-var">$timestamp </span>= <span class="src-var">$tmp_stamp</span><span class="src-sym">;</span></li>
<li><a name="a1592"></a>       <span class="src-sym">}</span></li>
<li><a name="a1593"></a>       <span class="src-key">return </span><span class="src-var">$timestamp</span><span class="src-sym">;</span></li>
<li><a name="a1594"></a>    <span class="src-sym">}</span></li>
<li><a name="a1595"></a>&nbsp;</li>
<li><a name="a1596"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1597"></a><span class="src-doc">     * validate time format and convert it into right format</span></li>
<li><a name="a1598"></a><span class="src-doc">     *</span></li>
<li><a name="a1599"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$time </span><span class="src-doc">           time to convert</span></li>
<li><a name="a1600"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$time_format </span><span class="src-doc">   see member variable $this-&gt;time_format above</span></li>
<li><a name="a1601"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_seconds </span><span class="src-doc">   if false, don't return seconds {default: true}</span></li>
<li><a name="a1602"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   converted time, if wrong input false</span></li>
<li><a name="a1603"></a><span class="src-doc">     */</span></li>
<li><a name="a1604"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvTime">convTime</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">, </span><span class="src-var">$time_format</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$with_seconds</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a1605"></a>    <span class="src-sym">{</span></li>
<li><a name="a1606"></a>       <span class="src-var">$rc</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1607"></a>&nbsp;</li>
<li><a name="a1608"></a>       <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)))    </span><span class="src-var">$time_format </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a><span class="src-sym">;</span></li>
<li><a name="a1609"></a>&nbsp;</li>
<li><a name="a1610"></a>       <span class="src-var">$ln </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1611"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ln </span>== <span class="src-num">5</span><span class="src-sym">)</span></li>
<li><a name="a1612"></a>       <span class="src-sym">{</span></li>
<li><a name="a1613"></a>          <span class="src-var">$part1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">,</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1614"></a>          <span class="src-var">$part2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1615"></a>          <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part1</span><span class="src-sym">)</span>==<span class="src-num">2</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part2</span><span class="src-sym">)</span>==<span class="src-num">2</span><span class="src-sym">))</span></li>
<li><a name="a1616"></a>          <span class="src-sym">{</span></li>
<li><a name="a1617"></a>             <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$part1</span>&gt;=<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part1</span>&lt;<span class="src-num">25</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part2</span>&gt;=<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part2</span>&lt;<span class="src-num">60</span><span class="src-sym">))</span></li>
<li><a name="a1618"></a>             <span class="src-sym">{</span></li>
<li><a name="a1619"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$time_format</span>==<span class="src-str">&quot;N&quot;</span><span class="src-sym">) </span><span class="src-comm">// 12 hours</span></li>
<li><a name="a1620"></a>                <span class="src-sym">{</span></li>
<li><a name="a1621"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$part1</span>&gt;=<span class="src-num">12</span><span class="src-sym">)</span></li>
<li><a name="a1622"></a>                   <span class="src-sym">{</span></li>
<li><a name="a1623"></a>                      <span class="src-var">$part1 </span>= <span class="src-var">$part1</span>-<span class="src-num">12</span><span class="src-sym">;</span></li>
<li><a name="a1624"></a>                      <span class="src-var">$end </span>= <span class="src-str">&quot;&amp;nbsp;pm&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1625"></a>                   <span class="src-sym">}</span></li>
<li><a name="a1626"></a>                   <span class="src-key">else</span></li>
<li><a name="a1627"></a>                   <span class="src-sym">{</span></li>
<li><a name="a1628"></a>                      <span class="src-var">$part1 </span>+= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1629"></a>                      <span class="src-var">$end </span>= <span class="src-str">&quot;&amp;nbsp;am&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1630"></a>                   <span class="src-sym">}</span></li>
<li><a name="a1631"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$part1</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a1632"></a>                      <span class="src-var">$part1 </span>= <span class="src-num">12</span><span class="src-sym">;</span></li>
<li><a name="a1633"></a>                   <span class="src-var">$rc </span>= <span class="src-var">$part1 </span>. <span class="src-str">&quot;:&quot; </span>. <span class="src-var">$part2</span>.<span class="src-var">$end</span><span class="src-sym">;</span></li>
<li><a name="a1634"></a>                <span class="src-sym">}</span></li>
<li><a name="a1635"></a>                <span class="src-key">else            </span><span class="src-comm">// 24 hours</span></li>
<li><a name="a1636"></a>                <span class="src-sym">{</span></li>
<li><a name="a1637"></a>                   <span class="src-var">$rc </span>= <span class="src-var">$part1 </span>. <span class="src-str">&quot;:&quot; </span>. <span class="src-var">$part2</span><span class="src-sym">;</span></li>
<li><a name="a1638"></a>                <span class="src-sym">}</span></li>
<li><a name="a1639"></a>             <span class="src-sym">}</span></li>
<li><a name="a1640"></a>          <span class="src-sym">}</span></li>
<li><a name="a1641"></a>       <span class="src-sym">}</span></li>
<li><a name="a1642"></a>       <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ln </span>&gt;= <span class="src-num">8</span><span class="src-sym">)</span></li>
<li><a name="a1643"></a>       <span class="src-sym">{</span></li>
<li><a name="a1644"></a>          <span class="src-var">$part1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$time</span><span class="src-sym">,</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1645"></a>          <span class="src-var">$part2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1646"></a>          <span class="src-var">$part3 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1647"></a>          <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part3</span><span class="src-sym">)</span>&gt;<span class="src-num">2</span><span class="src-sym">) </span><span class="src-var">$part3 </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$part3</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1648"></a>&nbsp;</li>
<li><a name="a1649"></a>          <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part1</span><span class="src-sym">)</span>==<span class="src-num">2</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part2</span><span class="src-sym">)</span>==<span class="src-num">2</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$part3</span><span class="src-sym">)</span>==<span class="src-num">2</span><span class="src-sym">))</span></li>
<li><a name="a1650"></a>          <span class="src-sym">{</span></li>
<li><a name="a1651"></a>             <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$part1</span>&gt;=<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part1</span>&lt;<span class="src-num">25</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part2</span>&gt;=<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part2</span>&lt;<span class="src-num">60</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part3</span>&gt;=<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$part3</span>&lt;<span class="src-num">60</span><span class="src-sym">))</span></li>
<li><a name="a1652"></a>             <span class="src-sym">{</span></li>
<li><a name="a1653"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$time_format</span>==<span class="src-str">&quot;N&quot;</span><span class="src-sym">) </span><span class="src-comm">// 12 hours</span></li>
<li><a name="a1654"></a>                <span class="src-sym">{</span></li>
<li><a name="a1655"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$part1</span>&gt;<span class="src-num">12</span><span class="src-sym">)</span></li>
<li><a name="a1656"></a>                   <span class="src-sym">{</span></li>
<li><a name="a1657"></a>                      <span class="src-var">$part1 </span>= <span class="src-var">$part1</span>-<span class="src-num">12</span><span class="src-sym">;</span></li>
<li><a name="a1658"></a>                      <span class="src-var">$end </span>= <span class="src-str">&quot;&amp;nbsp;pm&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1659"></a>                   <span class="src-sym">}</span></li>
<li><a name="a1660"></a>                   <span class="src-key">else</span></li>
<li><a name="a1661"></a>                   <span class="src-sym">{</span></li>
<li><a name="a1662"></a>                      <span class="src-var">$part1 </span>+= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a1663"></a>                      <span class="src-var">$end </span>= <span class="src-str">&quot;&amp;nbsp;am&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1664"></a>                   <span class="src-sym">}</span></li>
<li><a name="a1665"></a>                   <span class="src-var">$rc </span>= <span class="src-var">$part1 </span>. <span class="src-str">&quot;:&quot; </span>.<span class="src-var">$part2</span><span class="src-sym">;</span></li>
<li><a name="a1666"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_seconds</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;:&quot;</span>.<span class="src-var">$part3</span><span class="src-sym">;</span></li>
<li><a name="a1667"></a>                   <span class="src-var">$rc </span>.= <span class="src-var">$end</span><span class="src-sym">;</span></li>
<li><a name="a1668"></a>                <span class="src-sym">}</span></li>
<li><a name="a1669"></a>                <span class="src-key">else            </span><span class="src-comm">// 24 hours</span></li>
<li><a name="a1670"></a>                <span class="src-sym">{</span></li>
<li><a name="a1671"></a>                   <span class="src-var">$rc </span>= <span class="src-var">$part1 </span>. <span class="src-str">&quot;:&quot; </span>.<span class="src-var">$part2</span><span class="src-sym">;</span></li>
<li><a name="a1672"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_seconds</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;:&quot;</span>.<span class="src-var">$part3</span><span class="src-sym">;</span></li>
<li><a name="a1673"></a>                <span class="src-sym">}</span></li>
<li><a name="a1674"></a>             <span class="src-sym">}</span></li>
<li><a name="a1675"></a>          <span class="src-sym">}</span></li>
<li><a name="a1676"></a>       <span class="src-sym">}</span></li>
<li><a name="a1677"></a>&nbsp;</li>
<li><a name="a1678"></a>       <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1679"></a>    <span class="src-sym">}</span></li>
<li><a name="a1680"></a>&nbsp;</li>
<li><a name="a1681"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1682"></a><span class="src-doc">     * convert datetime format</span></li>
<li><a name="a1683"></a><span class="src-doc">     *</span></li>
<li><a name="a1684"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">    </span><span class="src-doc-var">$datetime </span><span class="src-doc">       db datetime field format</span></li>
<li><a name="a1685"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$date_format </span><span class="src-doc">   see member variable m_date above</span></li>
<li><a name="a1686"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$time_format </span><span class="src-doc">   see member variable m_time above</span></li>
<li><a name="a1687"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_seconds </span><span class="src-doc">   show seconds</span></li>
<li><a name="a1688"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$short_mode </span><span class="src-doc">       if today, yesterday or tomorrow</span></li>
<li><a name="a1689"></a><span class="src-doc">     *                                     show string for date</span></li>
<li><a name="a1690"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$at </span></li>
<li><a name="a1691"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   datetime in converted format</span></li>
<li><a name="a1692"></a><span class="src-doc">     */</span></li>
<li><a name="a1693"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvDateTime">convDateTime</a><span class="src-sym">(</span><span class="src-var">$datetime</span><span class="src-sym">, </span><span class="src-var">$date_format</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$time_format</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$with_seconds</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$at</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1694"></a>    <span class="src-sym">{</span></li>
<li><a name="a1695"></a>        <span class="src-var">$rc</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1696"></a>&nbsp;</li>
<li><a name="a1697"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$datetime</span><span class="src-sym">))</span></li>
<li><a name="a1698"></a>        <span class="src-sym">{</span></li>
<li><a name="a1699"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$date_format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$date_format</span><span class="src-sym">)))    </span><span class="src-var">$date_format </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$date_format">date_format</a><span class="src-sym">;</span></li>
<li><a name="a1700"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$time_format</span><span class="src-sym">)))    </span><span class="src-var">$time_format </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$time_format">time_format</a><span class="src-sym">;</span></li>
<li><a name="a1701"></a>&nbsp;</li>
<li><a name="a1702"></a>               <span class="src-var">$tmp_date        </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$datetime</span><span class="src-sym">, </span><span class="src-str">&quot; &quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1703"></a>            <span class="src-var">$tmp_time        </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1704"></a>&nbsp;</li>
<li><a name="a1705"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$short_mode</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$tmp_time</span><span class="src-sym">)))</span></li>
<li><a name="a1706"></a>                <span class="src-var">$rc </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$tmp_date</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'short_mode'</span>=&gt;<span class="src-id">true</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1707"></a>            <span class="src-key">else</span></li>
<li><a name="a1708"></a>                <span class="src-var">$rc </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$tmp_date</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1709"></a>&nbsp;</li>
<li><a name="a1710"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$tmp_time</span><span class="src-sym">))</span></li>
<li><a name="a1711"></a>            <span class="src-sym">{</span></li>
<li><a name="a1712"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$at</span><span class="src-sym">))    </span><span class="src-var">$tmp_at </span>= <span class="src-var">$at</span><span class="src-sym">;</span></li>
<li><a name="a1713"></a>                <span class="src-key">else             </span><span class="src-var">$tmp_at </span>= <span class="src-id">STR_AT</span><span class="src-sym">;</span></li>
<li><a name="a1714"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tmp_at</span>!=<span class="src-str">&quot;,&quot;</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1715"></a>                <span class="src-var">$rc </span>.= <span class="src-var">$tmp_at</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1716"></a>                <span class="src-var">$rc </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvTime">convTime</a><span class="src-sym">(</span><span class="src-var">$tmp_time</span><span class="src-sym">, </span><span class="src-var">$time_format</span><span class="src-sym">, </span><span class="src-var">$with_seconds</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1717"></a>            <span class="src-sym">}</span></li>
<li><a name="a1718"></a>        <span class="src-sym">}</span></li>
<li><a name="a1719"></a>&nbsp;</li>
<li><a name="a1720"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1721"></a>    <span class="src-sym">}</span></li>
<li><a name="a1722"></a>&nbsp;</li>
<li><a name="a1723"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1724"></a><span class="src-doc">     * Convert date format</span></li>
<li><a name="a1725"></a><span class="src-doc">     *</span></li>
<li><a name="a1726"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$date_str </span><span class="src-doc">       date to convert</span></li>
<li><a name="a1727"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$src_format </span><span class="src-doc">       see member variables $this-&gt;date_format above</span></li>
<li><a name="a1728"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dest_format </span><span class="src-doc">   see member variables $this-&gt;date_format above or 'short' or 'long'</span></li>
<li><a name="a1729"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$customize </span><span class="src-doc">       year_format string = long : e.g. 2002 {default}</span></li>
<li><a name="a1730"></a><span class="src-doc">     *                                                           short: e.g. 02</span></li>
<li><a name="a1731"></a><span class="src-doc">     *                                                           void : e.g.</span></li>
<li><a name="a1732"></a><span class="src-doc">     *                                        leading_zeros bool = true : e.g. 01 {default}</span></li>
<li><a name="a1733"></a><span class="src-doc">     *                                                           false: e.g. 1</span></li>
<li><a name="a1734"></a><span class="src-doc">     *                                     with_weekday bool    = true:  with weekday</span></li>
<li><a name="a1735"></a><span class="src-doc">     *                                                             false: without weekdays</span></li>
<li><a name="a1736"></a><span class="src-doc">     *                                                                   (only available if dest_format is short or long)</span></li>
<li><a name="a1737"></a><span class="src-doc">     *                                     locale string        = see member variables m_locale above</span></li>
<li><a name="a1738"></a><span class="src-doc">     *                                     first_valid_year    = first valid year, if specified date is before, it will be signed</span></li>
<li><a name="a1739"></a><span class="src-doc">     *                                                              as invalid {default: 1850}</span></li>
<li><a name="a1740"></a><span class="src-doc">     *                                     short_mode            = if today, yesterday or tomorrow</span></li>
<li><a name="a1741"></a><span class="src-doc">     *                                                            show string for date {default: false}</span></li>
<li><a name="a1742"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                    date or {if wrong input) empty</span></li>
<li><a name="a1743"></a><span class="src-doc">     */</span></li>
<li><a name="a1744"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">, </span><span class="src-var">$src_format</span><span class="src-sym">, </span><span class="src-var">$dest_format</span><span class="src-sym">, </span><span class="src-var">$customize</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a1745"></a>    <span class="src-sym">{</span></li>
<li><a name="a1746"></a>        <span class="src-var">$rc                </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1747"></a>        <span class="src-var">$sep_old        </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1748"></a>        <span class="src-var">$sep_new        </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1749"></a>        <span class="src-var">$date_package    </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1750"></a>&nbsp;</li>
<li><a name="a1751"></a>        <span class="src-comm">// all years are possible, but year 0 cannot be selected (does anyone need it?)</span></li>
<li><a name="a1752"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'first_valid_year'</span><span class="src-sym">]</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'first_valid_year'</span><span class="src-sym">]</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a1753"></a>            <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'first_valid_year'</span><span class="src-sym">] </span>= <span class="src-num">1850</span><span class="src-sym">;</span></li>
<li><a name="a1754"></a>&nbsp;</li>
<li><a name="a1755"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-str">&quot;Date.php&quot;</span><span class="src-sym">))</span></li>
<li><a name="a1756"></a>        <span class="src-sym">{</span></li>
<li><a name="a1757"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;Date.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1758"></a>            <span class="src-var">$date_package </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1759"></a>        <span class="src-sym">}</span></li>
<li><a name="a1760"></a>&nbsp;</li>
<li><a name="a1761"></a>        <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'locale'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/setlocale">setlocale</a><span class="src-sym">(</span><span class="src-id">LC_TIME</span><span class="src-sym">,</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'locale'</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a1762"></a>        <span class="src-sym">{</span></li>
<li><a name="a1763"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;convDate&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;locale not readable from system!&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1764"></a>        <span class="src-sym">}</span></li>
<li><a name="a1765"></a>&nbsp;</li>
<li><a name="a1766"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$src_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;L&quot;</span><span class="src-sym">)                    </span><span class="src-comm">// DD.MM.YYYY</span></li>
<li><a name="a1767"></a>        <span class="src-sym">{</span></li>
<li><a name="a1768"></a>            <span class="src-var">$sep_old </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a><span class="src-sym">;</span></li>
<li><a name="a1769"></a>&nbsp;</li>
<li><a name="a1770"></a>            <span class="src-var">$day   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1771"></a>            <span class="src-var">$month </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1772"></a>            <span class="src-var">$year  </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1773"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">20</span><span class="src-sym">)        </span><span class="src-var">$year </span>+= <span class="src-num">2000</span><span class="src-sym">;</span></li>
<li><a name="a1774"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">100</span><span class="src-sym">)    </span><span class="src-var">$year </span>+= <span class="src-num">1900</span><span class="src-sym">;</span></li>
<li><a name="a1775"></a>        <span class="src-sym">}</span></li>
<li><a name="a1776"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$src_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;I&quot;</span><span class="src-sym">)                </span><span class="src-comm">// MM/DD/YYYY</span></li>
<li><a name="a1777"></a>        <span class="src-sym">{</span></li>
<li><a name="a1778"></a>            <span class="src-var">$sep_old </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a><span class="src-sym">;</span></li>
<li><a name="a1779"></a>&nbsp;</li>
<li><a name="a1780"></a>            <span class="src-var">$month </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1781"></a>            <span class="src-var">$day   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1782"></a>            <span class="src-var">$year  </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1783"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">20</span><span class="src-sym">)        </span><span class="src-var">$year </span>+= <span class="src-num">2000</span><span class="src-sym">;</span></li>
<li><a name="a1784"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">100</span><span class="src-sym">)    </span><span class="src-var">$year </span>+= <span class="src-num">1900</span><span class="src-sym">;</span></li>
<li><a name="a1785"></a>        <span class="src-sym">}</span></li>
<li><a name="a1786"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$src_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;S&quot;</span><span class="src-sym">)                </span><span class="src-comm">// YYYY-MM-DD</span></li>
<li><a name="a1787"></a>        <span class="src-sym">{</span></li>
<li><a name="a1788"></a>            <span class="src-var">$sep_old </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a><span class="src-sym">;</span></li>
<li><a name="a1789"></a>&nbsp;</li>
<li><a name="a1790"></a>            <span class="src-var">$year  </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1791"></a>            <span class="src-var">$month </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1792"></a>            <span class="src-var">$day   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$sep_old</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a1793"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">20</span><span class="src-sym">)        </span><span class="src-var">$year </span>+= <span class="src-num">2000</span><span class="src-sym">;</span></li>
<li><a name="a1794"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">100</span><span class="src-sym">)    </span><span class="src-var">$year </span>+= <span class="src-num">1900</span><span class="src-sym">;</span></li>
<li><a name="a1795"></a>        <span class="src-sym">}</span></li>
<li><a name="a1796"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$src_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;C&quot;</span><span class="src-sym">)                </span><span class="src-comm">// YYYYMMDD</span></li>
<li><a name="a1797"></a>        <span class="src-sym">{</span></li>
<li><a name="a1798"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">)</span>==<span class="src-num">8</span><span class="src-sym">)</span></li>
<li><a name="a1799"></a>            <span class="src-sym">{</span></li>
<li><a name="a1800"></a>                <span class="src-var">$year  </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1801"></a>                <span class="src-var">$month </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1802"></a>                <span class="src-var">$day   </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">6</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1803"></a>            <span class="src-sym">}</span></li>
<li><a name="a1804"></a>            <span class="src-key">else</span></li>
<li><a name="a1805"></a>            <span class="src-sym">{</span></li>
<li><a name="a1806"></a>                <span class="src-var">$year  </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1807"></a>                <span class="src-var">$month </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1808"></a>                <span class="src-var">$day   </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$date_str</span><span class="src-sym">,</span><span class="src-num">4</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1809"></a>            <span class="src-sym">}</span></li>
<li><a name="a1810"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">20</span><span class="src-sym">)        </span><span class="src-var">$year </span>+= <span class="src-num">2000</span><span class="src-sym">;</span></li>
<li><a name="a1811"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$year</span>&lt;<span class="src-num">100</span><span class="src-sym">)    </span><span class="src-var">$year </span>+= <span class="src-num">1900</span><span class="src-sym">;</span></li>
<li><a name="a1812"></a>        <span class="src-sym">}</span></li>
<li><a name="a1813"></a>&nbsp;</li>
<li><a name="a1814"></a>        <span class="src-key">if      </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$dest_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;I&quot;</span><span class="src-sym">) </span><span class="src-var">$sep_new </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a><span class="src-sym">;</span></li>
<li><a name="a1815"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$dest_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;S&quot;</span><span class="src-sym">) </span><span class="src-var">$sep_new </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a><span class="src-sym">;</span></li>
<li><a name="a1816"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$dest_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;L&quot;</span><span class="src-sym">) </span><span class="src-var">$sep_new </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a><span class="src-sym">;</span></li>
<li><a name="a1817"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$dest_format</span><span class="src-sym">)</span>==<span class="src-str">&quot;C&quot;</span><span class="src-sym">) </span><span class="src-var">$sep_new </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1818"></a>        <span class="src-key">else </span><span class="src-var">$sep_new </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a><span class="src-sym">;</span></li>
<li><a name="a1819"></a>&nbsp;</li>
<li><a name="a1820"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/checkdate">checkdate</a><span class="src-sym">(</span><span class="src-var">$month</span><span class="src-sym">,</span><span class="src-var">$day</span><span class="src-sym">,</span><span class="src-var">$year</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'first_valid_year'</span><span class="src-sym">]</span>&lt;=<span class="src-var">$year</span><span class="src-sym">))</span></li>
<li><a name="a1821"></a>        <span class="src-sym">{</span></li>
<li><a name="a1822"></a>            <span class="src-var">$short_mode </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1823"></a>            <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'short_mode'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'short_mode'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1824"></a>            <span class="src-sym">{</span></li>
<li><a name="a1825"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y-n-j&quot;</span><span class="src-sym">)</span>==<span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$year</span>-<span class="src-var">$month</span>-<span class="src-var">$day</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1826"></a>                <span class="src-sym">{</span></li>
<li><a name="a1827"></a>                    <span class="src-var">$rc </span>= <span class="src-id">STR_TODAY</span><span class="src-sym">;</span></li>
<li><a name="a1828"></a>                    <span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1829"></a>                <span class="src-sym">}</span></li>
<li><a name="a1830"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y-n-j&quot;</span><span class="src-sym">, </span><a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'H'</span><span class="src-sym">)</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'i'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'m'</span><span class="src-sym">)</span><span class="src-sym">, </span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'d'</span><span class="src-sym">)</span>+<span class="src-num">1</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)))</span>==<span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$year</span>-<span class="src-var">$month</span>-<span class="src-var">$day</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1831"></a>                <span class="src-sym">{</span></li>
<li><a name="a1832"></a>                    <span class="src-var">$rc </span>= <span class="src-id">STR_TOMORROW</span><span class="src-sym">;</span></li>
<li><a name="a1833"></a>                    <span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1834"></a>                <span class="src-sym">}</span></li>
<li><a name="a1835"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y-n-j&quot;</span><span class="src-sym">, </span><a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'H'</span><span class="src-sym">)</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'i'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'m'</span><span class="src-sym">)</span><span class="src-sym">, </span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'d'</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">,</span><a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">'Y'</span><span class="src-sym">)))</span>==<span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$year</span>-<span class="src-var">$month</span>-<span class="src-var">$day</span></span><span class="src-str">&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1836"></a>                <span class="src-sym">{</span></li>
<li><a name="a1837"></a>                    <span class="src-var">$rc </span>= <span class="src-id">STR_YESTERDAY</span><span class="src-sym">;</span></li>
<li><a name="a1838"></a>                    <span class="src-var">$short_mode</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1839"></a>                <span class="src-sym">}</span></li>
<li><a name="a1840"></a>            <span class="src-sym">}</span></li>
<li><a name="a1841"></a>&nbsp;</li>
<li><a name="a1842"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$short_mode</span>==<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a1843"></a>            <span class="src-sym">{</span></li>
<li><a name="a1844"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'year_format'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1845"></a>                <span class="src-sym">{</span></li>
<li><a name="a1846"></a>                    <span class="src-var">$y_form </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'year_format'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1847"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y_form</span>==<span class="src-str">&quot;short&quot;</span><span class="src-sym">)        </span><span class="src-var">$year </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">,</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">)</span>-<span class="src-num">2</span><span class="src-sym">,</span><span class="src-num">2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1848"></a>                    <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$y_form</span>==<span class="src-str">&quot;void&quot;</span><span class="src-sym">)    </span><span class="src-var">$year </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1849"></a>                <span class="src-sym">}</span></li>
<li><a name="a1850"></a>&nbsp;</li>
<li><a name="a1851"></a>                <span class="src-var">$day   </span>= <a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><span class="src-str">&quot;%02d&quot;</span><span class="src-sym">,</span><span class="src-var">$day</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1852"></a>                <span class="src-var">$month </span>= <a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><span class="src-str">&quot;%02d&quot;</span><span class="src-sym">,</span><span class="src-var">$month</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1853"></a>&nbsp;</li>
<li><a name="a1854"></a>                <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'leading_zeros'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sep_new</span><span class="src-sym">)))</span></li>
<li><a name="a1855"></a>                <span class="src-sym">{</span></li>
<li><a name="a1856"></a>                    <span class="src-var">$l_zeros </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'leading_zeros'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1857"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$l_zeros</span><span class="src-sym">)</span></li>
<li><a name="a1858"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1859"></a>                        <span class="src-var">$day   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$day</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1860"></a>                        <span class="src-var">$month </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$month</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1861"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1862"></a>                <span class="src-sym">}</span></li>
<li><a name="a1863"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$sep_new</span><span class="src-sym">))</span></li>
<li><a name="a1864"></a>                <span class="src-sym">{</span></li>
<li><a name="a1865"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$day</span><span class="src-sym">)</span>&lt;<span class="src-num">2</span><span class="src-sym">)        </span><span class="src-var">$day   </span>.= <span class="src-str">&quot;0&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1866"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$month</span><span class="src-sym">)</span>&lt;<span class="src-num">2</span><span class="src-sym">)    </span><span class="src-var">$month </span>.= <span class="src-str">&quot;0&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1867"></a>                <span class="src-sym">}</span></li>
<li><a name="a1868"></a>&nbsp;</li>
<li><a name="a1869"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$dest_format</span>==<span class="src-str">&quot;long&quot;</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$dest_format</span>==<span class="src-str">&quot;short&quot;</span><span class="src-sym">))</span></li>
<li><a name="a1870"></a>                <span class="src-sym">{</span></li>
<li><a name="a1871"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_package</span><span class="src-sym">)</span></li>
<li><a name="a1872"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1873"></a>                        <span class="src-var">$stamp </span>= <span class="src-key">new </span><span class="src-id">Date</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1874"></a>                        <span class="src-var">$stamp</span><span class="src-sym">-&gt;</span><span class="src-id">setDate</span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$year</span>-<span class="src-var">$month</span>-<span class="src-var">$day</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-id">DATE_FORMAT_ISO</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1875"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1876"></a>&nbsp;</li>
<li><a name="a1877"></a>                    <span class="src-var">$wday </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1878"></a>                    <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'with_weekday'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a1879"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1880"></a>                        <span class="src-var">$with_wday </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'with_weekday'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a1881"></a>&nbsp;</li>
<li><a name="a1882"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_wday</span><span class="src-sym">)</span></li>
<li><a name="a1883"></a>                        <span class="src-sym">{</span></li>
<li><a name="a1884"></a>                            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_package</span><span class="src-sym">)</span></li>
<li><a name="a1885"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1886"></a>                                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$dest_format</span>==<span class="src-str">&quot;long&quot;</span><span class="src-sym">)    </span><span class="src-var">$wday </span>= <span class="src-var">$stamp</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">&quot;%A&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;, &quot;</span><span class="src-sym">;</span></li>
<li><a name="a1887"></a>                                <span class="src-key">else                        </span><span class="src-var">$wday </span>= <span class="src-var">$stamp</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">&quot;%a&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;, &quot;</span><span class="src-sym">;</span></li>
<li><a name="a1888"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1889"></a>                            <span class="src-key">else</span></li>
<li><a name="a1890"></a>                            <span class="src-sym">{</span></li>
<li><a name="a1891"></a>                                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;convDate&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Pear \&quot;Date Package\&quot; required for specificed parameters.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1892"></a>                            <span class="src-sym">}</span></li>
<li><a name="a1893"></a>                        <span class="src-sym">}</span></li>
<li><a name="a1894"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1895"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date_package</span><span class="src-sym">)</span></li>
<li><a name="a1896"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1897"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$dest_format</span>==<span class="src-str">&quot;long&quot;</span><span class="src-sym">)    </span><span class="src-var">$month </span>= <span class="src-var">$stamp</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">&quot;%B&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1898"></a>                        <span class="src-key">else                        </span><span class="src-var">$month </span>= <span class="src-var">$stamp</span><span class="src-sym">-&gt;</span><span class="src-id">format</span><span class="src-sym">(</span><span class="src-str">&quot;%b&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1899"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1900"></a>                    <span class="src-key">else</span></li>
<li><a name="a1901"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1902"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;convDate&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Pear \&quot;Date Package\&quot; required for specificed parameters.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1903"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1904"></a>&nbsp;</li>
<li><a name="a1905"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">m_date</span>==<span class="src-str">&quot;I&quot;</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-var">$wday</span>.<span class="src-var">$month</span>.<span class="src-str">&quot;/&quot;</span>.<span class="src-var">$day</span>.<span class="src-str">&quot;/&quot;</span>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1906"></a>                    <span class="src-key">else                    </span><span class="src-var">$rc </span>= <span class="src-var">$wday</span>.<span class="src-var">$day</span>.<span class="src-str">&quot;. &quot;</span>.<span class="src-var">$month</span>.<span class="src-str">&quot; &quot;</span>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1907"></a>                <span class="src-sym">}</span></li>
<li><a name="a1908"></a>                <span class="src-key">else</span></li>
<li><a name="a1909"></a>                <span class="src-sym">{</span></li>
<li><a name="a1910"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sep_new</span>==<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a><span class="src-sym">)</span></li>
<li><a name="a1911"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1912"></a>                        <span class="src-var">$rc </span>= <span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a>.<span class="src-var">$day</span><span class="src-sym">;</span></li>
<li><a name="a1913"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">))</span></li>
<li><a name="a1914"></a>                            <span class="src-var">$rc </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_i">m_sep_i</a>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1915"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1916"></a>                    <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sep_new</span>==<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a><span class="src-sym">)</span></li>
<li><a name="a1917"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1918"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$year</span><span class="src-sym">))</span></li>
<li><a name="a1919"></a>                            <span class="src-var">$rc </span>.= <span class="src-var">$year</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a><span class="src-sym">;</span></li>
<li><a name="a1920"></a>                        <span class="src-var">$rc </span>.= <span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_s">m_sep_s</a>.<span class="src-var">$day</span><span class="src-sym">;</span></li>
<li><a name="a1921"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1922"></a>                    <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$sep_new</span>==<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a><span class="src-sym">)</span></li>
<li><a name="a1923"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1924"></a>                         <span class="src-var">$rc </span>= <span class="src-var">$day</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a>.<span class="src-var">$month</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$m_sep_l">m_sep_l</a>.<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a1925"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1926"></a>                    <span class="src-key">else</span></li>
<li><a name="a1927"></a>                    <span class="src-sym">{</span></li>
<li><a name="a1928"></a>                         <span class="src-var">$rc </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$year</span>.<span class="src-var">$month</span>.<span class="src-var">$day</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1929"></a>                    <span class="src-sym">}</span></li>
<li><a name="a1930"></a>                <span class="src-sym">}</span></li>
<li><a name="a1931"></a>            <span class="src-sym">} </span><span class="src-comm">// !short mode end</span></li>
<li><a name="a1932"></a>        <span class="src-sym">}</span></li>
<li><a name="a1933"></a>&nbsp;</li>
<li><a name="a1934"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a1935"></a>    <span class="src-sym">}</span></li>
<li><a name="a1936"></a>&nbsp;</li>
<li><a name="a1937"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1938"></a><span class="src-doc">     * Checks whether a file or directory exists (also checks the include_path in php.ini)</span></li>
<li><a name="a1939"></a><span class="src-doc">     *</span></li>
<li><a name="a1940"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$filename </span></li>
<li><a name="a1941"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a1942"></a><span class="src-doc">     */</span></li>
<li><a name="a1943"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span></li>
<li><a name="a1944"></a>    <span class="src-sym">{</span></li>
<li><a name="a1945"></a>        <span class="src-var">$os_type </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodos_type">os_type</a><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1946"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$os_type</span>==<span class="src-str">&quot;w&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1947"></a>        <span class="src-sym">{</span></li>
<li><a name="a1948"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">3</span><span class="src-sym">) </span>== <span class="src-str">&quot;:\\&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1949"></a>                <span class="src-key">return </span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1950"></a>            <span class="src-var">$sep     </span>= <span class="src-str">&quot;;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1951"></a>            <span class="src-var">$sep_dir </span>= <span class="src-str">&quot;\\&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1952"></a>        <span class="src-sym">}</span></li>
<li><a name="a1953"></a>        <span class="src-key">else</span></li>
<li><a name="a1954"></a>        <span class="src-sym">{</span></li>
<li><a name="a1955"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">) </span>== <span class="src-str">&quot;/&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1956"></a>                <span class="src-key">return </span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1957"></a>            <span class="src-var">$sep     </span>= <span class="src-str">&quot;:&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1958"></a>            <span class="src-var">$sep_dir </span>= <span class="src-str">&quot;/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1959"></a>        <span class="src-sym">}</span></li>
<li><a name="a1960"></a>&nbsp;</li>
<li><a name="a1961"></a>        <span class="src-var">$incpath </span>= <a href="http://www.php.net/ini_get">ini_get</a><span class="src-sym">(</span><span class="src-str">&quot;include_path&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a1962"></a>         <span class="src-key">foreach </span><span class="src-sym">(</span><a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-var">$sep</span><span class="src-sym">,</span><span class="src-var">$incpath</span><span class="src-sym">) </span><span class="src-key">as </span><span class="src-var">$path</span><span class="src-sym">)</span></li>
<li><a name="a1963"></a>        <span class="src-sym">{</span></li>
<li><a name="a1964"></a>               <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$path</span>.<span class="src-var">$sep_dir</span>.<span class="src-var">$filename</span><span class="src-sym">))</span></li>
<li><a name="a1965"></a>                <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1966"></a>         <span class="src-sym">}</span></li>
<li><a name="a1967"></a>         <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1968"></a>    <span class="src-sym">}</span></li>
<li><a name="a1969"></a>&nbsp;</li>
<li><a name="a1970"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1971"></a><span class="src-doc">     * validate number (positiv) with wildcards</span></li>
<li><a name="a1972"></a><span class="src-doc">     *</span></li>
<li><a name="a1973"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">        number to validate</span></li>
<li><a name="a1974"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$sep </span><span class="src-doc">       valid seperator {default: &quot;,&quot;}</span></li>
<li><a name="a1975"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a1976"></a><span class="src-doc">     */</span></li>
<li><a name="a1977"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckNumWildcard">checkNumWildcard</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">, </span><span class="src-var">$sep</span>=<span class="src-str">&quot;,&quot;</span><span class="src-sym">)</span></li>
<li><a name="a1978"></a>    <span class="src-sym">{</span></li>
<li><a name="a1979"></a>       <span class="src-var">$needle </span>= <span class="src-str">&quot;/[^0-9\*&quot;</span>.<span class="src-var">$sep</span>.<span class="src-str">&quot;]/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a1980"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">, </span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)))</span></li>
<li><a name="a1981"></a>          <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a1982"></a>       <span class="src-key">else</span></li>
<li><a name="a1983"></a>          <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a1984"></a>    <span class="src-sym">}</span></li>
<li><a name="a1985"></a>&nbsp;</li>
<li><a name="a1986"></a>    <span class="src-doc">/**</span></li>
<li><a name="a1987"></a><span class="src-doc">     * validate phone number</span></li>
<li><a name="a1988"></a><span class="src-doc">     *</span></li>
<li><a name="a1989"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$phone </span><span class="src-doc">   phone number to validate</span></li>
<li><a name="a1990"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span></li>
<li><a name="a1991"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a1992"></a><span class="src-doc">     */</span></li>
<li><a name="a1993"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckPhone">checkPhone</a><span class="src-sym">(</span><span class="src-var">$phone</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a1994"></a>    <span class="src-sym">{</span></li>
<li><a name="a1995"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)    </span><span class="src-var">$needle </span>= <span class="src-str">'/[^\sA-Za-z0-9\(\)\-\+\/]/'</span><span class="src-sym">;</span></li>
<li><a name="a1996"></a>        <span class="src-key">else        </span><span class="src-var">$needle </span>= <span class="src-str">'/[^\s0-9\(\)\-\+\/]/'</span><span class="src-sym">;</span></li>
<li><a name="a1997"></a>&nbsp;</li>
<li><a name="a1998"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$needle</span><span class="src-sym">, </span><span class="src-var">$phone</span><span class="src-sym">))</span></li>
<li><a name="a1999"></a>            <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2000"></a>        <span class="src-key">else</span></li>
<li><a name="a2001"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2002"></a>    <span class="src-sym">}</span></li>
<li><a name="a2003"></a>&nbsp;</li>
<li><a name="a2004"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2005"></a><span class="src-doc">     * validate post zip code</span></li>
<li><a name="a2006"></a><span class="src-doc">     *</span></li>
<li><a name="a2007"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$zip </span><span class="src-doc">   zip to validate</span></li>
<li><a name="a2008"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2009"></a><span class="src-doc">     */</span></li>
<li><a name="a2010"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckZip">checkZip</a><span class="src-sym">(</span><span class="src-var">$zip</span><span class="src-sym">)</span></li>
<li><a name="a2011"></a>    <span class="src-sym">{</span></li>
<li><a name="a2012"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^\s\w\-]/'</span><span class="src-sym">, </span><span class="src-var">$zip</span><span class="src-sym">))</span></li>
<li><a name="a2013"></a>            <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2014"></a>        <span class="src-key">else</span></li>
<li><a name="a2015"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2016"></a>    <span class="src-sym">}</span></li>
<li><a name="a2017"></a>&nbsp;</li>
<li><a name="a2018"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2019"></a><span class="src-doc">     * validate German Bankleitzahl</span></li>
<li><a name="a2020"></a><span class="src-doc">     * ( allowed seperators: &quot;-&quot;, &quot;.&quot; or &quot; &quot;)</span></li>
<li><a name="a2021"></a><span class="src-doc">     *</span></li>
<li><a name="a2022"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$bank_id </span><span class="src-doc">   bank id (German BLZ) to validate</span></li>
<li><a name="a2023"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2024"></a><span class="src-doc">     */</span></li>
<li><a name="a2025"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckBankId">checkBankId</a><span class="src-sym">(</span><span class="src-var">$bank_id</span><span class="src-sym">)</span></li>
<li><a name="a2026"></a>    <span class="src-sym">{</span></li>
<li><a name="a2027"></a>        <span class="src-var">$bank_id </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$bank_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2028"></a>        <span class="src-var">$bank_id </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;.&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$bank_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2029"></a>        <span class="src-var">$bank_id </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$bank_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2030"></a>&nbsp;</li>
<li><a name="a2031"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$bank_id</span><span class="src-sym">)</span>==<span class="src-num">8</span><span class="src-sym">)    </span><span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2032"></a>        <span class="src-key">else                        </span><span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2033"></a>    <span class="src-sym">}</span></li>
<li><a name="a2034"></a>&nbsp;</li>
<li><a name="a2035"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2036"></a><span class="src-doc">     * Check birthday</span></li>
<li><a name="a2037"></a><span class="src-doc">     *</span></li>
<li><a name="a2038"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">date </span><span class="src-doc">   </span><span class="src-doc-var">$birthday </span></li>
<li><a name="a2039"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$date_format </span></li>
<li><a name="a2040"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2041"></a><span class="src-doc">     */</span></li>
<li><a name="a2042"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckBirthday">checkBirthday</a><span class="src-sym">(</span><span class="src-var">$birthday</span><span class="src-sym">, </span><span class="src-var">$date_format</span>=<span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span></li>
<li><a name="a2043"></a>    <span class="src-sym">{</span></li>
<li><a name="a2044"></a>        <span class="src-var">$tmp_birthday    </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$birthday</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-str">'S'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2045"></a>        <span class="src-var">$tmp_b            </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$tmp_birthday</span><span class="src-sym">, </span><span class="src-str">&quot;S&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;C&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2046"></a>        <span class="src-var">$tmp_now        </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Ymd&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2047"></a>&nbsp;</li>
<li><a name="a2048"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$tmp_birthday</span><span class="src-sym">)            </span><span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2049"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$tmp_b</span>&gt;<span class="src-var">$tmp_now</span><span class="src-sym">)    </span><span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2050"></a>&nbsp;</li>
<li><a name="a2051"></a>        <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2052"></a>    <span class="src-sym">}</span></li>
<li><a name="a2053"></a>&nbsp;</li>
<li><a name="a2054"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2055"></a><span class="src-doc">     * validate email address format</span></li>
<li><a name="a2056"></a><span class="src-doc">     *</span></li>
<li><a name="a2057"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$email </span><span class="src-doc">       email address</span></li>
<li><a name="a2058"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_dns </span><span class="src-doc">   true for dns check {default: false}</span></li>
<li><a name="a2059"></a><span class="src-doc">     *                                 (only works on non-windows platforms)</span></li>
<li><a name="a2060"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2061"></a><span class="src-doc">     */</span></li>
<li><a name="a2062"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckEmail">checkEmail</a><span class="src-sym">(</span><span class="src-var">$email</span><span class="src-sym">, </span><span class="src-var">$with_dns</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2063"></a>    <span class="src-sym">{</span></li>
<li><a name="a2064"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2065"></a>&nbsp;</li>
<li><a name="a2066"></a>        <span class="src-var">$known_doms  </span>= <span class="src-str">&quot;ad|ae|aero|af|ag|ai|al|am|an|ao|aq|ar|arpa|as|at|au|aw|az|ba&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2067"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|bb|bd|be|bf|bg|bh|bi|biz|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2068"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|com|coop|cr|cs|cu|cv|cx|cy&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2069"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|eh|er|es|et|eu|fi|fj|fk|fm&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2070"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|fo|fr|ga|gb|gd|ge|gf|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gu|gw&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2071"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|gy|hk|hm|hn|hr|ht|hu|id|ie|il|in|info|int|io|iq|ir|is|it|jm&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2072"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|jo|jobs|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2073"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|lt|lu|lv|ly|ma|mc|md|mg|mh|mil|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2074"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|mu|museum|mv|mw|mx|my|mz|na|name|nc|ne|net|nf|ng|ni|nl|no|np&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2075"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|nr|nt|nu|nz|om|org|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|pro|ps|pt|pw&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2076"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|py|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2077"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|sr|st|su|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|travel|tt|tv&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2078"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2079"></a>        <span class="src-var">$known_doms </span>.= <span class="src-str">&quot;|yu|za|zm|zw&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2080"></a>&nbsp;</li>
<li><a name="a2081"></a>        <span class="src-var">$email </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$email</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2082"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/^<span class="src-sym">[</span>-<span class="src-id">_</span>.<span class="src-sym">[</span>:<span class="src-id">alnum</span>:<span class="src-sym">]]</span>+@(((<span class="src-sym">[[</span>:<span class="src-id">alnum</span>:<span class="src-sym">]]</span>|<span class="src-sym">[[</span>:<span class="src-id">alnum</span>:<span class="src-sym">]]</span><span class="src-sym">[[</span>:<span class="src-id">alnum</span>:<span class="src-sym">]</span>-<span class="src-sym">]</span>*<span class="src-sym">[[</span>:<span class="src-id">alnum</span>:<span class="src-sym">]]</span>)\.)+(<span class="src-var">$known_doms</span>)$|((<span class="src-sym">[</span>0-9<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>?|<span class="src-sym">[</span>0-1<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>|<span class="src-sym">[</span>2<span class="src-sym">]</span><span class="src-sym">[</span>0-4<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>|<span class="src-sym">[</span>2<span class="src-sym">]</span><span class="src-sym">[</span>5<span class="src-sym">]</span><span class="src-sym">[</span>0-5<span class="src-sym">]</span>)\.)<span class="src-sym">{</span>3<span class="src-sym">}</span>(<span class="src-sym">[</span>0-9<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>?|<span class="src-sym">[</span>0-1<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>|<span class="src-sym">[</span>2<span class="src-sym">]</span><span class="src-sym">[</span>0-4<span class="src-sym">]</span><span class="src-sym">[</span>0-9<span class="src-sym">]</span>|<span class="src-sym">[</span>2<span class="src-sym">]</span><span class="src-sym">[</span>5<span class="src-sym">]</span><span class="src-sym">[</span>0-5<span class="src-sym">]</span>))$/<span class="src-id">i</span></span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-var">$email</span><span class="src-sym">))</span></li>
<li><a name="a2083"></a>        <span class="src-sym">{</span></li>
<li><a name="a2084"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_dns</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodos_type">os_type</a><span class="src-sym">(</span><span class="src-id">true</span><span class="src-sym">)</span>!=<span class="src-str">&quot;w&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2085"></a>            <span class="src-sym">{</span></li>
<li><a name="a2086"></a>                <span class="src-var">$host </span>= <a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-str">'@'</span><span class="src-sym">, </span><span class="src-var">$email</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2087"></a>                <span class="src-comm">// Check for MX record</span></li>
<li><a name="a2088"></a>                <span class="src-key">if</span><span class="src-sym">( </span><a href="http://www.php.net/checkdnsrr">checkdnsrr</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">'MX'</span><span class="src-sym">) )    </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2089"></a>                <span class="src-comm">// Check for A record</span></li>
<li><a name="a2090"></a>                <span class="src-key">if</span><span class="src-sym">( </span><a href="http://www.php.net/checkdnsrr">checkdnsrr</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">'A'</span><span class="src-sym">) )     </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2091"></a>                <span class="src-comm">// Check for CNAME record</span></li>
<li><a name="a2092"></a>                <span class="src-key">if</span><span class="src-sym">( </span><a href="http://www.php.net/checkdnsrr">checkdnsrr</a><span class="src-sym">(</span><span class="src-var">$host</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">'CNAME'</span><span class="src-sym">) ) </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2093"></a>             <span class="src-sym">}</span></li>
<li><a name="a2094"></a>             <span class="src-key">else</span></li>
<li><a name="a2095"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2096"></a>        <span class="src-sym">}</span></li>
<li><a name="a2097"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2098"></a>    <span class="src-sym">}</span></li>
<li><a name="a2099"></a>&nbsp;</li>
<li><a name="a2100"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2101"></a><span class="src-doc">     * validate domain name</span></li>
<li><a name="a2102"></a><span class="src-doc">     *</span></li>
<li><a name="a2103"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$domain </span><span class="src-doc">   domain name</span></li>
<li><a name="a2104"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$tld </span><span class="src-doc">   top level domain</span></li>
<li><a name="a2105"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2106"></a><span class="src-doc">     */</span></li>
<li><a name="a2107"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckDomainName">checkDomainName</a><span class="src-sym">(</span><span class="src-var">$domain</span><span class="src-sym">, </span><span class="src-var">$tld</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a2108"></a>    <span class="src-sym">{</span></li>
<li><a name="a2109"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2110"></a>&nbsp;</li>
<li><a name="a2111"></a>        <span class="src-var">$len </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$domain</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2112"></a>        <span class="src-var">$dot_count </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$domain</span><span class="src-sym">, </span><span class="src-str">&quot;.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2113"></a>&nbsp;</li>
<li><a name="a2114"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$dot_count</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp;</li>
<li><a name="a2115"></a>            <span class="src-sym">(</span><span class="src-var">$len</span>&gt;<span class="src-num">1</span><span class="src-sym">) </span>&amp;&amp;</li>
<li><a name="a2116"></a>            <span class="src-sym">(</span><span class="src-var">$len</span>&lt;=<span class="src-sym">(</span><span class="src-num">63</span>*<span class="src-var">$dot_count</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2117"></a>            <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^a-z0-9\._\-]/i'</span><span class="src-sym">, </span><span class="src-var">$domain</span><span class="src-sym">)))</span></li>
<li><a name="a2118"></a>        <span class="src-sym">{</span></li>
<li><a name="a2119"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$tld</span><span class="src-sym">))</span></li>
<li><a name="a2120"></a>            <span class="src-sym">{</span></li>
<li><a name="a2121"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$domain</span><span class="src-sym">, </span><span class="src-sym">(</span><span class="src-var">$len </span>- <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$tld</span><span class="src-sym">) </span>- <span class="src-num">1</span><span class="src-sym">)</span>==<span class="src-var">$tld</span><span class="src-sym">))</span></li>
<li><a name="a2122"></a>                    <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2123"></a>            <span class="src-sym">}</span></li>
<li><a name="a2124"></a>            <span class="src-key">else</span></li>
<li><a name="a2125"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2126"></a>        <span class="src-sym">}</span></li>
<li><a name="a2127"></a>&nbsp;</li>
<li><a name="a2128"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2129"></a>    <span class="src-sym">}</span></li>
<li><a name="a2130"></a>&nbsp;</li>
<li><a name="a2131"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2132"></a><span class="src-doc">     * validate IP address</span></li>
<li><a name="a2133"></a><span class="src-doc">     *</span></li>
<li><a name="a2134"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$addr </span><span class="src-doc">   IP address to validate</span></li>
<li><a name="a2135"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">               true if valid</span></li>
<li><a name="a2136"></a><span class="src-doc">     */</span></li>
<li><a name="a2137"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckIP">checkIP</a><span class="src-sym">(</span><span class="src-var">$addr</span><span class="src-sym">)</span></li>
<li><a name="a2138"></a>    <span class="src-sym">{</span></li>
<li><a name="a2139"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2140"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$addr</span><span class="src-sym">)</span>&lt;<span class="src-num">16</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^0-9\.]/'</span><span class="src-sym">, </span><span class="src-var">$addr</span><span class="src-sym">)))</span></li>
<li><a name="a2141"></a>        <span class="src-sym">{</span></li>
<li><a name="a2142"></a>            <span class="src-var">$ip </span>= <a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-str">&quot;.&quot;</span><span class="src-sym">, </span><span class="src-var">$addr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2143"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$ip</span><span class="src-sym">)</span>==<span class="src-num">4</span><span class="src-sym">)</span></li>
<li><a name="a2144"></a>            <span class="src-sym">{</span></li>
<li><a name="a2145"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2146"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;<span class="src-num">4</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a2147"></a>                <span class="src-sym">{</span></li>
<li><a name="a2148"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$ip</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)</span>==<span class="src-num">0</span><span class="src-sym">) </span>||</li>
<li><a name="a2149"></a>                            <span class="src-sym">(</span><span class="src-var">$ip</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span>&lt;<span class="src-num">0</span><span class="src-sym">)      </span>||</li>
<li><a name="a2150"></a>                            <span class="src-sym">(</span><span class="src-var">$ip</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span>&gt;<span class="src-num">255</span><span class="src-sym">))</span></li>
<li><a name="a2151"></a>                    <span class="src-sym">{</span></li>
<li><a name="a2152"></a>                        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2153"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2154"></a>                    <span class="src-sym">}</span></li>
<li><a name="a2155"></a>                <span class="src-sym">}</span></li>
<li><a name="a2156"></a>            <span class="src-sym">}</span></li>
<li><a name="a2157"></a>        <span class="src-sym">}</span></li>
<li><a name="a2158"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2159"></a>    <span class="src-sym">}</span></li>
<li><a name="a2160"></a>&nbsp;</li>
<li><a name="a2161"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2162"></a><span class="src-doc">     * validate MAC address</span></li>
<li><a name="a2163"></a><span class="src-doc">     *</span></li>
<li><a name="a2164"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$addr </span><span class="src-doc">   MAC address to validate</span></li>
<li><a name="a2165"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2166"></a><span class="src-doc">     */</span></li>
<li><a name="a2167"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckMAC">checkMAC</a><span class="src-sym">(</span><span class="src-var">$addr</span><span class="src-sym">)</span></li>
<li><a name="a2168"></a>    <span class="src-sym">{</span></li>
<li><a name="a2169"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2170"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$addr</span><span class="src-sym">)</span>==<span class="src-num">17</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^A-Fa-f0-9\:]/'</span><span class="src-sym">,</span><span class="src-var">$addr</span><span class="src-sym">)))</span></li>
<li><a name="a2171"></a>        <span class="src-sym">{</span></li>
<li><a name="a2172"></a>            <span class="src-var">$mac </span>= <a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-str">&quot;:&quot;</span><span class="src-sym">, </span><span class="src-var">$addr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2173"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$mac</span><span class="src-sym">)</span>==<span class="src-num">6</span><span class="src-sym">)</span></li>
<li><a name="a2174"></a>            <span class="src-sym">{</span></li>
<li><a name="a2175"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2176"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;=<span class="src-num">5</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a2177"></a>                <span class="src-sym">{</span></li>
<li><a name="a2178"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$mac</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)</span>!=<span class="src-num">2</span><span class="src-sym">)        </span>||</li>
<li><a name="a2179"></a>                            <span class="src-sym">(</span><a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$mac</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">)</span>&lt;<span class="src-num">0</span><span class="src-sym">)    </span>||</li>
<li><a name="a2180"></a>                            <span class="src-sym">(</span><a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$mac</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span>&gt;<span class="src-num">255</span><span class="src-sym">)))</span></li>
<li><a name="a2181"></a>                    <span class="src-sym">{</span></li>
<li><a name="a2182"></a>                        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2183"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2184"></a>                    <span class="src-sym">}</span></li>
<li><a name="a2185"></a>                <span class="src-sym">}</span></li>
<li><a name="a2186"></a>            <span class="src-sym">}</span></li>
<li><a name="a2187"></a>        <span class="src-sym">}</span></li>
<li><a name="a2188"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2189"></a>    <span class="src-sym">}</span></li>
<li><a name="a2190"></a>&nbsp;</li>
<li><a name="a2191"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2192"></a><span class="src-doc">     * check if a string has HTML tags</span></li>
<li><a name="a2193"></a><span class="src-doc">     *</span></li>
<li><a name="a2194"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   string to validate</span></li>
<li><a name="a2195"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">            true if string has html tags</span></li>
<li><a name="a2196"></a><span class="src-doc">     */</span></li>
<li><a name="a2197"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckHtmlTag">checkHtmlTag</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span></li>
<li><a name="a2198"></a>    <span class="src-sym">{</span></li>
<li><a name="a2199"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[&lt;]/'</span><span class="src-sym">,</span><a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)))</span></li>
<li><a name="a2200"></a>            <span class="src-key">return </span><span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2201"></a>        <span class="src-key">else</span></li>
<li><a name="a2202"></a>            <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2203"></a>    <span class="src-sym">}</span></li>
<li><a name="a2204"></a>&nbsp;</li>
<li><a name="a2205"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2206"></a><span class="src-doc">     * check if string is a valid color value for HTML and CSS</span></li>
<li><a name="a2207"></a><span class="src-doc">     *</span></li>
<li><a name="a2208"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   string to validate</span></li>
<li><a name="a2209"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2210"></a><span class="src-doc">     */</span></li>
<li><a name="a2211"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckColor">checkColor</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span></li>
<li><a name="a2212"></a>    <span class="src-sym">{</span></li>
<li><a name="a2213"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2214"></a>&nbsp;</li>
<li><a name="a2215"></a>        <span class="src-var">$colors </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">&quot;aqua&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;black&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;blue&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;fuchsia&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;gray&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;green&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;lime&quot;</span><span class="src-sym">,</span></li>
<li><a name="a2216"></a>                    <span class="src-str">&quot;maroon&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;navy&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;olive&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;purple&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;red&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;silver&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;teal&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;white&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;yellow&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2217"></a>&nbsp;</li>
<li><a name="a2218"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/in_array">in_array</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-var">$colors</span><span class="src-sym">))</span></li>
<li><a name="a2219"></a>            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2220"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">)</span>==<span class="src-str">&quot;#&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span>&lt;<span class="src-num">8</span><span class="src-sym">))</span></li>
<li><a name="a2221"></a>        <span class="src-sym">{</span></li>
<li><a name="a2222"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^A-Fa-f0-9]/'</span><span class="src-sym">,</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">)))</span></li>
<li><a name="a2223"></a>                <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2224"></a>        <span class="src-sym">}</span></li>
<li><a name="a2225"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2226"></a>    <span class="src-sym">}</span></li>
<li><a name="a2227"></a>&nbsp;</li>
<li><a name="a2228"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2229"></a><span class="src-doc">     * is string a valid number?</span></li>
<li><a name="a2230"></a><span class="src-doc">     *</span></li>
<li><a name="a2231"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$number </span><span class="src-doc">       number to validate</span></li>
<li><a name="a2232"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$sep </span><span class="src-doc">       valid seperator {default: &quot;.&quot;}</span></li>
<li><a name="a2233"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">       if true, with negative numbers {default: true}</span></li>
<li><a name="a2234"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_null </span><span class="src-doc">   if true, number &quot;0&quot; is valid {default: true}</span></li>
<li><a name="a2235"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2236"></a><span class="src-doc">     */</span></li>
<li><a name="a2237"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">, </span><span class="src-var">$sep</span>=<span class="src-str">&quot;.&quot;</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$with_null</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a2238"></a>    <span class="src-sym">{</span></li>
<li><a name="a2239"></a>       <span class="src-var">$rc  </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2240"></a>       <span class="src-var">$num </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2241"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$sep</span><span class="src-sym">))</span></li>
<li><a name="a2242"></a>       <span class="src-sym">{</span></li>
<li><a name="a2243"></a>          <span class="src-var">$num_sep </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$num</span><span class="src-sym">, </span><span class="src-var">$sep</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2244"></a>          <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$num_sep </span>&lt; <span class="src-num">2</span><span class="src-sym">)</span></li>
<li><a name="a2245"></a>          <span class="src-sym">{</span></li>
<li><a name="a2246"></a>             <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2247"></a>                <span class="src-var">$simple </span>= <span class="src-str">&quot;</span><span class="src-str">/<span class="src-sym">[</span>^0-9\-\\<span class="src-var">$sep</span><span class="src-sym">]</span>/</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2248"></a>             <span class="src-key">else</span></li>
<li><a name="a2249"></a>                <span class="src-var">$simple </span>= <span class="src-str">&quot;</span><span class="src-str">/<span class="src-sym">[</span>^0-9\\<span class="src-var">$sep</span><span class="src-sym">]</span>/</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2250"></a>             <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$simple</span><span class="src-sym">, </span><span class="src-var">$num</span><span class="src-sym">))</span></li>
<li><a name="a2251"></a>             <span class="src-sym">{</span></li>
<li><a name="a2252"></a>                <span class="src-var">$pos </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$num</span><span class="src-sym">, </span><span class="src-str">'-'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2253"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pos</span>===<span class="src-id">false</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2254"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$pos</span>==<span class="src-num">0</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2255"></a>             <span class="src-sym">}</span></li>
<li><a name="a2256"></a>          <span class="src-sym">}</span></li>
<li><a name="a2257"></a>          <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^0-9\-]/'</span><span class="src-sym">,</span><span class="src-var">$num</span><span class="src-sym">))) </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2258"></a>          <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^0-9]/'</span><span class="src-sym">,</span><span class="src-var">$num</span><span class="src-sym">)) </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2259"></a>       <span class="src-sym">}</span></li>
<li><a name="a2260"></a>       <span class="src-key">else </span><span class="src-comm">// only integer</span></li>
<li><a name="a2261"></a>       <span class="src-sym">{</span></li>
<li><a name="a2262"></a>          <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^0-9\-]/'</span><span class="src-sym">,</span><span class="src-var">$num</span><span class="src-sym">))) </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2263"></a>          <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^0-9]/'</span><span class="src-sym">,</span><span class="src-var">$num</span><span class="src-sym">)) </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2264"></a>       <span class="src-sym">}</span></li>
<li><a name="a2265"></a>&nbsp;</li>
<li><a name="a2266"></a>       <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$with_null</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$num</span>==<span class="src-str">&quot;0&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2267"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2268"></a>&nbsp;</li>
<li><a name="a2269"></a>       <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2270"></a>    <span class="src-sym">}</span></li>
<li><a name="a2271"></a>&nbsp;</li>
<li><a name="a2272"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2273"></a><span class="src-doc">     * validate user name</span></li>
<li><a name="a2274"></a><span class="src-doc">     * (only alpha-numeric, '_' and '-' (but not as first sign,</span></li>
<li><a name="a2275"></a><span class="src-doc">     * because some systems has problems with this) are allowed)</span></li>
<li><a name="a2276"></a><span class="src-doc">     *</span></li>
<li><a name="a2277"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$user_name </span><span class="src-doc">           user to validate</span></li>
<li><a name="a2278"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$min_length </span><span class="src-doc">           minimal length of username {default: 3}</span></li>
<li><a name="a2279"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$allow_upper_case </span><span class="src-doc">   true    : case insensitive    {default: true}</span></li>
<li><a name="a2280"></a><span class="src-doc">     *                                         false    : upper letters are not allowed</span></li>
<li><a name="a2281"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2282"></a><span class="src-doc">     */</span></li>
<li><a name="a2283"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckUserName">checkUserName</a><span class="src-sym">(</span><span class="src-var">$user_name</span><span class="src-sym">, </span><span class="src-var">$min_length</span>=<span class="src-num">3</span><span class="src-sym">, </span><span class="src-var">$allow_upper_case</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a2284"></a>    <span class="src-sym">{</span></li>
<li><a name="a2285"></a>        <span class="src-var">$rc        </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2286"></a>        <span class="src-var">$str    </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$user_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2287"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">) </span>&gt;= <span class="src-var">$min_length</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span>!=<span class="src-str">'-'</span><span class="src-sym">))</span></li>
<li><a name="a2288"></a>        <span class="src-sym">{</span></li>
<li><a name="a2289"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$allow_upper_case</span><span class="src-sym">)    </span><span class="src-var">$val</span>=<span class="src-str">'/[^a-z0-9\_\-]/'</span><span class="src-sym">;</span></li>
<li><a name="a2290"></a>            <span class="src-key">else                    </span><span class="src-var">$val</span>=<span class="src-str">'/[^A-Za-z0-9\_\-]/'</span><span class="src-sym">;</span></li>
<li><a name="a2291"></a>&nbsp;</li>
<li><a name="a2292"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$val</span><span class="src-sym">, </span><span class="src-var">$str</span><span class="src-sym">))    </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2293"></a>        <span class="src-sym">}</span></li>
<li><a name="a2294"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2295"></a>    <span class="src-sym">}</span></li>
<li><a name="a2296"></a>&nbsp;</li>
<li><a name="a2297"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2298"></a><span class="src-doc">     * checks version of php and if pear is installed</span></li>
<li><a name="a2299"></a><span class="src-doc">     *</span></li>
<li><a name="a2300"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$min_ver </span><span class="src-doc">   oldest php version, which is allowed</span></li>
<li><a name="a2301"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_pear </span><span class="src-doc">   true: if pear must installed {default: false}</span></li>
<li><a name="a2302"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">       true: die with message {default: false}</span></li>
<li><a name="a2303"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2304"></a><span class="src-doc">     */</span></li>
<li><a name="a2305"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheck_php_version">check_php_version</a><span class="src-sym">(</span><span class="src-var">$min_ver</span><span class="src-sym">, </span><span class="src-var">$with_pear</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2306"></a>    <span class="src-sym">{</span></li>
<li><a name="a2307"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2308"></a>&nbsp;</li>
<li><a name="a2309"></a>        <span class="src-var">$pear_installed </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2310"></a>        <span class="src-var">$curr_php </span>= <a href="http://www.php.net/phpversion">phpversion</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2311"></a>        <span class="src-var">$c_p1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$curr_php</span><span class="src-sym">,</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2312"></a>        <span class="src-var">$c_p2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2313"></a>        <span class="src-var">$c_p3 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2314"></a>&nbsp;</li>
<li><a name="a2315"></a>        <span class="src-var">$m_p1 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$min_ver</span><span class="src-sym">,</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2316"></a>        <span class="src-var">$m_p2 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2317"></a>        <span class="src-var">$m_p3 </span>= <a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">'.'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2318"></a>&nbsp;</li>
<li><a name="a2319"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c_p1 </span>&gt; <span class="src-var">$m_p1</span><span class="src-sym">) </span><span class="src-var">$rc</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2320"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c_p1</span>==<span class="src-var">$m_p1</span><span class="src-sym">)</span></li>
<li><a name="a2321"></a>        <span class="src-sym">{</span></li>
<li><a name="a2322"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c_p2 </span>&gt; <span class="src-var">$m_p2</span><span class="src-sym">) </span><span class="src-var">$rc</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2323"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c_p2</span>==<span class="src-var">$m_p2</span><span class="src-sym">)</span></li>
<li><a name="a2324"></a>            <span class="src-sym">{</span></li>
<li><a name="a2325"></a>                <span class="src-comm">// if c_p3 is no number (because it is a dev version, take 0)</span></li>
<li><a name="a2326"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/cphplib.html#methodcphplib">cphplib</a><span class="src-sym">::</span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$c_p3</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2327"></a>                    <span class="src-var">$c_p3</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2328"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c_p3 </span>&gt;= <span class="src-var">$m_p3</span><span class="src-sym">) </span><span class="src-var">$rc</span>=<span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2329"></a>            <span class="src-sym">}</span></li>
<li><a name="a2330"></a>        <span class="src-sym">}</span></li>
<li><a name="a2331"></a>&nbsp;</li>
<li><a name="a2332"></a>        <span class="src-comm">// pear only works with php &gt;= 4</span></li>
<li><a name="a2333"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_pear</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$c_p1</span>&gt;=<span class="src-num">4</span><span class="src-sym">))</span></li>
<li><a name="a2334"></a>        <span class="src-sym">{</span></li>
<li><a name="a2335"></a>            <span class="src-sym">@ </span><span class="src-inc">include_once</span><span class="src-sym">(</span><span class="src-str">&quot;PEAR.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2336"></a>            <span class="src-var">$pear_installed </span>= <a href="http://www.php.net/class_exists">class_exists</a><span class="src-sym">(</span><span class="src-str">&quot;PEAR&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2337"></a>        <span class="src-sym">}</span></li>
<li><a name="a2338"></a>&nbsp;</li>
<li><a name="a2339"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2340"></a>        <span class="src-sym">{</span></li>
<li><a name="a2341"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$rc</span><span class="src-sym">)</span></li>
<li><a name="a2342"></a>            <span class="src-sym">{</span></li>
<li><a name="a2343"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;check_php_version&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">version</span> &gt;= <span class="src-var">$min_ver</span> <span class="src-id">required</span> (<span class="src-id">installed</span> <span class="src-id">php</span> <span class="src-id">version</span> <span class="src-id">is</span> <span class="src-var">$curr_php</span>).</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2344"></a>            <span class="src-sym">}</span></li>
<li><a name="a2345"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_pear</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$pear_installed</span><span class="src-sym">))</span></li>
<li><a name="a2346"></a>            <span class="src-sym">{</span></li>
<li><a name="a2347"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;check_php_version&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;</span><span class="src-str"><span class="src-id">php</span> <span class="src-id">pear</span> <span class="src-id">is</span> <span class="src-id">missing</span> (<span class="src-id">installed</span> <span class="src-id">php</span> <span class="src-id">version</span> <span class="src-id">is</span> <span class="src-var">$curr_php</span>).</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2348"></a>            <span class="src-sym">}</span></li>
<li><a name="a2349"></a>        <span class="src-sym">}</span></li>
<li><a name="a2350"></a>        <span class="src-key">else</span></li>
<li><a name="a2351"></a>        <span class="src-sym">{</span></li>
<li><a name="a2352"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_pear</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$pear_installed</span><span class="src-sym">))</span></li>
<li><a name="a2353"></a>                <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2354"></a>        <span class="src-sym">}</span></li>
<li><a name="a2355"></a>&nbsp;</li>
<li><a name="a2356"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2357"></a>    <span class="src-sym">}</span></li>
<li><a name="a2358"></a>&nbsp;</li>
<li><a name="a2359"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2360"></a><span class="src-doc">     * validate password format</span></li>
<li><a name="a2361"></a><span class="src-doc">     *</span></li>
<li><a name="a2362"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">       </span><span class="src-doc-var">$password </span><span class="src-doc">       password string</span></li>
<li><a name="a2363"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">           </span><span class="src-doc-var">$min_length </span><span class="src-doc">       minimal length of password {default: 5}</span></li>
<li><a name="a2364"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">           </span><span class="src-doc-var">$strength </span><span class="src-doc">       0: no special rules    {default}</span></li>
<li><a name="a2365"></a><span class="src-doc">     *                                         1: at least one number and one char</span></li>
<li><a name="a2366"></a><span class="src-doc">     *                                         2: same as 1 and at least one lowercase and and uppercase letter</span></li>
<li><a name="a2367"></a><span class="src-doc">     *                                         3: same as 2 and at least one special character</span></li>
<li><a name="a2368"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">                       true for qualified password</span></li>
<li><a name="a2369"></a><span class="src-doc">     */</span></li>
<li><a name="a2370"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckPassword">checkPassword</a><span class="src-sym">(</span><span class="src-var">$password</span><span class="src-sym">, </span><span class="src-var">$min_length</span>=<span class="src-num">5</span><span class="src-sym">, </span><span class="src-var">$strength</span>=<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a2371"></a>    <span class="src-sym">{</span></li>
<li><a name="a2372"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2373"></a>        <span class="src-var">$password </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$password</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2374"></a>&nbsp;</li>
<li><a name="a2375"></a>        <span class="src-var">$special    </span>= <span class="src-str">&quot;\.\,;\:\!\@\#\%\&amp;\*\-\_\=\(\)\+&lt;&gt;\$&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2376"></a>        <span class="src-var">$allowed    </span>= <span class="src-str">&quot;/[^[:alnum:]&quot;</span>.<span class="src-var">$special</span>.<span class="src-str">&quot;]/i&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2377"></a>&nbsp;</li>
<li><a name="a2378"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$password</span><span class="src-sym">) </span>&gt;= <span class="src-var">$min_length</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$allowed</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)))</span></li>
<li><a name="a2379"></a>        <span class="src-sym">{</span></li>
<li><a name="a2380"></a>            <span class="src-key">switch</span><span class="src-sym">(</span><span class="src-var">$strength</span><span class="src-sym">)</span></li>
<li><a name="a2381"></a>            <span class="src-sym">{</span></li>
<li><a name="a2382"></a>                <span class="src-key">case </span><span class="src-num">1</span>:        <span class="src-comm">// at least one number and one char</span></li>
<li><a name="a2383"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[A-Za-z]/i'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2384"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[0-9]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)))</span></li>
<li><a name="a2385"></a>                       <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2386"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2387"></a>                <span class="src-key">case </span><span class="src-num">2</span>:        <span class="src-comm">// same as 1 and at least one lowercase and and uppercase letter</span></li>
<li><a name="a2388"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[A-Z]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2389"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[a-z]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2390"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[0-9]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)))</span></li>
<li><a name="a2391"></a>                       <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2392"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2393"></a>                <span class="src-key">case </span><span class="src-num">3</span>:        <span class="src-comm">// same as 2 and at least one special character</span></li>
<li><a name="a2394"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[A-Z]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2395"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[a-z]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2396"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[0-9]/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)) </span>&amp;&amp;</li>
<li><a name="a2397"></a>                        <span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/['</span>.<span class="src-var">$special</span>.<span class="src-str">']/'</span><span class="src-sym">, </span><span class="src-var">$password</span><span class="src-sym">)))</span></li>
<li><a name="a2398"></a>                       <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2399"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2400"></a>                <span class="src-key">default</span>:    <span class="src-comm">// no special rules</span></li>
<li><a name="a2401"></a>                    <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2402"></a>            <span class="src-sym">}</span></li>
<li><a name="a2403"></a>        <span class="src-sym">}</span></li>
<li><a name="a2404"></a>&nbsp;</li>
<li><a name="a2405"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2406"></a>    <span class="src-sym">}</span></li>
<li><a name="a2407"></a>&nbsp;</li>
<li><a name="a2408"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2409"></a><span class="src-doc">     * validate string with letters only</span></li>
<li><a name="a2410"></a><span class="src-doc">     *</span></li>
<li><a name="a2411"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   tring to validate</span></li>
<li><a name="a2412"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   true for German Umlaute include {default: false}</span></li>
<li><a name="a2413"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a2414"></a><span class="src-doc">     */</span></li>
<li><a name="a2415"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckString">checkString</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2416"></a>    <span class="src-sym">{</span></li>
<li><a name="a2417"></a>       <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a2418"></a>       <span class="src-var">$str </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2419"></a>       <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a2420"></a>       <span class="src-sym">{</span></li>
<li><a name="a2421"></a>          <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^A-Za-z]/'</span><span class="src-sym">,</span><span class="src-var">$str</span><span class="src-sym">))</span></li>
<li><a name="a2422"></a>             <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2423"></a>       <span class="src-sym">}</span></li>
<li><a name="a2424"></a>       <span class="src-key">else</span></li>
<li><a name="a2425"></a>       <span class="src-sym">{</span></li>
<li><a name="a2426"></a>          <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/[^A-Za-z]/'</span><span class="src-sym">,</span><span class="src-var">$str</span><span class="src-sym">))</span></li>
<li><a name="a2427"></a>             <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a2428"></a>       <span class="src-sym">}</span></li>
<li><a name="a2429"></a>       <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2430"></a>    <span class="src-sym">}</span></li>
<li><a name="a2431"></a>&nbsp;</li>
<li><a name="a2432"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2433"></a><span class="src-doc">     * convert German Umlaute to HTML and vice versa</span></li>
<li><a name="a2434"></a><span class="src-doc">     *</span></li>
<li><a name="a2435"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   string to convert</span></li>
<li><a name="a2436"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   true:    convert to HTML</span></li>
<li><a name="a2437"></a><span class="src-doc">     *                             false:    from HTML</span></li>
<li><a name="a2438"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a2439"></a><span class="src-doc">     */</span></li>
<li><a name="a2440"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvUmlaute">convUmlaute</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a2441"></a>    <span class="src-sym">{</span></li>
<li><a name="a2442"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2443"></a>        <span class="src-sym">{</span></li>
<li><a name="a2444"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;auml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2445"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;ouml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2446"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;uuml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2447"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;Auml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2448"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;Ouml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2449"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;Uuml;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2450"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&amp;szlig;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2451"></a>        <span class="src-sym">}</span></li>
<li><a name="a2452"></a>        <span class="src-key">else</span></li>
<li><a name="a2453"></a>        <span class="src-sym">{</span></li>
<li><a name="a2454"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;auml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2455"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;ouml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2456"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;uuml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2457"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;Auml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2458"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;Ouml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2459"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;Uuml;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2460"></a>            <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;szlig;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,    </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2461"></a>        <span class="src-sym">}</span></li>
<li><a name="a2462"></a>        <span class="src-key">return </span><span class="src-var">$str</span><span class="src-sym">;</span></li>
<li><a name="a2463"></a>    <span class="src-sym">}</span></li>
<li><a name="a2464"></a>&nbsp;</li>
<li><a name="a2465"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2466"></a><span class="src-doc">     * Envelops a string with quotes (for db INSERT,UPDATES or SELECT)</span></li>
<li><a name="a2467"></a><span class="src-doc">     *</span></li>
<li><a name="a2468"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">               string to convert</span></li>
<li><a name="a2469"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$conv_special_char </span><span class="src-doc">   convert special charactar to html convention</span></li>
<li><a name="a2470"></a><span class="src-doc">     *                                         (great helper to secure SQL strings) {default: false}</span></li>
<li><a name="a2471"></a><span class="src-doc">     *                                          (conv_special_char is not recomended for an INSERT or UPDATE SQL string)</span></li>
<li><a name="a2472"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$active_null </span><span class="src-doc">       0: deactive NULL value</span></li>
<li><a name="a2473"></a><span class="src-doc">     *                                         1: active NULL value                     {default}</span></li>
<li><a name="a2474"></a><span class="src-doc">     *                                         2: active NULL value, with 0 is invalid</span></li>
<li><a name="a2475"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                            converted string</span></li>
<li><a name="a2476"></a><span class="src-doc">     */</span></li>
<li><a name="a2477"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-var">$conv_special_char</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$active_null</span>=<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a2478"></a>    <span class="src-sym">{</span></li>
<li><a name="a2479"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)) </span><span class="src-var">$str </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2480"></a>&nbsp;</li>
<li><a name="a2481"></a>        <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$active_null</span>==<span class="src-num">1</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">))) </span>||</li>
<li><a name="a2482"></a>            <span class="src-sym">((</span><span class="src-var">$active_null</span>==<span class="src-num">2</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">))))</span></li>
<li><a name="a2483"></a>        <span class="src-sym">{</span></li>
<li><a name="a2484"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$conv_special_char</span><span class="src-sym">)</span></li>
<li><a name="a2485"></a>            <span class="src-sym">{</span></li>
<li><a name="a2486"></a>                <span class="src-var">$str </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvHtml">convHtml</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2487"></a>                <span class="src-var">$str </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvUmlaute">convUmlaute</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2488"></a>            <span class="src-sym">}</span></li>
<li><a name="a2489"></a>            <span class="src-key">return </span><span class="src-str">&quot;'&quot; </span>. <a href="http://www.php.net/addslashes">addslashes</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">) </span>. <span class="src-str">&quot;'&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2490"></a>        <span class="src-sym">}</span></li>
<li><a name="a2491"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$active_null</span>&gt;<span class="src-num">0</span><span class="src-sym">)    </span><span class="src-key">return </span><span class="src-str">&quot;NULL&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2492"></a>        <span class="src-key">else                        </span><span class="src-key">return </span><span class="src-str">&quot;''&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2493"></a>    <span class="src-sym">}</span></li>
<li><a name="a2494"></a>&nbsp;</li>
<li><a name="a2495"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2496"></a><span class="src-doc">     * convert ascii string to HTML string</span></li>
<li><a name="a2497"></a><span class="src-doc">     * (because of a bug, it is better to set magic_quotes_gpc=Off in your php.ini)</span></li>
<li><a name="a2498"></a><span class="src-doc">     *</span></li>
<li><a name="a2499"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">       string to convert</span></li>
<li><a name="a2500"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">       true : html-&gt;ascii</span></li>
<li><a name="a2501"></a><span class="src-doc">     *                                 false: ascii-&gt;html {default}</span></li>
<li><a name="a2502"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_trim </span><span class="src-doc">   true : cut off whitespaces before and after the string {default}</span></li>
<li><a name="a2503"></a><span class="src-doc">     *                                 false: leave string with whitespaces</span></li>
<li><a name="a2504"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_link </span><span class="src-doc">   true : allow HTML links</span></li>
<li><a name="a2505"></a><span class="src-doc">     *                                        (you have to use [url=http://mydomain.com/]thebest[/url] syntax or</span></li>
<li><a name="a2506"></a><span class="src-doc">     *                                        [mail=me@mydomain.com]Me[/mail]</span></li>
<li><a name="a2507"></a><span class="src-doc">     *                                        (at the moment it works only in ascii-&gt;html))</span></li>
<li><a name="a2508"></a><span class="src-doc">     *                                 false: disallow HTML links {default}</span></li>
<li><a name="a2509"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a2510"></a><span class="src-doc">     */</span></li>
<li><a name="a2511"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvHtml">convHtml</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$with_trim</span>=<span class="src-id">true</span><span class="src-sym">, </span><span class="src-var">$with_link</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2512"></a>    <span class="src-sym">{</span></li>
<li><a name="a2513"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_trim</span><span class="src-sym">)    </span><span class="src-var">$str </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2514"></a>&nbsp;</li>
<li><a name="a2515"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$mode</span><span class="src-sym">) </span><span class="src-comm">// ascii -&gt; html</span></li>
<li><a name="a2516"></a>        <span class="src-sym">{</span></li>
<li><a name="a2517"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$str </span>!= <span class="src-str">'*'</span><span class="src-sym">))</span></li>
<li><a name="a2518"></a>            <span class="src-sym">{</span></li>
<li><a name="a2519"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/ini_get">ini_get</a><span class="src-sym">(</span><span class="src-str">&quot;magic_quotes_gpc&quot;</span><span class="src-sym">)</span>!=<span class="src-num">1</span><span class="src-sym">) </span><span class="src-comm">// if &quot;magic_quotes_gpc=off&quot;</span></li>
<li><a name="a2520"></a>                <span class="src-sym">{</span></li>
<li><a name="a2521"></a>                    <span class="src-var">$str </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\\&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\\\&quot;</span><span class="src-sym">, </span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2522"></a>                    <span class="src-var">$str </span>= <a href="http://www.php.net/stripslashes">stripslashes</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2523"></a>                <span class="src-sym">}</span></li>
<li><a name="a2524"></a>&nbsp;</li>
<li><a name="a2525"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/defined">defined</a><span class="src-sym">(</span><span class="src-id">STR_CHARACTER_SET</span><span class="src-sym">))    </span><span class="src-var">$charset </span>= <span class="src-id">STR_CHARACTER_SET</span><span class="src-sym">;</span></li>
<li><a name="a2526"></a>                <span class="src-key">else                             </span><span class="src-var">$charset </span>= <span class="src-str">&quot;iso-8859-1&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2527"></a>&nbsp;</li>
<li><a name="a2528"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/defined">defined</a><span class="src-sym">(</span><span class="src-id">STR_CHARACTER_SET</span><span class="src-sym">))    </span><span class="src-var">$rc </span>= <a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-id">ENT_QUOTES</span><span class="src-sym">, </span><span class="src-var">$charset</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2529"></a>                <span class="src-key">else                             </span><span class="src-var">$rc </span>= <a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-id">ENT_QUOTES</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2530"></a>            <span class="src-sym">}</span></li>
<li><a name="a2531"></a>            <span class="src-key">else</span></li>
<li><a name="a2532"></a>                <span class="src-var">$rc </span>= <span class="src-var">$str</span><span class="src-sym">;</span></li>
<li><a name="a2533"></a>&nbsp;</li>
<li><a name="a2534"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_link</span><span class="src-sym">)</span></li>
<li><a name="a2535"></a>            <span class="src-sym">{</span></li>
<li><a name="a2536"></a>                <span class="src-comm">// Set up the parameters for a URL search string</span></li>
<li><a name="a2537"></a>                <span class="src-var">$URLSearchString </span>= <span class="src-str">&quot; a-zA-Z0-9\:\/\-\?\&amp;\.\=\_\~\#\'&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2538"></a>                <span class="src-comm">// Set up the parameters for a MAIL search string</span></li>
<li><a name="a2539"></a>                <span class="src-var">$MAILSearchString </span>= <span class="src-var">$URLSearchString </span>. <span class="src-str">&quot; a-zA-Z0-9\.@&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2540"></a>&nbsp;</li>
<li><a name="a2541"></a>                <span class="src-comm">// Perform URL Search</span></li>
<li><a name="a2542"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/\[<span class="src-id">url</span>\](<span class="src-sym">[</span><span class="src-var">$URLSearchString</span><span class="src-sym">]</span>*)\[\/<span class="src-id">url</span>\]/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;$1&quot; target=&quot;_blank&quot;&gt;$1&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2543"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">(\[<span class="src-id">url</span>\=(<span class="src-sym">[</span><span class="src-var">$URLSearchString</span><span class="src-sym">]</span>*)\](.*?)\[/<span class="src-id">url</span>\])</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;$1&quot; target=&quot;_blank&quot;&gt;$2&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2544"></a>&nbsp;</li>
<li><a name="a2545"></a>                <span class="src-comm">// Perform same Window URL Search</span></li>
<li><a name="a2546"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">/\[<span class="src-id">surl</span>\](<span class="src-sym">[</span><span class="src-var">$URLSearchString</span><span class="src-sym">]</span>*)\[\/<span class="src-id">surl</span>\]/</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;$1&quot;&gt;$1&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2547"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">(\[<span class="src-id">surl</span>\=(<span class="src-sym">[</span><span class="src-var">$URLSearchString</span><span class="src-sym">]</span>*)\](.*?)\[/<span class="src-id">surl</span>\])</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;$1&quot;&gt;$2&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2548"></a>&nbsp;</li>
<li><a name="a2549"></a>                <span class="src-comm">// Perform MAIL Search</span></li>
<li><a name="a2550"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">(\[<span class="src-id">mail</span>\](<span class="src-sym">[</span><span class="src-var">$MAILSearchString</span><span class="src-sym">]</span>*)\[/<span class="src-id">mail</span>\])</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;mailto:$1&quot;&gt;$1&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2551"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str">(\[<span class="src-id">mail</span>\=(<span class="src-sym">[</span><span class="src-var">$MAILSearchString</span><span class="src-sym">]</span>*)\](.*?)\[/<span class="src-id">mail</span>\])</span><span class="src-str">&quot;</span><span class="src-sym">, </span><span class="src-str">'&lt;a href=&quot;mailto:$1&quot;&gt;$2&lt;/a&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2552"></a>&nbsp;</li>
<li><a name="a2553"></a>                <span class="src-comm">// Check for bold text</span></li>
<li><a name="a2554"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;(\[b\](.+?)\[\/b])is&quot;</span><span class="src-sym">,</span><span class="src-str">'&lt;span style=&quot;font-weight: bold;&quot;&gt;$1&lt;/span&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2555"></a>&nbsp;</li>
<li><a name="a2556"></a>                <span class="src-comm">// Check for italic text</span></li>
<li><a name="a2557"></a>                <span class="src-var">$rc </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-str">&quot;(\[i\](.+?)\[\/i\])is&quot;</span><span class="src-sym">,</span><span class="src-str">'&lt;span style=&quot;font-style: italic;&quot;&gt;$1&lt;/span&gt;'</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2558"></a>            <span class="src-sym">}</span></li>
<li><a name="a2559"></a>        <span class="src-sym">}</span></li>
<li><a name="a2560"></a>        <span class="src-key">else              </span><span class="src-comm">// html -&gt; ascii</span></li>
<li><a name="a2561"></a>        <span class="src-sym">{</span></li>
<li><a name="a2562"></a>            <span class="src-var">$trans </span>= <a href="http://www.php.net/get_html_translation_table">get_html_translation_table</a><span class="src-sym">(</span><span class="src-id">HTML_ENTITIES</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2563"></a>            <span class="src-var">$trans </span>= <a href="http://www.php.net/array_flip">array_flip</a><span class="src-sym">(</span><span class="src-var">$trans</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2564"></a>            <span class="src-var">$rc    </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">, </span><span class="src-var">$trans</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2565"></a>            <span class="src-var">$rc    </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&amp;euro;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;EUR&quot;</span><span class="src-sym">,</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2566"></a>&nbsp;</li>
<li><a name="a2567"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$with_link</span><span class="src-sym">)    </span><span class="src-comm">// show url text, if available</span></li>
<li><a name="a2568"></a>            <span class="src-sym">{</span></li>
<li><a name="a2569"></a>                <span class="src-var">$start_tag_1       </span>= <span class="src-str">&quot;[url=\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2570"></a>                <span class="src-var">$start_tag_1_count </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">, </span><span class="src-var">$start_tag_1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2571"></a>                <span class="src-var">$start_tag_2       </span>= <span class="src-str">&quot;\&quot;]&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2572"></a>                <span class="src-var">$start_tag_2_count </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">, </span><span class="src-var">$start_tag_2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2573"></a>                <span class="src-var">$end_tag           </span>= <span class="src-str">&quot;[/url]&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2574"></a>                <span class="src-var">$end_tag_count     </span>= <a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">, </span><span class="src-var">$end_tag</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2575"></a>&nbsp;</li>
<li><a name="a2576"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$start_tag_1_count</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>&amp;&amp;</li>
<li><a name="a2577"></a>                    <span class="src-sym">(</span><span class="src-var">$start_tag_1_count</span>==<span class="src-var">$end_tag_count</span><span class="src-sym">) </span>&amp;&amp;</li>
<li><a name="a2578"></a>                    <span class="src-sym">(</span><span class="src-var">$start_tag_2_count</span>==<span class="src-var">$end_tag_count</span><span class="src-sym">)) </span><span class="src-comm">// clear links only, if we have the same sum of start and end tags</span></li>
<li><a name="a2579"></a>                <span class="src-sym">{</span></li>
<li><a name="a2580"></a>                    <span class="src-var">$rc </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-var">$end_tag</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2581"></a>&nbsp;</li>
<li><a name="a2582"></a>                    <span class="src-var">$pos1 </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-var">$start_tag_1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2583"></a>                    <span class="src-key">while</span><span class="src-sym">(</span><span class="src-var">$pos1</span><span class="src-sym">)</span></li>
<li><a name="a2584"></a>                    <span class="src-sym">{</span></li>
<li><a name="a2585"></a>                        <span class="src-var">$pos2 </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-var">$start_tag_2</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2586"></a>&nbsp;</li>
<li><a name="a2587"></a>                        <span class="src-var">$part1 </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$pos1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2588"></a>                        <span class="src-var">$part2 </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-sym">(</span><span class="src-var">$pos2</span>+<a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$start_tag_2</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a2589"></a>&nbsp;</li>
<li><a name="a2590"></a>                        <span class="src-var">$rc </span>= <span class="src-var">$part1</span>.<span class="src-var">$part2</span><span class="src-sym">;</span></li>
<li><a name="a2591"></a>&nbsp;</li>
<li><a name="a2592"></a>                        <span class="src-var">$pos1 </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-var">$start_tag_1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2593"></a>                    <span class="src-sym">}</span></li>
<li><a name="a2594"></a>                <span class="src-sym">}</span></li>
<li><a name="a2595"></a>            <span class="src-sym">}</span></li>
<li><a name="a2596"></a>        <span class="src-sym">}</span></li>
<li><a name="a2597"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2598"></a>    <span class="src-sym">}</span></li>
<li><a name="a2599"></a>&nbsp;</li>
<li><a name="a2600"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2601"></a><span class="src-doc">     * convert first letter to upper or lower</span></li>
<li><a name="a2602"></a><span class="src-doc">     *</span></li>
<li><a name="a2603"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$str </span><span class="src-doc">   string to convert</span></li>
<li><a name="a2604"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   true for upper, false for lower</span></li>
<li><a name="a2605"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a2606"></a><span class="src-doc">     */</span></li>
<li><a name="a2607"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvFirstLetter">convFirstLetter</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2608"></a>    <span class="src-sym">{</span></li>
<li><a name="a2609"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2610"></a>            <span class="src-key">return </span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">)</span>.<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2611"></a>        <span class="src-key">else</span></li>
<li><a name="a2612"></a>            <span class="src-key">return </span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-id">strtouppter</span><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">)</span>.<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2613"></a>    <span class="src-sym">}</span></li>
<li><a name="a2614"></a>&nbsp;</li>
<li><a name="a2615"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2616"></a><span class="src-doc">     * Return end tag for formular objects</span></li>
<li><a name="a2617"></a><span class="src-doc">     * attending xhtml settings ($this-&gt;xhtml)</span></li>
<li><a name="a2618"></a><span class="src-doc">     *</span></li>
<li><a name="a2619"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a2620"></a><span class="src-doc">     */</span></li>
<li><a name="a2621"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a2622"></a>    <span class="src-sym">{</span></li>
<li><a name="a2623"></a>         <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$xhtml">xhtml</a><span class="src-sym">)    </span><span class="src-key">return </span><span class="src-str">&quot; /&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2624"></a>         <span class="src-key">else                 </span><span class="src-key">return </span><span class="src-str">&quot;&gt;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2625"></a>    <span class="src-sym">}</span></li>
<li><a name="a2626"></a>&nbsp;</li>
<li><a name="a2627"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2628"></a><span class="src-doc">     * prints a meta description and meta keywords line for xhtml</span></li>
<li><a name="a2629"></a><span class="src-doc">     * Required    : every line in filename is a keyword, first line is the description</span></li>
<li><a name="a2630"></a><span class="src-doc">     *               (first line with quotes!!!)</span></li>
<li><a name="a2631"></a><span class="src-doc">     *</span></li>
<li><a name="a2632"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$filename </span><span class="src-doc">   filename with keywords</span></li>
<li><a name="a2633"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">       true: print it as meta tags {default}</span></li>
<li><a name="a2634"></a><span class="src-doc">     *                                 false: return array with text and keywords</span></li>
<li><a name="a2635"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">               if mode is false, array with text and keywords</span></li>
<li><a name="a2636"></a><span class="src-doc">     */</span></li>
<li><a name="a2637"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodmetatag_write">metatag_write</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a2638"></a>    <span class="src-sym">{</span></li>
<li><a name="a2639"></a>        <span class="src-var">$rc </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2640"></a>&nbsp;</li>
<li><a name="a2641"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">))</span></li>
<li><a name="a2642"></a>        <span class="src-sym">{</span></li>
<li><a name="a2643"></a>            <span class="src-var">$close_sign </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2644"></a>&nbsp;</li>
<li><a name="a2645"></a>            <span class="src-var">$fcontents </span>= <a href="http://www.php.net/file">file</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2646"></a>            <span class="src-var">$meta </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2647"></a>            <span class="src-key">while </span><span class="src-sym">(</span>list <span class="src-sym">(</span><span class="src-var">$line_num</span><span class="src-sym">, </span><span class="src-var">$line</span><span class="src-sym">) </span>= <a href="http://www.php.net/each">each</a> <span class="src-sym">(</span><span class="src-var">$fcontents</span><span class="src-sym">))</span></li>
<li><a name="a2648"></a>            <span class="src-sym">{</span></li>
<li><a name="a2649"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$line_num</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a2650"></a>                <span class="src-sym">{</span></li>
<li><a name="a2651"></a>                    <span class="src-var">$ver_info  </span>= <a href="http://www.php.net/strstr">strstr</a> <span class="src-sym">(</span><span class="src-var">$line</span><span class="src-sym">, </span><span class="src-str">'INFO'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2652"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$ver_info</span><span class="src-sym">))</span></li>
<li><a name="a2653"></a>                    <span class="src-sym">{</span></li>
<li><a name="a2654"></a>                        <span class="src-var">$ver_info </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$ver_info</span><span class="src-sym">,</span><span class="src-num">6</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2655"></a>                        <span class="src-var">$ver_len  </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$ver_info</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2656"></a>&nbsp;</li>
<li><a name="a2657"></a>                        <span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'text'</span><span class="src-sym">] </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$ver_info</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$ver_len</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2658"></a>&nbsp;</li>
<li><a name="a2659"></a>                        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$mode</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'text'</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a2660"></a>                        <span class="src-sym">{</span></li>
<li><a name="a2661"></a>                            print <span class="src-str">&quot;\t&lt;meta name=\&quot;description\&quot; content=\&quot;&quot;</span>.<span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'text'</span><span class="src-sym">]</span>.<span class="src-str">&quot;\&quot;&quot;</span>.<span class="src-var">$close_sign</span><span class="src-sym">;</span></li>
<li><a name="a2662"></a>                            print <span class="src-str">&quot;\t&lt;meta name=\&quot;DC.Description\&quot; content=\&quot;&quot;</span>.<span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'text'</span><span class="src-sym">]</span>.<span class="src-str">&quot;\&quot;&quot;</span>.<span class="src-var">$close_sign</span><span class="src-sym">;</span></li>
<li><a name="a2663"></a>                        <span class="src-sym">}</span></li>
<li><a name="a2664"></a>                    <span class="src-sym">}</span></li>
<li><a name="a2665"></a>                <span class="src-sym">}</span></li>
<li><a name="a2666"></a>                <span class="src-key">else</span></li>
<li><a name="a2667"></a>                <span class="src-sym">{</span></li>
<li><a name="a2668"></a>                    <span class="src-var">$line </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><span class="src-var">$line</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2669"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$line</span><span class="src-sym">))</span></li>
<li><a name="a2670"></a>                        <span class="src-var">$meta</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-var">$line</span><span class="src-sym">;</span></li>
<li><a name="a2671"></a>                <span class="src-sym">}</span></li>
<li><a name="a2672"></a>            <span class="src-sym">}</span></li>
<li><a name="a2673"></a>&nbsp;</li>
<li><a name="a2674"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$meta</span><span class="src-sym">))</span></li>
<li><a name="a2675"></a>            <span class="src-sym">{</span></li>
<li><a name="a2676"></a>                <span class="src-var">$count</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2677"></a>                <span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'keywords'</span><span class="src-sym">] </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2678"></a>                <span class="src-key">while</span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-sym">, </span><span class="src-var">$values</span><span class="src-sym">)</span>=<a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$meta</span><span class="src-sym">))</span></li>
<li><a name="a2679"></a>                <span class="src-sym">{</span></li>
<li><a name="a2680"></a>                    <span class="src-var">$count</span>++<span class="src-sym">;</span></li>
<li><a name="a2681"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$count</span>==<span class="src-num">1</span><span class="src-sym">)        </span><span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'keywords'</span><span class="src-sym">] </span>.= <span class="src-var">$values</span><span class="src-sym">;</span></li>
<li><a name="a2682"></a>                    <span class="src-key">else                </span><span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'keywords'</span><span class="src-sym">] </span>.= <span class="src-str">&quot;,&quot;</span>.<span class="src-var">$values</span><span class="src-sym">;</span></li>
<li><a name="a2683"></a>                <span class="src-sym">}</span></li>
<li><a name="a2684"></a>&nbsp;</li>
<li><a name="a2685"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2686"></a>                <span class="src-sym">{</span></li>
<li><a name="a2687"></a>                    print <span class="src-str">&quot;\t&lt;meta name=\&quot;keywords\&quot; content=\&quot;&quot;</span>.<span class="src-var">$rc</span><span class="src-sym">[</span><span class="src-str">'keywords'</span><span class="src-sym">]</span>.<span class="src-str">&quot;\&quot;&quot;</span>.<span class="src-var">$close_sign</span><span class="src-sym">;</span></li>
<li><a name="a2688"></a>                <span class="src-sym">}</span></li>
<li><a name="a2689"></a>            <span class="src-sym">}</span></li>
<li><a name="a2690"></a>        <span class="src-sym">}</span></li>
<li><a name="a2691"></a>&nbsp;</li>
<li><a name="a2692"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$mode</span><span class="src-sym">)    </span><span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2693"></a>        <span class="src-key">else         </span><span class="src-key">return </span><span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2694"></a>    <span class="src-sym">}</span></li>
<li><a name="a2695"></a>&nbsp;</li>
<li><a name="a2696"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2697"></a><span class="src-doc">     * hit counter for web pages</span></li>
<li><a name="a2698"></a><span class="src-doc">     * Required    : every line in filename is a keyword, first line is the description</span></li>
<li><a name="a2699"></a><span class="src-doc">     *               (first line with quotes!!!)</span></li>
<li><a name="a2700"></a><span class="src-doc">     *</span></li>
<li><a name="a2701"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$id </span><span class="src-doc">           id string</span></li>
<li><a name="a2702"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$r </span><span class="src-doc">           true:  reload allowed</span></li>
<li><a name="a2703"></a><span class="src-doc">     *                                 false: reload disallowed {default}</span></li>
<li><a name="a2704"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$db_open </span><span class="src-doc">   true:  database connection aready open</span></li>
<li><a name="a2705"></a><span class="src-doc">     *                                 false: no database connection open, open one</span></li>
<li><a name="a2706"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$CONF </span><span class="src-doc">       CONF database array, if empty use counterconfig.php</span></li>
<li><a name="a2707"></a><span class="src-doc">     *                                 (have to be in same directory as cphplib.inc)</span></li>
<li><a name="a2708"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a2709"></a><span class="src-doc">     */</span></li>
<li><a name="a2710"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodhitcounter">hitcounter</a><span class="src-sym">(</span><span class="src-var">$id</span><span class="src-sym">, </span><span class="src-var">$r</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$db_open</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$CONF</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a2711"></a>    <span class="src-sym">{</span></li>
<li><a name="a2712"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$id</span><span class="src-sym">))</span></li>
<li><a name="a2713"></a>        <span class="src-sym">{</span></li>
<li><a name="a2714"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;missing id string.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2715"></a>        <span class="src-sym">}</span></li>
<li><a name="a2716"></a>&nbsp;</li>
<li><a name="a2717"></a>        <span class="src-var">$server_domain </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_NAME'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2718"></a>&nbsp;</li>
<li><a name="a2719"></a>         <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_type'</span><span class="src-sym">]</span>!=<span class="src-str">&quot;files&quot;</span><span class="src-sym">) </span><span class="src-comm">// db</span></li>
<li><a name="a2720"></a>         <span class="src-sym">{</span></li>
<li><a name="a2721"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$db_open</span><span class="src-sym">)</span></li>
<li><a name="a2722"></a>            <span class="src-sym">{</span></li>
<li><a name="a2723"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">))</span></li>
<li><a name="a2724"></a>                    <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;hitconfig.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2725"></a>&nbsp;</li>
<li><a name="a2726"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a> =<span class="src-sym">&amp; </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methoddb_connect">db_connect</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'db'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2727"></a>            <span class="src-sym">}</span></li>
<li><a name="a2728"></a>&nbsp;</li>
<li><a name="a2729"></a>             <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">))</span></li>
<li><a name="a2730"></a>             <span class="src-sym">{</span></li>
<li><a name="a2731"></a>                 <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;PEAR database object missing&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2732"></a>             <span class="src-sym">}</span></li>
<li><a name="a2733"></a>         <span class="src-sym">}</span></li>
<li><a name="a2734"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">)) </span><span class="src-comm">// if storage is files, always open hitconfig.php, if no CONF array is given</span></li>
<li><a name="a2735"></a>            <span class="src-inc">require_once</span><span class="src-sym">(</span><span class="src-str">&quot;hitconfig.php&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2736"></a>&nbsp;</li>
<li><a name="a2737"></a>         <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">))</span></li>
<li><a name="a2738"></a>         <span class="src-sym">{</span></li>
<li><a name="a2739"></a>             <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;no CONF array found.&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2740"></a>         <span class="src-sym">}</span></li>
<li><a name="a2741"></a>&nbsp;</li>
<li><a name="a2742"></a>         <span class="src-var">$file_count </span>= <span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_dir'</span><span class="src-sym">]</span>.<span class="src-str">&quot;/hitcounter_&quot;</span>.<span class="src-var">$id</span>.<span class="src-str">&quot;.count&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2743"></a>         <span class="src-var">$file_id    </span>= <span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_dir'</span><span class="src-sym">]</span>.<span class="src-str">&quot;/hitcounter_&quot;</span>.<span class="src-var">$id</span>.<span class="src-str">&quot;.id&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2744"></a>&nbsp;</li>
<li><a name="a2745"></a>         <span class="src-var">$last_num </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2746"></a>        <span class="src-var">$rc_num   </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2747"></a>        <span class="src-var">$current_id_string </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-id">false</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2748"></a>&nbsp;</li>
<li><a name="a2749"></a>        <span class="src-comm">////////////////////////////////////////////////////////////////////////////</span></li>
<li><a name="a2750"></a>        <span class="src-comm">// check if counter is allowed in current script</span></li>
<li><a name="a2751"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodnet_access">net_access</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'allowed_domains'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'allowed_ips'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-str">&quot;server&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2752"></a>        <span class="src-sym">{</span></li>
<li><a name="a2753"></a>            <span class="src-key">die</span><span class="src-sym">(</span><span class="src-id">STR_ACCESS_DENIED</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2754"></a>        <span class="src-sym">}</span></li>
<li><a name="a2755"></a>&nbsp;</li>
<li><a name="a2756"></a>         <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_type'</span><span class="src-sym">]</span>!=<span class="src-str">&quot;files&quot;</span><span class="src-sym">) </span><span class="src-comm">// db</span></li>
<li><a name="a2757"></a>         <span class="src-sym">{</span></li>
<li><a name="a2758"></a>            <span class="src-comm">// get old number</span></li>
<li><a name="a2759"></a>            <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;SELECT hits,id_string FROM &quot;</span>.<span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'db'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'table'</span><span class="src-sym">]</span>.<span class="src-str">&quot; WHERE domain=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$server_domain</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2760"></a>            <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot; AND counter_name=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2761"></a>            <span class="src-var">$row </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">getRow</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2762"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">))</span></li>
<li><a name="a2763"></a>            <span class="src-sym">{</span></li>
<li><a name="a2764"></a>                <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-var">$row</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2765"></a>            <span class="src-sym">}</span></li>
<li><a name="a2766"></a>&nbsp;</li>
<li><a name="a2767"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$row</span><span class="src-sym">))</span></li>
<li><a name="a2768"></a>            <span class="src-sym">{</span></li>
<li><a name="a2769"></a>                <span class="src-var">$last_num       </span>= <span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2770"></a>                <span class="src-var">$last_id_string </span>= <span class="src-var">$row</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2771"></a>            <span class="src-sym">}</span></li>
<li><a name="a2772"></a>         <span class="src-sym">}</span></li>
<li><a name="a2773"></a>         <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">)) </span><span class="src-comm">// files</span></li>
<li><a name="a2774"></a>         <span class="src-sym">{</span></li>
<li><a name="a2775"></a>            <span class="src-var">$fd       </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">,</span><span class="src-str">&quot;r+&quot; </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2776"></a>            <span class="src-var">$last_num </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/fread">fread</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><a href="http://www.php.net/filesize">filesize</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">)))</span><span class="src-sym">;</span></li>
<li><a name="a2777"></a>            <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2778"></a>&nbsp;</li>
<li><a name="a2779"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">)) </span><span class="src-comm">// no get last_id_string, if file exits</span></li>
<li><a name="a2780"></a>             <span class="src-sym">{</span></li>
<li><a name="a2781"></a>                <span class="src-var">$fd             </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">,</span><span class="src-str">&quot;r+&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2782"></a>                <span class="src-var">$last_id_string </span>= <a href="http://www.php.net/fread">fread</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><a href="http://www.php.net/filesize">filesize</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2783"></a>                <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2784"></a>             <span class="src-sym">}</span></li>
<li><a name="a2785"></a>         <span class="src-sym">}</span></li>
<li><a name="a2786"></a>&nbsp;</li>
<li><a name="a2787"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$last_num</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a2788"></a>        <span class="src-sym">{</span></li>
<li><a name="a2789"></a>            <span class="src-comm">////////////////////////////////////////////////////////////////////////////</span></li>
<li><a name="a2790"></a>            <span class="src-comm">// check if visistor should be ignored</span></li>
<li><a name="a2791"></a>            <span class="src-var">$ignore_hit </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodnet_access">net_access</a><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'ignored_domains'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'ignored_ips'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2792"></a>&nbsp;</li>
<li><a name="a2793"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$ignore_hit</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">((</span><span class="src-var">$last_id_string</span>!=<span class="src-var">$current_id_string</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$r</span><span class="src-sym">)) )</span></li>
<li><a name="a2794"></a>            <span class="src-sym">{</span></li>
<li><a name="a2795"></a>                <span class="src-var">$rc_num </span>= <span class="src-var">$last_num</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2796"></a>&nbsp;</li>
<li><a name="a2797"></a>                  <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_type'</span><span class="src-sym">]</span>==<span class="src-str">&quot;files&quot;</span><span class="src-sym">)</span></li>
<li><a name="a2798"></a>                  <span class="src-sym">{</span></li>
<li><a name="a2799"></a>                    <span class="src-var">$fd </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">,</span><span class="src-str">&quot;w+&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2800"></a>                    <a href="http://www.php.net/fwrite">fwrite</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><span class="src-var">$rc_num</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2801"></a>                    <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2802"></a>&nbsp;</li>
<li><a name="a2803"></a>                    <span class="src-var">$fd </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">,</span><span class="src-str">&quot;w+&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2804"></a>                    <a href="http://www.php.net/fwrite">fwrite</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><span class="src-var">$current_id_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2805"></a>                    <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2806"></a>                  <span class="src-sym">}</span></li>
<li><a name="a2807"></a>                  <span class="src-key">else</span></li>
<li><a name="a2808"></a>                  <span class="src-sym">{</span></li>
<li><a name="a2809"></a>                    <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;UPDATE &quot;</span>.<span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'db'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'table'</span><span class="src-sym">]</span>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-id">SET</span> <span class="src-id">hits</span>=<span class="src-var">$rc_num</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2810"></a>                    <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;,id_string=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$current_id_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2811"></a>                    <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;WHERE domain=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$server_domain</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2812"></a>                    <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot; AND counter_name=&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2813"></a>&nbsp;</li>
<li><a name="a2814"></a>                    <span class="src-var">$dbi </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2815"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$dbi</span><span class="src-sym">))</span></li>
<li><a name="a2816"></a>                    <span class="src-sym">{</span></li>
<li><a name="a2817"></a>                        <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-var">$dbi</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2818"></a>                    <span class="src-sym">}</span></li>
<li><a name="a2819"></a>                  <span class="src-sym">}</span></li>
<li><a name="a2820"></a>            <span class="src-sym">}</span></li>
<li><a name="a2821"></a>            <span class="src-key">else</span></li>
<li><a name="a2822"></a>            <span class="src-sym">{</span></li>
<li><a name="a2823"></a>                <span class="src-var">$rc_num </span>= <span class="src-var">$last_num</span><span class="src-sym">;</span></li>
<li><a name="a2824"></a>            <span class="src-sym">}</span></li>
<li><a name="a2825"></a>        <span class="src-sym">}</span></li>
<li><a name="a2826"></a>        <span class="src-key">else </span><span class="src-comm">// start with 1</span></li>
<li><a name="a2827"></a>        <span class="src-sym">{</span></li>
<li><a name="a2828"></a>             <span class="src-var">$rc_num </span>= <span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a2829"></a>              <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'storage_type'</span><span class="src-sym">]</span>==<span class="src-str">&quot;files&quot;</span><span class="src-sym">)</span></li>
<li><a name="a2830"></a>              <span class="src-sym">{</span></li>
<li><a name="a2831"></a>                  <a href="http://www.php.net/touch">touch</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2832"></a>                  <a href="http://www.php.net/touch">touch</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2833"></a>                <a href="http://www.php.net/chmod">chmod</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">,</span><span class="src-num">0664</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2834"></a>                <a href="http://www.php.net/chmod">chmod</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">,</span><span class="src-num">0664</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2835"></a>&nbsp;</li>
<li><a name="a2836"></a>                <span class="src-var">$fd </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_count</span><span class="src-sym">,</span><span class="src-str">&quot;w+&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2837"></a>                <a href="http://www.php.net/fwrite">fwrite</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><span class="src-var">$rc_num</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2838"></a>                <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2839"></a>&nbsp;</li>
<li><a name="a2840"></a>                <span class="src-var">$fd </span>= <a href="http://www.php.net/fopen">fopen</a><span class="src-sym">(</span><span class="src-var">$file_id</span><span class="src-sym">,</span><span class="src-str">&quot;w+&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2841"></a>                <a href="http://www.php.net/fwrite">fwrite</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">,</span><span class="src-var">$current_id_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2842"></a>                <a href="http://www.php.net/fclose">fclose</a><span class="src-sym">(</span><span class="src-var">$fd</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2843"></a>              <span class="src-sym">}</span></li>
<li><a name="a2844"></a>              <span class="src-key">else</span></li>
<li><a name="a2845"></a>              <span class="src-sym">{</span></li>
<li><a name="a2846"></a>                <span class="src-var">$sqlstr  </span>= <span class="src-str">&quot;INSERT INTO &quot;</span>.<span class="src-var">$CONF</span><span class="src-sym">[</span><span class="src-str">'db'</span><span class="src-sym">]</span><span class="src-sym">[</span><span class="src-str">'table'</span><span class="src-sym">]</span>.<span class="src-str">&quot;(domain,counter_name,hits,id_string) &quot;</span><span class="src-sym">;</span></li>
<li><a name="a2847"></a>                 <span class="src-var">$sqlstr </span>.= <span class="src-str">&quot;VALUES (&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$server_domain</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$id</span><span class="src-sym">)</span>.<span class="src-str">&quot;,&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2848"></a>                 <span class="src-var">$sqlstr </span>.= <span class="src-var">$rc_num</span>.<span class="src-str">&quot;,&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodsql_value">sql_value</a><span class="src-sym">(</span><span class="src-var">$current_id_string</span><span class="src-sym">)</span>.<span class="src-str">&quot;)&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2849"></a>                 <span class="src-var">$dbi </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$db">db</a><span class="src-sym">-&gt;</span><span class="src-id">query</span><span class="src-sym">(</span><span class="src-var">$sqlstr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2850"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-id">DB</span><span class="src-sym">::</span><span class="src-id">isError</span><span class="src-sym">(</span><span class="src-var">$dbi</span><span class="src-sym">))</span></li>
<li><a name="a2851"></a>                <span class="src-sym">{</span></li>
<li><a name="a2852"></a>                    <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;hitcounter&quot;</span><span class="src-sym">, </span><span class="src-var">$dbi</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2853"></a>                <span class="src-sym">}</span></li>
<li><a name="a2854"></a>              <span class="src-sym">}</span></li>
<li><a name="a2855"></a>        <span class="src-sym">}</span></li>
<li><a name="a2856"></a>&nbsp;</li>
<li><a name="a2857"></a>        <span class="src-key">return </span><span class="src-var">$rc_num</span><span class="src-sym">;</span></li>
<li><a name="a2858"></a>    <span class="src-sym">}</span></li>
<li><a name="a2859"></a>&nbsp;</li>
<li><a name="a2860"></a>      <span class="src-doc">/**</span></li>
<li><a name="a2861"></a><span class="src-doc">     * Returns type of browser</span></li>
<li><a name="a2862"></a><span class="src-doc">     *</span></li>
<li><a name="a2863"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$details </span><span class="src-doc">   true    = return array with browser type and</span></li>
<li><a name="a2864"></a><span class="src-doc">     *                                           gecko engine version (only available for Mozilla based browsers)</span></li>
<li><a name="a2865"></a><span class="src-doc">     *                                            browser_type  = browser type</span></li>
<li><a name="a2866"></a><span class="src-doc">     *                                            gecko_version = gecko version integer {default: 0}</span></li>
<li><a name="a2867"></a><span class="src-doc">     *                                   false    = return letter for browser type {default: false}</span></li>
<li><a name="a2868"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">               array if details is true, or char:</span></li>
<li><a name="a2869"></a><span class="src-doc">       *                                 m = Mozilla (and all clones)</span></li>
<li><a name="a2870"></a><span class="src-doc">       *                                 i = Internet Explorer</span></li>
<li><a name="a2871"></a><span class="src-doc">       *                                 n = Netscape</span></li>
<li><a name="a2872"></a><span class="src-doc">       *                                 o = Opera</span></li>
<li><a name="a2873"></a><span class="src-doc">       *                                 k = Konqueror</span></li>
<li><a name="a2874"></a><span class="src-doc">       *                                 &quot;&quot; = unknown</span></li>
<li><a name="a2875"></a><span class="src-doc">     */</span></li>
<li><a name="a2876"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodbrowser_type">browser_type</a><span class="src-sym">(</span><span class="src-var">$details</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2877"></a>    <span class="src-sym">{</span></li>
<li><a name="a2878"></a>&nbsp;</li>
<li><a name="a2879"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2880"></a>&nbsp;</li>
<li><a name="a2881"></a>        <span class="src-var">$agent </span>= <a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_USER_AGENT'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2882"></a>&nbsp;</li>
<li><a name="a2883"></a>        <span class="src-key">if      </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;opera&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)        </span><span class="src-var">$rc </span>= <span class="src-str">&quot;o&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2884"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;konqueror&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-str">&quot;k&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2885"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;gecko&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)        </span><span class="src-var">$rc </span>= <span class="src-str">&quot;m&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2886"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;msie&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)            </span><span class="src-var">$rc </span>= <span class="src-str">&quot;i&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2887"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;mozilla&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)        </span><span class="src-var">$rc </span>= <span class="src-str">&quot;n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2888"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$details</span><span class="src-sym">)</span></li>
<li><a name="a2889"></a>        <span class="src-sym">{</span></li>
<li><a name="a2890"></a>            <span class="src-var">$rc_array </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2891"></a>            <span class="src-var">$rc_array</span><span class="src-sym">[</span><span class="src-str">'browser_type'</span><span class="src-sym">]    </span>= <span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2892"></a>            <span class="src-var">$needle </span>= <span class="src-str">&quot;gecko/&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2893"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$rc</span>==<span class="src-str">&quot;m&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-var">$needle</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a2894"></a>            <span class="src-sym">{</span></li>
<li><a name="a2895"></a>                <span class="src-var">$gecko </span>= <a href="http://www.php.net/trim">trim</a><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-sym">(</span><a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">, </span><span class="src-var">$needle</span><span class="src-sym">))</span>+<span class="src-num">6</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a2896"></a>&nbsp;</li>
<li><a name="a2897"></a>                 <span class="src-var">$ln </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$gecko</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2898"></a>                 <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ln</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a2899"></a>                 <span class="src-sym">{</span></li>
<li><a name="a2900"></a>                     <span class="src-var">$tmp_gecko </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2901"></a>                     <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;<span class="src-var">$ln</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a2902"></a>                     <span class="src-sym">{</span></li>
<li><a name="a2903"></a>                         <span class="src-var">$chr </span>= <span class="src-var">$gecko</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a2904"></a>                         <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_numeric">is_numeric</a><span class="src-sym">(</span><span class="src-var">$chr</span><span class="src-sym">))    </span><span class="src-var">$tmp_gecko </span>.= <span class="src-var">$chr</span><span class="src-sym">;</span></li>
<li><a name="a2905"></a>                         <span class="src-key">else                    </span><span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a2906"></a>                     <span class="src-sym">}</span></li>
<li><a name="a2907"></a>                     <span class="src-var">$gecko </span>= <span class="src-var">$tmp_gecko</span><span class="src-sym">;</span></li>
<li><a name="a2908"></a>                 <span class="src-sym">}</span></li>
<li><a name="a2909"></a>                <span class="src-var">$rc_array</span><span class="src-sym">[</span><span class="src-str">'gecko_version'</span><span class="src-sym">]    </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$gecko</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2910"></a>            <span class="src-sym">}</span></li>
<li><a name="a2911"></a>            <span class="src-key">else</span></li>
<li><a name="a2912"></a>            <span class="src-sym">{</span></li>
<li><a name="a2913"></a>                <span class="src-var">$rc_array</span><span class="src-sym">[</span><span class="src-str">'gecko_version'</span><span class="src-sym">]    </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a2914"></a>            <span class="src-sym">}</span></li>
<li><a name="a2915"></a>            <span class="src-key">return </span><span class="src-var">$rc_array</span><span class="src-sym">;</span></li>
<li><a name="a2916"></a>        <span class="src-sym">}</span></li>
<li><a name="a2917"></a>        <span class="src-key">else</span></li>
<li><a name="a2918"></a>        <span class="src-sym">{</span></li>
<li><a name="a2919"></a>            <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2920"></a>        <span class="src-sym">}</span></li>
<li><a name="a2921"></a>    <span class="src-sym">}</span></li>
<li><a name="a2922"></a>&nbsp;</li>
<li><a name="a2923"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2924"></a><span class="src-doc">     * returns type of operating system</span></li>
<li><a name="a2925"></a><span class="src-doc">     *</span></li>
<li><a name="a2926"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   true for server os,</span></li>
<li><a name="a2927"></a><span class="src-doc">     *                             false for client os {default: false}</span></li>
<li><a name="a2928"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   w = Windows</span></li>
<li><a name="a2929"></a><span class="src-doc">     *                     m = Mac</span></li>
<li><a name="a2930"></a><span class="src-doc">     *                     l = Linux</span></li>
<li><a name="a2931"></a><span class="src-doc">     *                     u = Unix</span></li>
<li><a name="a2932"></a><span class="src-doc">     *                     o = OS/2</span></li>
<li><a name="a2933"></a><span class="src-doc">     *                     &quot;&quot; = unknown</span></li>
<li><a name="a2934"></a><span class="src-doc">     */</span></li>
<li><a name="a2935"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodos_type">os_type</a><span class="src-sym">(</span><span class="src-var">$mode</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a2936"></a>    <span class="src-sym">{</span></li>
<li><a name="a2937"></a>        <span class="src-var">$rc</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2938"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span><span class="src-sym">)</span></li>
<li><a name="a2939"></a>        <span class="src-sym">{</span></li>
<li><a name="a2940"></a>            <span class="src-var">$agent </span>= <a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-id">PHP_OS</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2941"></a>&nbsp;</li>
<li><a name="a2942"></a>            <span class="src-key">if      </span><span class="src-sym">((</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;win32&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>||</li>
<li><a name="a2943"></a>                     <span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;winnt&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span>||</li>
<li><a name="a2944"></a>                     <span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;windows&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;w&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2945"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;macos&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;m&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2946"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;linux&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;l&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2947"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;unix&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)  </span><span class="src-var">$rc </span>= <span class="src-str">&quot;u&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2948"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;os/2&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)  </span><span class="src-var">$rc </span>= <span class="src-str">&quot;o&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2949"></a>&nbsp;</li>
<li><a name="a2950"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">))</span></li>
<li><a name="a2951"></a>            <span class="src-sym">{</span></li>
<li><a name="a2952"></a>                <span class="src-key">if    </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'WINDIR'</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-str">&quot;:\\&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a2953"></a>                <span class="src-sym">{</span></li>
<li><a name="a2954"></a>                    <span class="src-var">$rc </span>= <span class="src-str">&quot;w&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2955"></a>                <span class="src-sym">}</span></li>
<li><a name="a2956"></a>            <span class="src-sym">}</span></li>
<li><a name="a2957"></a>        <span class="src-sym">}</span></li>
<li><a name="a2958"></a>        <span class="src-key">else</span></li>
<li><a name="a2959"></a>        <span class="src-sym">{</span></li>
<li><a name="a2960"></a>            <span class="src-var">$agent </span>= <a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_USER_AGENT'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2961"></a>&nbsp;</li>
<li><a name="a2962"></a>            <span class="src-key">if      </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;win&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)   </span><span class="src-var">$rc </span>= <span class="src-str">&quot;w&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2963"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;mac&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)     </span><span class="src-var">$rc </span>= <span class="src-str">&quot;m&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2964"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;linux&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">) </span><span class="src-var">$rc </span>= <span class="src-str">&quot;l&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2965"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;unix&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)  </span><span class="src-var">$rc </span>= <span class="src-str">&quot;u&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2966"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$agent</span><span class="src-sym">,</span><span class="src-str">&quot;os/2&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)  </span><span class="src-var">$rc </span>= <span class="src-str">&quot;o&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2967"></a>        <span class="src-sym">}</span></li>
<li><a name="a2968"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a2969"></a>    <span class="src-sym">}</span></li>
<li><a name="a2970"></a>&nbsp;</li>
<li><a name="a2971"></a>    <span class="src-doc">/**</span></li>
<li><a name="a2972"></a><span class="src-doc">     * calculates CSS font sizes. This is a small solution, that the appearance looks similar</span></li>
<li><a name="a2973"></a><span class="src-doc">     * with different browser types and operating systems</span></li>
<li><a name="a2974"></a><span class="src-doc">     *</span></li>
<li><a name="a2975"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$os_type </span><span class="src-doc">       type of operating system {default: 'user agent os'}</span></li>
<li><a name="a2976"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">char </span><span class="src-doc">   </span><span class="src-doc-var">$browser_type </span><span class="src-doc">   type of browser          {default: 'user agent os'}</span></li>
<li><a name="a2977"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">                   array with css font sizes</span></li>
<li><a name="a2978"></a><span class="src-doc">     */</span></li>
<li><a name="a2979"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_fontsizes">get_fontsizes</a><span class="src-sym">(</span><span class="src-var">$os_type</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$browser_type</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a2980"></a>    <span class="src-sym">{</span></li>
<li><a name="a2981"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$os_type</span><span class="src-sym">))      </span><span class="src-var">$os_type      </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodos_type">os_type</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2982"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$browser_type</span><span class="src-sym">)) </span><span class="src-var">$browser_type </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodbrowser_type">browser_type</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2983"></a>&nbsp;</li>
<li><a name="a2984"></a>        <span class="src-var">$fdata </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a2985"></a>&nbsp;</li>
<li><a name="a2986"></a>        <span class="src-comm">// font_size_smallest</span></li>
<li><a name="a2987"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2988"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_smallest'</span><span class="src-sym">] </span>= <span class="src-str">&quot;8px&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2989"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;m&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;i&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;m&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2990"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_smallest'</span><span class="src-sym">] </span>= <span class="src-str">&quot;x-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2991"></a>        <span class="src-key">else</span></li>
<li><a name="a2992"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_smallest'</span><span class="src-sym">] </span>= <span class="src-str">&quot;xx-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2993"></a>&nbsp;</li>
<li><a name="a2994"></a>        <span class="src-comm">// font_size_small</span></li>
<li><a name="a2995"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;i&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2996"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;75%&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2997"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a2998"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;xx-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a2999"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;m&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;i&quot;</span><span class="src-sym">)</span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;m&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3000"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3001"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>!= <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3002"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;95%&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3003"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;k&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3004"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;xx-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3005"></a>        <span class="src-key">else</span></li>
<li><a name="a3006"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_small'</span><span class="src-sym">] </span>= <span class="src-str">&quot;x-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3007"></a>&nbsp;</li>
<li><a name="a3008"></a>        <span class="src-comm">// font_size</span></li>
<li><a name="a3009"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;m&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;i&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>!=<span class="src-str">&quot;m&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3010"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size'</span><span class="src-sym">] </span>= <span class="src-str">&quot;medium&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3011"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;i&quot;</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3012"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size'</span><span class="src-sym">] </span>= <span class="src-str">&quot;x-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3013"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;k&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3014"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size'</span><span class="src-sym">] </span>= <span class="src-str">&quot;x-small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3015"></a>        <span class="src-key">else</span></li>
<li><a name="a3016"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size'</span><span class="src-sym">] </span>= <span class="src-str">&quot;small&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3017"></a>&nbsp;</li>
<li><a name="a3018"></a>        <span class="src-comm">// font_size_big</span></li>
<li><a name="a3019"></a>        <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;i&quot;</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3020"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_big'</span><span class="src-sym">] </span>= <span class="src-str">&quot;medium&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3021"></a>        <span class="src-key">else</span></li>
<li><a name="a3022"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_big'</span><span class="src-sym">] </span>= <span class="src-str">&quot;large&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3023"></a>&nbsp;</li>
<li><a name="a3024"></a>        <span class="src-comm">// font_size_biggest</span></li>
<li><a name="a3025"></a>        <span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$os_type </span>== <span class="src-str">&quot;w&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;i&quot;</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$browser_type</span>==<span class="src-str">&quot;o&quot;</span><span class="src-sym">))</span></li>
<li><a name="a3026"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_biggest'</span><span class="src-sym">] </span>= <span class="src-str">&quot;large&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3027"></a>        <span class="src-key">else</span></li>
<li><a name="a3028"></a>            <span class="src-var">$fdata</span><span class="src-sym">[</span><span class="src-str">'font_size_biggest'</span><span class="src-sym">] </span>= <span class="src-str">&quot;x-large&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3029"></a>&nbsp;</li>
<li><a name="a3030"></a>        <span class="src-key">return </span><span class="src-var">$fdata</span><span class="src-sym">;</span></li>
<li><a name="a3031"></a>    <span class="src-sym">}</span></li>
<li><a name="a3032"></a>&nbsp;</li>
<li><a name="a3033"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3034"></a><span class="src-doc">     * checks if specified url is on script server</span></li>
<li><a name="a3035"></a><span class="src-doc">     * (on the host where your scripts are)</span></li>
<li><a name="a3036"></a><span class="src-doc">     *</span></li>
<li><a name="a3037"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$url </span></li>
<li><a name="a3038"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">           true if it is on host</span></li>
<li><a name="a3039"></a><span class="src-doc">     */</span></li>
<li><a name="a3040"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodurl_on_scripthost">url_on_scripthost</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a3041"></a>    <span class="src-sym">{</span></li>
<li><a name="a3042"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3043"></a>&nbsp;</li>
<li><a name="a3044"></a>        <span class="src-var">$tmp_array    </span>= <a href="http://www.php.net/parse_url">parse_url</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3045"></a>&nbsp;</li>
<li><a name="a3046"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$tmp_array</span><span class="src-sym">[</span><span class="src-str">'host'</span><span class="src-sym">]</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$tmp_array</span><span class="src-sym">[</span><span class="src-str">'host'</span><span class="src-sym">] </span>== <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_HOST'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3047"></a>            <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3048"></a>&nbsp;</li>
<li><a name="a3049"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3050"></a>      <span class="src-sym">}</span></li>
<li><a name="a3051"></a>&nbsp;</li>
<li><a name="a3052"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3053"></a><span class="src-doc">     * Return cross sum of a number</span></li>
<li><a name="a3054"></a><span class="src-doc">     *</span></li>
<li><a name="a3055"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">   </span><span class="src-doc-var">$number </span></li>
<li><a name="a3056"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a3057"></a><span class="src-doc">     */</span></li>
<li><a name="a3058"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcross_sum">cross_sum</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span></li>
<li><a name="a3059"></a>    <span class="src-sym">{</span></li>
<li><a name="a3060"></a>        <span class="src-var">$rc </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3061"></a>        <span class="src-var">$i_max  </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$number</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3062"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;<span class="src-var">$i_max</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3063"></a>            <span class="src-var">$rc </span>= <span class="src-var">$rc</span>+<span class="src-var">$number</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3064"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3065"></a>    <span class="src-sym">}</span></li>
<li><a name="a3066"></a>&nbsp;</li>
<li><a name="a3067"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3068"></a><span class="src-doc">     * checks for protocol, if missing http will be used</span></li>
<li><a name="a3069"></a><span class="src-doc">     *</span></li>
<li><a name="a3070"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$url </span></li>
<li><a name="a3071"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a3072"></a><span class="src-doc">     */</span></li>
<li><a name="a3073"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodconvUrl">convUrl</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)</span></li>
<li><a name="a3074"></a>    <span class="src-sym">{</span></li>
<li><a name="a3075"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">,</span><span class="src-str">&quot;://&quot;</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3076"></a>            <span class="src-var">$rc </span>= <span class="src-var">$url</span><span class="src-sym">;</span></li>
<li><a name="a3077"></a>        <span class="src-key">else</span></li>
<li><a name="a3078"></a>            <span class="src-var">$rc </span>= <span class="src-str">&quot;http://&quot;</span>.<span class="src-var">$url</span><span class="src-sym">;</span></li>
<li><a name="a3079"></a>&nbsp;</li>
<li><a name="a3080"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-str">&quot;.&quot;</span><span class="src-sym">)</span>&lt;<span class="src-num">2</span><span class="src-sym">)</span></li>
<li><a name="a3081"></a>        <span class="src-sym">{</span></li>
<li><a name="a3082"></a>            <span class="src-var">$pos </span>= <a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">, </span><span class="src-str">&quot;:&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3083"></a>            <span class="src-var">$rc </span>= <a href="http://www.php.net/substr_replace">substr_replace</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">,</span><span class="src-str">&quot;www.&quot;</span><span class="src-sym">,</span><span class="src-var">$pos</span>+<span class="src-num">3</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3084"></a>        <span class="src-sym">}</span></li>
<li><a name="a3085"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3086"></a>    <span class="src-sym">}</span></li>
<li><a name="a3087"></a>&nbsp;</li>
<li><a name="a3088"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3089"></a><span class="src-doc">     * counts days till specified day</span></li>
<li><a name="a3090"></a><span class="src-doc">      *</span></li>
<li><a name="a3091"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">date </span><span class="src-doc">   </span><span class="src-doc-var">$enddate </span></li>
<li><a name="a3092"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">                   days till specified date</span></li>
<li><a name="a3093"></a><span class="src-doc">     */</span></li>
<li><a name="a3094"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcountdown">countdown</a><span class="src-sym">(</span><span class="src-var">$enddate</span><span class="src-sym">)</span></li>
<li><a name="a3095"></a>    <span class="src-sym">{</span></li>
<li><a name="a3096"></a>        <span class="src-var">$ln </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$enddate</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3097"></a>        <span class="src-var">$ix </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3098"></a>        <span class="src-var">$jahr</span>=<span class="src-var">$monat</span>=<span class="src-var">$tag</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3099"></a>        <span class="src-key">while </span><span class="src-sym">(</span><span class="src-var">$ix </span>&lt; <span class="src-var">$ln</span><span class="src-sym">)</span></li>
<li><a name="a3100"></a>        <span class="src-sym">{</span></li>
<li><a name="a3101"></a>            <span class="src-var">$ch </span>= <span class="src-var">$enddate</span><span class="src-sym">[</span><span class="src-var">$ix</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3102"></a>            <span class="src-var">$ix</span>++<span class="src-sym">;</span></li>
<li><a name="a3103"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ix</span>&lt;= <span class="src-num">4</span><span class="src-sym">)</span></li>
<li><a name="a3104"></a>            <span class="src-sym">{</span></li>
<li><a name="a3105"></a>                <span class="src-var">$jahr</span>=<span class="src-var">$jahr </span>. <span class="src-var">$ch</span><span class="src-sym">;</span></li>
<li><a name="a3106"></a>            <span class="src-sym">}</span></li>
<li><a name="a3107"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$ix</span>&gt; <span class="src-num">5</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$ix</span>&lt;<span class="src-num">8</span><span class="src-sym">))</span></li>
<li><a name="a3108"></a>            <span class="src-sym">{</span></li>
<li><a name="a3109"></a>                <span class="src-var">$monat</span>=<span class="src-var">$monat </span>. <span class="src-var">$ch</span><span class="src-sym">;</span></li>
<li><a name="a3110"></a>            <span class="src-sym">}</span></li>
<li><a name="a3111"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ix</span>&gt; <span class="src-num">8</span><span class="src-sym">)</span></li>
<li><a name="a3112"></a>            <span class="src-sym">{</span></li>
<li><a name="a3113"></a>                <span class="src-var">$tag</span>=<span class="src-var">$tag </span>. <span class="src-var">$ch</span><span class="src-sym">;</span></li>
<li><a name="a3114"></a>            <span class="src-sym">}</span></li>
<li><a name="a3115"></a>        <span class="src-sym">}</span></li>
<li><a name="a3116"></a>        <span class="src-var">$date1 </span>= <a href="http://www.php.net/mktime">mktime</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$monat</span><span class="src-sym">,</span><span class="src-var">$tag</span><span class="src-sym">,</span><span class="src-var">$jahr</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3117"></a>        <span class="src-var">$date2 </span>= <a href="http://www.php.net/strtotime">strtotime</a> <span class="src-sym">(</span><span class="src-str">&quot;now&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3118"></a>&nbsp;</li>
<li><a name="a3119"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date1 </span>&gt; <span class="src-var">$date2</span><span class="src-sym">)</span></li>
<li><a name="a3120"></a>        <span class="src-sym">{</span></li>
<li><a name="a3121"></a>            <span class="src-var">$rc </span>= <span class="src-sym">(</span><span class="src-var">$date1 </span>- <span class="src-var">$date2</span><span class="src-sym">) </span>/ <span class="src-num">86400</span><span class="src-sym">; </span><span class="src-comm">// 24 * 60 *60</span></li>
<li><a name="a3122"></a>        <span class="src-sym">}</span></li>
<li><a name="a3123"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$date1 </span>&lt; <span class="src-var">$date2</span><span class="src-sym">)</span></li>
<li><a name="a3124"></a>        <span class="src-sym">{</span></li>
<li><a name="a3125"></a>            <span class="src-var">$rc </span>= <span class="src-sym">(</span><span class="src-var">$date2 </span>- <span class="src-var">$date1</span><span class="src-sym">) </span>/ <span class="src-num">86400</span><span class="src-sym">; </span><span class="src-comm">// 24 * 60 *60</span></li>
<li><a name="a3126"></a>        <span class="src-sym">}</span></li>
<li><a name="a3127"></a>        <span class="src-key">else</span></li>
<li><a name="a3128"></a>        <span class="src-sym">{</span></li>
<li><a name="a3129"></a>            <span class="src-var">$rc </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3130"></a>        <span class="src-sym">}</span></li>
<li><a name="a3131"></a>&nbsp;</li>
<li><a name="a3132"></a>        <span class="src-key">return </span><a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3133"></a>    <span class="src-sym">}</span></li>
<li><a name="a3134"></a>&nbsp;</li>
<li><a name="a3135"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3136"></a><span class="src-doc">     * computes the exact age (considering leap years!) of the person born on</span></li>
<li><a name="a3137"></a><span class="src-doc">     * the specified birthday measured from today or a specified date</span></li>
<li><a name="a3138"></a><span class="src-doc">     *</span></li>
<li><a name="a3139"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$date </span><span class="src-doc">           Date on which the person was born</span></li>
<li><a name="a3140"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$thisdate </span><span class="src-doc">       Date from which the age is measured (default: today)</span></li>
<li><a name="a3141"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">char </span><span class="src-doc">       </span><span class="src-doc-var">$date_format </span><span class="src-doc">   Format of the date and thisdate strings (default: &quot;S&quot;cience format)</span></li>
<li><a name="a3142"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">bool </span><span class="src-doc">       </span><span class="src-doc-var">$fixed </span><span class="src-doc">           if true, age of current year will be returned {default: false}</span></li>
<li><a name="a3143"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">int </span><span class="src-doc">                       age of person, returns &quot;&quot; if the person is not born yet or the date is wrong!</span></li>
<li><a name="a3144"></a><span class="src-doc">     *                                     (returns &quot;born&quot;-string, if the age is exactly 0)</span></li>
<li><a name="a3145"></a><span class="src-doc">     */</span></li>
<li><a name="a3146"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodage_from_birthday">age_from_birthday</a><span class="src-sym">(</span><span class="src-var">$date</span><span class="src-sym">, </span><span class="src-var">$thisdate</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$date_format</span>=<span class="src-str">&quot;S&quot;</span><span class="src-sym">, </span><span class="src-var">$fixed</span>=<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a3147"></a>    <span class="src-sym">{</span></li>
<li><a name="a3148"></a>        <span class="src-var">$date  </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$date</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">,</span><span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3149"></a>        <span class="src-var">$year  </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$date</span><span class="src-sym">,</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3150"></a>        <span class="src-var">$month </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3151"></a>        <span class="src-var">$day   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3152"></a>&nbsp;</li>
<li><a name="a3153"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$thisdate</span>==<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3154"></a>        <span class="src-sym">{</span></li>
<li><a name="a3155"></a>            <span class="src-var">$thisyear  </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;Y&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3156"></a>            <span class="src-var">$thismonth </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;n&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3157"></a>            <span class="src-var">$thisday   </span>= <a href="http://www.php.net/date">date</a><span class="src-sym">(</span><span class="src-str">&quot;j&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3158"></a>        <span class="src-sym">}</span></li>
<li><a name="a3159"></a>        <span class="src-key">else</span></li>
<li><a name="a3160"></a>        <span class="src-sym">{</span></li>
<li><a name="a3161"></a>            <span class="src-var">$thisdate  </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodconvDate">convDate</a><span class="src-sym">(</span><span class="src-var">$thisdate</span><span class="src-sym">, </span><span class="src-var">$date_format</span><span class="src-sym">, </span><span class="src-str">&quot;S&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3162"></a>&nbsp;</li>
<li><a name="a3163"></a>            <span class="src-var">$thisyear  </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-var">$thisdate</span><span class="src-sym">,</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3164"></a>            <span class="src-var">$thismonth </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3165"></a>            <span class="src-var">$thisday   </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><a href="http://www.php.net/strtok">strtok</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3166"></a>        <span class="src-sym">}</span></li>
<li><a name="a3167"></a>&nbsp;</li>
<li><a name="a3168"></a>        <span class="src-var">$age </span>= <span class="src-var">$thisyear</span>-<span class="src-var">$year</span><span class="src-sym">;</span></li>
<li><a name="a3169"></a>&nbsp;</li>
<li><a name="a3170"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$fixed</span><span class="src-sym">)</span></li>
<li><a name="a3171"></a>        <span class="src-sym">{</span></li>
<li><a name="a3172"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$thismonth</span>&lt;<span class="src-var">$month</span><span class="src-sym">) </span>||</li>
<li><a name="a3173"></a>                 <span class="src-sym">((</span><span class="src-var">$thismonth</span>==<span class="src-var">$month</span><span class="src-sym">)</span>&amp;&amp;<span class="src-sym">(</span><span class="src-var">$thisday</span>&lt;<span class="src-var">$day</span><span class="src-sym">)))</span></li>
<li><a name="a3174"></a>                <span class="src-var">$age </span>= <span class="src-var">$age</span>-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3175"></a>        <span class="src-sym">}</span></li>
<li><a name="a3176"></a>&nbsp;</li>
<li><a name="a3177"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$age</span>&lt;<span class="src-num">0</span><span class="src-sym">)</span>||<span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/checkdate">checkdate</a><span class="src-sym">(</span><span class="src-var">$month</span><span class="src-sym">,</span><span class="src-var">$day</span><span class="src-sym">,</span><span class="src-var">$year</span><span class="src-sym">)))</span></li>
<li><a name="a3178"></a>            <span class="src-var">$age </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3179"></a>&nbsp;</li>
<li><a name="a3180"></a>        <span class="src-key">return </span><span class="src-var">$age</span><span class="src-sym">;</span></li>
<li><a name="a3181"></a>    <span class="src-sym">}</span></li>
<li><a name="a3182"></a>&nbsp;</li>
<li><a name="a3183"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3184"></a><span class="src-doc">     * generate rand string/number with specified length</span></li>
<li><a name="a3185"></a><span class="src-doc">     *</span></li>
<li><a name="a3186"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$length </span><span class="src-doc">   length of chars/numbers for return</span></li>
<li><a name="a3187"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$values </span><span class="src-doc">   string with all allowed characters/numbers</span></li>
<li><a name="a3188"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">    </span><span class="src-doc-type">string </span><span class="src-doc">           generated rand string, on error &quot;&quot;</span></li>
<li><a name="a3189"></a><span class="src-doc">     */</span></li>
<li><a name="a3190"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodrand_value">rand_value</a><span class="src-sym">(</span><span class="src-var">$length</span>=<span class="src-num">1</span><span class="src-sym">, </span><span class="src-var">$values</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3191"></a>    <span class="src-sym">{</span></li>
<li><a name="a3192"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3193"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$values</span><span class="src-sym">))</span></li>
<li><a name="a3194"></a>        <span class="src-sym">{</span></li>
<li><a name="a3195"></a>            <span class="src-var">$values </span>= <span class="src-str">&quot;1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3196"></a>        <span class="src-sym">}</span></li>
<li><a name="a3197"></a>&nbsp;</li>
<li><a name="a3198"></a>        <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">;</span><span class="src-var">$i</span>&lt;<a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$length</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3199"></a>        <span class="src-sym">{</span></li>
<li><a name="a3200"></a>            <a href="http://www.php.net/srand">srand</a><span class="src-sym">(</span>(double) <a href="http://www.php.net/microtime">microtime</a><span class="src-sym">(</span><span class="src-sym">) </span>* <span class="src-num">1000000</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3201"></a>            <span class="src-var">$rc </span>.= <span class="src-var">$values</span><span class="src-sym">[</span><a href="http://www.php.net/mt_rand">mt_rand</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">,</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$values</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3202"></a>        <span class="src-sym">}</span></li>
<li><a name="a3203"></a>&nbsp;</li>
<li><a name="a3204"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3205"></a>    <span class="src-sym">}</span></li>
<li><a name="a3206"></a>&nbsp;</li>
<li><a name="a3207"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3208"></a><span class="src-doc">     * generate password with specified characteristics</span></li>
<li><a name="a3209"></a><span class="src-doc">     *</span></li>
<li><a name="a3210"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$options </span><span class="src-doc">   options array:</span></li>
<li><a name="a3211"></a><span class="src-doc">     *                                      min_length        = min. length of password {default: 8}</span></li>
<li><a name="a3212"></a><span class="src-doc">     *                                      max_length        = max. length of password {default: 8}</span></li>
<li><a name="a3213"></a><span class="src-doc">     *                                      exclude_signs    = string with forbiddenen signs</span></li>
<li><a name="a3214"></a><span class="src-doc">     *                                      include_signs    = string with signs, which have to been used</span></li>
<li><a name="a3215"></a><span class="src-doc">     *                                      exclude_pwd        = this password is forbidden</span></li>
<li><a name="a3216"></a><span class="src-doc">     *                                      with_numbers    = password has to use at least one number {true}</span></li>
<li><a name="a3217"></a><span class="src-doc">     *                                      with_lowers        = password has to use at least one lower letter {true}</span></li>
<li><a name="a3218"></a><span class="src-doc">     *                                      with_uppers        = password has to use at least one upper letter {true}</span></li>
<li><a name="a3219"></a><span class="src-doc">     *                                      with_signs        = password has to use at least one special char {true}</span></li>
<li><a name="a3220"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   generated password string</span></li>
<li><a name="a3221"></a><span class="src-doc">     *                                     (if an error occurred, false)</span></li>
<li><a name="a3222"></a><span class="src-doc">     */</span></li>
<li><a name="a3223"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodgenerate_password">generate_password</a><span class="src-sym">(</span><span class="src-var">$options</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a3224"></a>    <span class="src-sym">{</span></li>
<li><a name="a3225"></a>        <span class="src-comm">// defaults</span></li>
<li><a name="a3226"></a>        <span class="src-var">$min_length        </span>= <span class="src-num">8</span><span class="src-sym">;</span></li>
<li><a name="a3227"></a>        <span class="src-var">$max_length        </span>= <span class="src-num">8</span><span class="src-sym">;</span></li>
<li><a name="a3228"></a>        <span class="src-var">$with_numbers    </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3229"></a>        <span class="src-var">$with_lowers    </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3230"></a>        <span class="src-var">$with_uppers    </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3231"></a>        <span class="src-var">$with_signs        </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3232"></a>&nbsp;</li>
<li><a name="a3233"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">))</span></li>
<li><a name="a3234"></a>        <span class="src-sym">{</span></li>
<li><a name="a3235"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;min_length&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">))</span></li>
<li><a name="a3236"></a>            <span class="src-sym">{</span></li>
<li><a name="a3237"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'min_length'</span><span class="src-sym">]</span><span class="src-sym">)</span>&lt;<span class="src-num">3</span><span class="src-sym">)</span></li>
<li><a name="a3238"></a>                    <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3239"></a>                <span class="src-key">else</span></li>
<li><a name="a3240"></a>                    <span class="src-var">$min_length </span>= <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'min_length'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3241"></a>            <span class="src-sym">}</span></li>
<li><a name="a3242"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;max_length&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">))</span></li>
<li><a name="a3243"></a>            <span class="src-sym">{</span></li>
<li><a name="a3244"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'max_length'</span><span class="src-sym">]</span><span class="src-sym">)</span>&lt;<span class="src-var">$min_length</span><span class="src-sym">)</span></li>
<li><a name="a3245"></a>                    <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3246"></a>                <span class="src-key">else</span></li>
<li><a name="a3247"></a>                    <span class="src-var">$max_length </span>= <span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'max_length'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3248"></a>            <span class="src-sym">}</span></li>
<li><a name="a3249"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$min_length</span>&gt;<span class="src-var">$max_length</span><span class="src-sym">)</span></li>
<li><a name="a3250"></a>                <span class="src-var">$max_length </span>= <span class="src-var">$min_length</span><span class="src-sym">;</span></li>
<li><a name="a3251"></a>&nbsp;</li>
<li><a name="a3252"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;with_numbers&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'with_numbers'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3253"></a>                <span class="src-var">$with_numbers </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3254"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;with_lowers&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'with_lowers'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3255"></a>                <span class="src-var">$with_lowers </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3256"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;with_uppers&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'with_uppers'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3257"></a>                <span class="src-var">$with_uppers </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3258"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-str">&quot;with_signs&quot;</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'with_signs'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3259"></a>                <span class="src-var">$with_signs </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3260"></a>&nbsp;</li>
<li><a name="a3261"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$with_numbers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$with_lowers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$with_uppers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$with_signs</span><span class="src-sym">))</span></li>
<li><a name="a3262"></a>                <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3263"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_numbers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$with_lowers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$with_uppers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$with_signs</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$min_length</span>&lt;<span class="src-num">4</span><span class="src-sym">))</span></li>
<li><a name="a3264"></a>                <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3265"></a>        <span class="src-sym">}</span></li>
<li><a name="a3266"></a>&nbsp;</li>
<li><a name="a3267"></a>        <span class="src-var">$numbers    </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-num">9</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3268"></a>        <span class="src-var">$lowers        </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-str">'a'</span><span class="src-sym">, </span><span class="src-str">'z'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3269"></a>        <span class="src-var">$uppers        </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-str">'A'</span><span class="src-sym">, </span><span class="src-str">'Z'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3270"></a>        <span class="src-var">$signs        </span>= <a href="http://www.php.net/str_split">str_split</a><span class="src-sym">(</span><span class="src-str">&quot;!@#%&amp;*-_=.,;:^()[]{}/\\&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3271"></a>&nbsp;</li>
<li><a name="a3272"></a>        <span class="src-var">$haystack </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3273"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_numbers</span><span class="src-sym">)</span></li>
<li><a name="a3274"></a>            <span class="src-var">$haystack </span>= <span class="src-var">$numbers</span><span class="src-sym">;</span></li>
<li><a name="a3275"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_lowers</span><span class="src-sym">)</span></li>
<li><a name="a3276"></a>            <span class="src-var">$haystack </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-var">$lowers</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3277"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_uppers</span><span class="src-sym">)</span></li>
<li><a name="a3278"></a>            <span class="src-var">$haystack </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-var">$uppers</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3279"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_signs</span><span class="src-sym">)</span></li>
<li><a name="a3280"></a>            <span class="src-var">$haystack </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-var">$signs</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3281"></a>&nbsp;</li>
<li><a name="a3282"></a>        <span class="src-comm">// exclude forbitten signs</span></li>
<li><a name="a3283"></a>        <span class="src-var">$ex_sum </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3284"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'exclude_signs'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3285"></a>        <span class="src-sym">{</span></li>
<li><a name="a3286"></a>            <span class="src-var">$ex </span>= <a href="http://www.php.net/str_split">str_split</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'exclude_signs'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3287"></a>            <span class="src-var">$ex </span>= <a href="../cphplib/cphplib.html#methodarray_unique">array_unique</a><span class="src-sym">(</span><span class="src-var">$ex</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3288"></a>&nbsp;</li>
<li><a name="a3289"></a>            <span class="src-var">$ex_sum </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$ex</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3290"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ex_sum</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3291"></a>            <span class="src-sym">{</span></li>
<li><a name="a3292"></a>                <span class="src-comm">// looking for a better solution, kind of array_unmerge</span></li>
<li><a name="a3293"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-var">$ex_sum</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3294"></a>                <span class="src-sym">{</span></li>
<li><a name="a3295"></a>                    <a href="http://www.php.net/reset">reset</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3296"></a>                    <span class="src-key">while</span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">)</span>=<a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">))</span></li>
<li><a name="a3297"></a>                    <span class="src-sym">{</span></li>
<li><a name="a3298"></a>                        <span class="src-var">$tmp_ex </span>= <span class="src-var">$ex</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3299"></a>&nbsp;</li>
<li><a name="a3300"></a>                        <span class="src-comm">// need &quot;&quot;, type conversion?</span></li>
<li><a name="a3301"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-str">&quot;</span><span class="src-str"><span class="src-var">$value</span></span><span class="src-str">&quot;</span>==<span class="src-var">$tmp_ex</span><span class="src-sym">)</span></li>
<li><a name="a3302"></a>                        <span class="src-sym">{</span></li>
<li><a name="a3303"></a>                            unset<span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3304"></a>                            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a3305"></a>                        <span class="src-sym">}</span></li>
<li><a name="a3306"></a>                    <span class="src-sym">}</span></li>
<li><a name="a3307"></a>                <span class="src-sym">}</span></li>
<li><a name="a3308"></a>            <span class="src-sym">}</span></li>
<li><a name="a3309"></a>        <span class="src-sym">}</span></li>
<li><a name="a3310"></a>&nbsp;</li>
<li><a name="a3311"></a>        <span class="src-comm">// build include array</span></li>
<li><a name="a3312"></a>        <span class="src-var">$in_sum </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3313"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'include_signs'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3314"></a>        <span class="src-sym">{</span></li>
<li><a name="a3315"></a>            <span class="src-var">$in </span>= <a href="http://www.php.net/str_split">str_split</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'include_signs'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3316"></a>            <span class="src-var">$in </span>= <a href="../cphplib/cphplib.html#methodarray_unique">array_unique</a><span class="src-sym">(</span><span class="src-var">$in</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3317"></a>&nbsp;</li>
<li><a name="a3318"></a>            <span class="src-var">$in_sum </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$in</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3319"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$in_sum</span>&gt;<span class="src-var">$min_length</span><span class="src-sym">)</span></li>
<li><a name="a3320"></a>                <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3321"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$ex_sum</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3322"></a>            <span class="src-sym">{</span></li>
<li><a name="a3323"></a>                <span class="src-comm">// check exclude list for include signs</span></li>
<li><a name="a3324"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;/&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\/&quot;</span><span class="src-sym">,    </span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'include_signs'</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3325"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;(&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\(&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3326"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;)&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\)&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3327"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\-&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3328"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;-&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\-&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3329"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\\&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\\\&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3330"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\;&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3331"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;.&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\.&quot;</span><span class="src-sym">,    </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3332"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;,&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\,&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3333"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;[&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\,&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3334"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;]&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\,&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3335"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;{&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\{&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3336"></a>                <span class="src-var">$needle </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;}&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;\\}&quot;</span><span class="src-sym">,     </span><span class="src-var">$needle</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3337"></a>&nbsp;</li>
<li><a name="a3338"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/['</span>.<span class="src-var">$needle</span>.<span class="src-str">']/'</span><span class="src-sym">, </span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'exclude_signs'</span><span class="src-sym">]</span><span class="src-sym">))</span></li>
<li><a name="a3339"></a>                    <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3340"></a>            <span class="src-sym">}</span></li>
<li><a name="a3341"></a>        <span class="src-sym">}</span></li>
<li><a name="a3342"></a>&nbsp;</li>
<li><a name="a3343"></a>        <span class="src-var">$max_cnt    </span>= <span class="src-num">1000</span><span class="src-sym">; </span><span class="src-comm">// if 1000 tries find no password, return false!</span></li>
<li><a name="a3344"></a>        <span class="src-var">$cnt        </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3345"></a>        <span class="src-var">$rc            </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3346"></a>&nbsp;</li>
<li><a name="a3347"></a>        <span class="src-key">while</span><span class="src-sym">(</span><span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a3348"></a>        <span class="src-sym">{</span></li>
<li><a name="a3349"></a>            <span class="src-var">$cnt</span>++<span class="src-sym">;</span></li>
<li><a name="a3350"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cnt</span>&gt;<span class="src-var">$max_cnt</span><span class="src-sym">)    </span><span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a3351"></a>&nbsp;</li>
<li><a name="a3352"></a>            <span class="src-comm">// length of password</span></li>
<li><a name="a3353"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$min_length</span>==<span class="src-var">$max_length</span><span class="src-sym">)</span></li>
<li><a name="a3354"></a>            <span class="src-sym">{</span></li>
<li><a name="a3355"></a>                <span class="src-var">$pwd_length </span>= <span class="src-var">$min_length</span><span class="src-sym">;</span></li>
<li><a name="a3356"></a>            <span class="src-sym">}</span></li>
<li><a name="a3357"></a>            <span class="src-key">else</span></li>
<li><a name="a3358"></a>            <span class="src-sym">{</span></li>
<li><a name="a3359"></a>                <span class="src-var">$range </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-var">$min_length</span><span class="src-sym">, </span><span class="src-var">$max_length</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3360"></a>                <span class="src-var">$pwd_length </span>= <span class="src-var">$range</span><span class="src-sym">[</span><a href="http://www.php.net/array_rand">array_rand</a><span class="src-sym">(</span><span class="src-var">$range</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3361"></a>            <span class="src-sym">}</span></li>
<li><a name="a3362"></a>&nbsp;</li>
<li><a name="a3363"></a>            <span class="src-var">$tmp_passwd </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3364"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-var">$pwd_length</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3365"></a>            <span class="src-sym">{</span></li>
<li><a name="a3366"></a>                <span class="src-var">$key </span>= <a href="http://www.php.net/array_rand">array_rand</a><span class="src-sym">(</span><span class="src-var">$haystack</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3367"></a>                <span class="src-var">$tmp_passwd </span>.= <span class="src-var">$haystack</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3368"></a>            <span class="src-sym">}</span></li>
<li><a name="a3369"></a>&nbsp;</li>
<li><a name="a3370"></a>            <span class="src-comm">// include signs</span></li>
<li><a name="a3371"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$in_sum</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3372"></a>            <span class="src-sym">{</span></li>
<li><a name="a3373"></a>                <span class="src-var">$in_range </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$pwd_length</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3374"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-var">$in_sum</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3375"></a>                <span class="src-sym">{</span></li>
<li><a name="a3376"></a>                    <span class="src-var">$in_pos </span>= <a href="http://www.php.net/array_rand">array_rand</a><span class="src-sym">(</span><span class="src-var">$in_range</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3377"></a>                    <span class="src-var">$tmp_passwd</span><span class="src-sym">[</span><span class="src-var">$in_pos</span><span class="src-sym">] </span>= <span class="src-var">$in</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3378"></a>&nbsp;</li>
<li><a name="a3379"></a>                    <span class="src-comm">// remove from range</span></li>
<li><a name="a3380"></a>                    unset<span class="src-sym">(</span><span class="src-var">$in_range</span><span class="src-sym">[</span><span class="src-var">$in_pos</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3381"></a>                <span class="src-sym">}</span></li>
<li><a name="a3382"></a>            <span class="src-sym">}</span></li>
<li><a name="a3383"></a>&nbsp;</li>
<li><a name="a3384"></a>            <span class="src-comm">// count how many lowercase, uppercase, and digits are in the password</span></li>
<li><a name="a3385"></a>            <span class="src-var">$uc </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$lc </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$num </span>= <span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$sc </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3386"></a>            <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i </span>= <span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$j </span>= <span class="src-var">$pwd_length</span><span class="src-sym">; </span><span class="src-var">$i </span>&lt; <span class="src-var">$j</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a3387"></a>            <span class="src-sym">{</span></li>
<li><a name="a3388"></a>                <span class="src-var">$c </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$tmp_passwd</span><span class="src-sym">, </span><span class="src-var">$i</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3389"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^[[:upper:]]$/'</span><span class="src-sym">,</span><span class="src-var">$c</span><span class="src-sym">))</span></li>
<li><a name="a3390"></a>                    <span class="src-var">$uc</span>++<span class="src-sym">;</span></li>
<li><a name="a3391"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^[[:lower:]]$/'</span><span class="src-sym">,</span><span class="src-var">$c</span><span class="src-sym">))</span></li>
<li><a name="a3392"></a>                    <span class="src-var">$lc</span>++<span class="src-sym">;</span></li>
<li><a name="a3393"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^[[:digit:]]$/'</span><span class="src-sym">,</span><span class="src-var">$c</span><span class="src-sym">))</span></li>
<li><a name="a3394"></a>                    <span class="src-var">$num</span>++<span class="src-sym">;</span></li>
<li><a name="a3395"></a>                <span class="src-key">else</span></li>
<li><a name="a3396"></a>                    <span class="src-var">$sc</span>++<span class="src-sym">;</span></li>
<li><a name="a3397"></a>            <span class="src-sym">}</span></li>
<li><a name="a3398"></a>&nbsp;</li>
<li><a name="a3399"></a>            <span class="src-comm">// currenty not supported with include chars</span></li>
<li><a name="a3400"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$in_sum</span>==<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3401"></a>            <span class="src-sym">{</span></li>
<li><a name="a3402"></a>                <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_lowers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$lc</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a3403"></a>                    <span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3404"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_uppers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$uc</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a3405"></a>                    <span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3406"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_numbers</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$uc</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a3407"></a>                    <span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3408"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$with_signs</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$sc</span>==<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a3409"></a>                    <span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3410"></a>            <span class="src-sym">}</span></li>
<li><a name="a3411"></a>&nbsp;</li>
<li><a name="a3412"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'exclude_pwd'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$options</span><span class="src-sym">[</span><span class="src-str">'exclude_pwd'</span><span class="src-sym">]</span>==<span class="src-var">$tmp_passwd</span><span class="src-sym">))</span></li>
<li><a name="a3413"></a>                <span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3414"></a>&nbsp;</li>
<li><a name="a3415"></a>            <span class="src-var">$rc </span>= <span class="src-var">$tmp_passwd</span><span class="src-sym">;</span></li>
<li><a name="a3416"></a>            <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a3417"></a>        <span class="src-sym">}</span></li>
<li><a name="a3418"></a>&nbsp;</li>
<li><a name="a3419"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3420"></a>    <span class="src-sym">}</span></li>
<li><a name="a3421"></a>&nbsp;</li>
<li><a name="a3422"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3423"></a><span class="src-doc">     * create unique identification string</span></li>
<li><a name="a3424"></a><span class="src-doc">     *</span></li>
<li><a name="a3425"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$with_time </span><span class="src-doc">   true : with timestamp {default}</span></li>
<li><a name="a3426"></a><span class="src-doc">     *                                 false: without considering time and date</span></li>
<li><a name="a3427"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">               unique identification string</span></li>
<li><a name="a3428"></a><span class="src-doc">     */</span></li>
<li><a name="a3429"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_id_string">get_id_string</a><span class="src-sym">(</span><span class="src-var">$with_time</span>=<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a3430"></a>    <span class="src-sym">{</span></li>
<li><a name="a3431"></a>        <span class="src-var">$id_string </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">]</span>.<span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_USER_AGENT'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3432"></a>&nbsp;</li>
<li><a name="a3433"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_time</span><span class="src-sym">)</span></li>
<li><a name="a3434"></a>        <span class="src-sym">{</span></li>
<li><a name="a3435"></a>             <a href="http://www.php.net/mt_srand">mt_srand</a><span class="src-sym">( </span>(double) <a href="http://www.php.net/microtime">microtime</a><span class="src-sym">(</span><span class="src-sym">) </span>* <span class="src-num">1000000</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3436"></a>             <span class="src-var">$tmp_time      </span>= <a href="http://www.php.net/md5">md5</a><span class="src-sym">(</span><a href="http://www.php.net/mt_rand">mt_rand</a><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span></li>
<li><a name="a3437"></a>              <span class="src-key">return </span><a href="http://www.php.net/md5">md5</a><span class="src-sym">(</span><span class="src-var">$id_string</span>.<span class="src-var">$tmp_time</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3438"></a>        <span class="src-sym">}</span></li>
<li><a name="a3439"></a>        <span class="src-key">else</span></li>
<li><a name="a3440"></a>            <span class="src-key">return </span><a href="http://www.php.net/md5">md5</a><span class="src-sym">(</span><span class="src-var">$id_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3441"></a>    <span class="src-sym">}</span></li>
<li><a name="a3442"></a>&nbsp;</li>
<li><a name="a3443"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3444"></a><span class="src-doc">     * get the ip address from the client, even if the client is befind a proxy</span></li>
<li><a name="a3445"></a><span class="src-doc">     * (it doesn't work with transparent proxy!)</span></li>
<li><a name="a3446"></a><span class="src-doc">     *</span></li>
<li><a name="a3447"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   ip address of the client</span></li>
<li><a name="a3448"></a><span class="src-doc">     */</span></li>
<li><a name="a3449"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_client_ip">get_client_ip</a><span class="src-sym">(</span><span class="src-sym">)</span></li>
<li><a name="a3450"></a>    <span class="src-sym">{</span></li>
<li><a name="a3451"></a>        <span class="src-key">global </span><span class="src-var">$REMOTE_ADDR</span><span class="src-sym">;</span></li>
<li><a name="a3452"></a>&nbsp;</li>
<li><a name="a3453"></a>        <span class="src-var">$client_ip </span>= <span class="src-sym">( </span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">]</span><span class="src-sym">) ) </span>? <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">] </span>: <span class="src-sym">( ( </span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$_ENV</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">]</span><span class="src-sym">) ) </span>? <span class="src-var">$_ENV</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">] </span>: <span class="src-var">$REMOTE_ADDR </span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3454"></a>&nbsp;</li>
<li><a name="a3455"></a>        <span class="src-comm">// Check for headers used by proxy servers to send the Client IP.</span></li>
<li><a name="a3456"></a>        <span class="src-comm">// We should look for HTTP_CLIENT_IP before HTTP_X_FORWARDED_FOR.</span></li>
<li><a name="a3457"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_CLIENT_IP'</span><span class="src-sym">]</span><span class="src-sym">)                </span><span class="src-var">$proxy_ip </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_CLIENT_IP'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3458"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_X_FORWARDED_FOR'</span><span class="src-sym">]</span><span class="src-sym">)    </span><span class="src-var">$proxy_ip </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_X_FORWARDED_FOR'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3459"></a>&nbsp;</li>
<li><a name="a3460"></a>        <span class="src-comm">// Proxy is used, see if the specified Client IP is valid.</span></li>
<li><a name="a3461"></a>        <span class="src-comm">// Sometimes it's 10.x.x.x or 127.x.x.x... Just making sure.</span></li>
<li><a name="a3462"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$proxy_ip</span><span class="src-sym">)</span></li>
<li><a name="a3463"></a>        <span class="src-sym">{</span></li>
<li><a name="a3464"></a>            <span class="src-var">$ip_list </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3465"></a>            <span class="src-key">if </span><span class="src-sym">( </span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">&quot;/^([0-9]+\.[0-9]+\.[0-9]+\.[0-9]+)/&quot;</span><span class="src-sym">, </span><span class="src-var">$proxy_ip</span><span class="src-sym">, </span><span class="src-var">$ip_list</span><span class="src-sym">) )</span></li>
<li><a name="a3466"></a>            <span class="src-sym">{</span></li>
<li><a name="a3467"></a>                <span class="src-var">$private_ip    </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'/^0\./'</span><span class="src-sym">, </span><span class="src-str">'/^127\.0\.0\.1/'</span><span class="src-sym">, </span><span class="src-str">'/^192\.168\..*/'</span><span class="src-sym">, </span><span class="src-str">'/^172\.16\..*/'</span><span class="src-sym">, </span><span class="src-str">'/^10.\.*/'</span><span class="src-sym">, </span><span class="src-str">'/^224.\.*/'</span><span class="src-sym">, </span><span class="src-str">'/^240.\.*/'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3468"></a>                <span class="src-var">$client_ip    </span>= <a href="http://www.php.net/preg_replace">preg_replace</a><span class="src-sym">(</span><span class="src-var">$private_ip</span><span class="src-sym">, </span><span class="src-var">$client_ip</span><span class="src-sym">, </span><span class="src-var">$ip_list</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3469"></a>            <span class="src-sym">}</span></li>
<li><a name="a3470"></a>        <span class="src-sym">}</span></li>
<li><a name="a3471"></a>&nbsp;</li>
<li><a name="a3472"></a>        <span class="src-key">return </span><span class="src-var">$client_ip</span><span class="src-sym">;</span></li>
<li><a name="a3473"></a>    <span class="src-sym">}</span></li>
<li><a name="a3474"></a>&nbsp;</li>
<li><a name="a3475"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3476"></a><span class="src-doc">     * Verify EAN</span></li>
<li><a name="a3477"></a><span class="src-doc">     *</span></li>
<li><a name="a3478"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$ean </span></li>
<li><a name="a3479"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$type </span><span class="src-doc">   type of EAN: {default: EAN13}</span></li>
<li><a name="a3480"></a><span class="src-doc">     *                             EAN8,EAN13,EAN14,UPC12,ILN,NVE18</span></li>
<li><a name="a3481"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span></li>
<li><a name="a3482"></a><span class="src-doc">     */</span></li>
<li><a name="a3483"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodcheckEAN">checkEAN</a><span class="src-sym">(</span><span class="src-var">$ean</span><span class="src-sym">,</span><span class="src-var">$type</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a3484"></a>    <span class="src-sym">{</span></li>
<li><a name="a3485"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3486"></a>&nbsp;</li>
<li><a name="a3487"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodcheckNumber">checkNumber</a><span class="src-sym">(</span><span class="src-var">$ean</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-id">false</span><span class="src-sym">)) </span><span class="src-comm">// only positive, integer numbers</span></li>
<li><a name="a3488"></a>        <span class="src-sym">{</span></li>
<li><a name="a3489"></a>            <span class="src-var">$len  </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$ean</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3490"></a>            <span class="src-var">$factor        </span>= <span class="src-num">3</span><span class="src-sym">;</span></li>
<li><a name="a3491"></a>            <span class="src-var">$sum        </span>= <span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3492"></a>            <span class="src-var">$run_mode    </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3493"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)) </span><span class="src-var">$type </span>= <a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3494"></a>&nbsp;</li>
<li><a name="a3495"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$type</span>==<span class="src-str">&quot;EAN8&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$len</span>==<span class="src-num">8</span><span class="src-sym">))                                </span><span class="src-var">$run_mode </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3496"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(((</span><span class="src-var">$type</span>==<span class="src-str">&quot;EAN13&quot;</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$type</span>==<span class="src-str">&quot;ILN&quot;</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$len</span>==<span class="src-num">13</span><span class="src-sym">))    </span><span class="src-var">$run_mode </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3497"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$type</span>==<span class="src-str">&quot;EAN14&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$len</span>==<span class="src-num">14</span><span class="src-sym">))                        </span><span class="src-var">$run_mode </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3498"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$type</span>==<span class="src-str">&quot;UPC12&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$len</span>==<span class="src-num">12</span><span class="src-sym">))                        </span><span class="src-var">$run_mode </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3499"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$type</span>==<span class="src-str">&quot;NVE18&quot;</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$len</span>==<span class="src-num">18</span><span class="src-sym">))                        </span><span class="src-var">$run_mode </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3500"></a>&nbsp;</li>
<li><a name="a3501"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$run_mode</span><span class="src-sym">)</span></li>
<li><a name="a3502"></a>            <span class="src-sym">{</span></li>
<li><a name="a3503"></a>                <span class="src-var">$rest </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$ean</span><span class="src-sym">,</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3504"></a>                <span class="src-var">$wert </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$ean</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$len</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3505"></a>&nbsp;</li>
<li><a name="a3506"></a>                <span class="src-key">for </span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-sym">(</span><span class="src-var">$len</span>-<span class="src-num">1</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$i</span>&gt;<span class="src-num">0</span><span class="src-sym">;</span>--<span class="src-var">$i</span><span class="src-sym">)</span></li>
<li><a name="a3507"></a>                <span class="src-sym">{</span></li>
<li><a name="a3508"></a>                     <span class="src-var">$sum    </span>= <span class="src-var">$sum </span>+ <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$wert</span><span class="src-sym">,</span><span class="src-var">$i</span>-<span class="src-num">1</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">) </span>* <span class="src-var">$factor</span><span class="src-sym">;</span></li>
<li><a name="a3509"></a>                     <span class="src-var">$factor    </span>= <span class="src-num">4 </span>- <span class="src-var">$factor</span><span class="src-sym">;</span></li>
<li><a name="a3510"></a>                   <span class="src-sym">}</span></li>
<li><a name="a3511"></a>                   <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rest</span>==<span class="src-sym">((</span><span class="src-num">1000</span>-<span class="src-var">$sum</span><span class="src-sym">)</span>%<span class="src-num">10</span><span class="src-sym">))    </span><span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3512"></a>            <span class="src-sym">}</span></li>
<li><a name="a3513"></a>        <span class="src-sym">}</span></li>
<li><a name="a3514"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3515"></a>    <span class="src-sym">}</span></li>
<li><a name="a3516"></a>&nbsp;</li>
<li><a name="a3517"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3518"></a><span class="src-doc">     * Return size of image file</span></li>
<li><a name="a3519"></a><span class="src-doc">     *</span></li>
<li><a name="a3520"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$filename </span></li>
<li><a name="a3521"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">int </span></li>
<li><a name="a3522"></a><span class="src-doc">     */</span></li>
<li><a name="a3523"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_image_size">get_image_size</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span></li>
<li><a name="a3524"></a>    <span class="src-sym">{</span></li>
<li><a name="a3525"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3526"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="../cphplib/cphplib.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">))</span></li>
<li><a name="a3527"></a>        <span class="src-sym">{</span></li>
<li><a name="a3528"></a>            <span class="src-var">$img_info </span>= <a href="http://www.php.net/getimagesize">getimagesize</a><span class="src-sym">(</span><span class="src-var">$filename</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3529"></a>            <span class="src-var">$rc </span>= <span class="src-str">&quot; &quot;</span>.<span class="src-var">$img_info</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3530"></a>        <span class="src-sym">}</span></li>
<li><a name="a3531"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3532"></a>    <span class="src-sym">}</span></li>
<li><a name="a3533"></a>&nbsp;</li>
<li><a name="a3534"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3535"></a><span class="src-doc">     * shorten text to given length for display</span></li>
<li><a name="a3536"></a><span class="src-doc">     *</span></li>
<li><a name="a3537"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$text </span><span class="src-doc">       text string</span></li>
<li><a name="a3538"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$max_length </span><span class="src-doc">   maximum lenght of text</span></li>
<li><a name="a3539"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$dots </span><span class="src-doc">       hars for dots {default: ...}</span></li>
<li><a name="a3540"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a3541"></a><span class="src-doc">     */</span></li>
<li><a name="a3542"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodtext_shorten">text_shorten</a><span class="src-sym">(</span><span class="src-var">$text</span><span class="src-sym">, </span><span class="src-var">$max_length</span><span class="src-sym">, </span><span class="src-var">$dots</span>=<span class="src-str">&quot;...&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3543"></a>    <span class="src-sym">{</span></li>
<li><a name="a3544"></a>        <span class="src-var">$text_l </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$text</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3545"></a>        <span class="src-var">$dots_l </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$dots</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3546"></a>&nbsp;</li>
<li><a name="a3547"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$text_l</span>&gt;<span class="src-var">$dots_l</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$text_l</span>&gt;<span class="src-var">$max_length</span><span class="src-sym">))</span></li>
<li><a name="a3548"></a>        <span class="src-sym">{</span></li>
<li><a name="a3549"></a>            <span class="src-var">$rc </span>= <a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$text</span><span class="src-sym">, </span><span class="src-num">0</span><span class="src-sym">, </span><span class="src-var">$max_length</span><span class="src-sym">)</span>.<span class="src-var">$dots</span><span class="src-sym">;</span></li>
<li><a name="a3550"></a>        <span class="src-sym">}</span></li>
<li><a name="a3551"></a>        <span class="src-key">else</span></li>
<li><a name="a3552"></a>        <span class="src-sym">{</span></li>
<li><a name="a3553"></a>            <span class="src-var">$rc </span>= <span class="src-var">$text</span><span class="src-sym">;</span></li>
<li><a name="a3554"></a>        <span class="src-sym">}</span></li>
<li><a name="a3555"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3556"></a>    <span class="src-sym">}</span></li>
<li><a name="a3557"></a>&nbsp;</li>
<li><a name="a3558"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3559"></a><span class="src-doc">     * convert rgb to decimal color code</span></li>
<li><a name="a3560"></a><span class="src-doc">     *</span></li>
<li><a name="a3561"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$rgbstr </span><span class="src-doc">   rgb string</span></li>
<li><a name="a3562"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">           decimal color code</span></li>
<li><a name="a3563"></a><span class="src-doc">     */</span></li>
<li><a name="a3564"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodrgb2dec">rgb2dec</a><span class="src-sym">(</span><span class="src-var">$rgbstr</span><span class="src-sym">)</span></li>
<li><a name="a3565"></a>    <span class="src-sym">{</span></li>
<li><a name="a3566"></a>        <span class="src-var">$c </span>= <span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3567"></a>&nbsp;</li>
<li><a name="a3568"></a>        <a href="http://www.php.net/ereg">ereg</a><span class="src-sym">(</span><span class="src-str">&quot;([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})&quot;</span><span class="src-sym">, </span><a href="http://www.php.net/strtoupper">strtoupper</a><span class="src-sym">(</span><span class="src-var">$rgbstr</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$c</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3569"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">0</span><span class="src-sym">]</span><span class="src-sym">)</span></li>
<li><a name="a3570"></a>        <span class="src-sym">{</span></li>
<li><a name="a3571"></a>            <span class="src-var">$arr</span><span class="src-sym">[</span><span class="src-str">'r'</span><span class="src-sym">]</span>= <a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">1</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3572"></a>            <span class="src-var">$arr</span><span class="src-sym">[</span><span class="src-str">'g'</span><span class="src-sym">]</span>= <a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">2</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3573"></a>            <span class="src-var">$arr</span><span class="src-sym">[</span><span class="src-str">'b'</span><span class="src-sym">]</span>= <a href="http://www.php.net/hexdec">hexdec</a><span class="src-sym">(</span><span class="src-var">$c</span><span class="src-sym">[</span><span class="src-num">3</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3574"></a>        <span class="src-sym">}</span></li>
<li><a name="a3575"></a>        <span class="src-key">return </span><span class="src-var">$arr</span><span class="src-sym">;</span></li>
<li><a name="a3576"></a>    <span class="src-sym">}</span></li>
<li><a name="a3577"></a>&nbsp;</li>
<li><a name="a3578"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3579"></a><span class="src-doc">     * check, if client IP or hostname is in access list</span></li>
<li><a name="a3580"></a><span class="src-doc">     *</span></li>
<li><a name="a3581"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$hosts </span><span class="src-doc">   array with hostnames, which have access</span></li>
<li><a name="a3582"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$ips </span><span class="src-doc">   array with ips, which have access</span></li>
<li><a name="a3583"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$mode </span><span class="src-doc">   client, client ips (REMOTE_ADDR) {default}</span></li>
<li><a name="a3584"></a><span class="src-doc">     *                             server, client ips (SERVER_ADDR)</span></li>
<li><a name="a3585"></a><span class="src-doc">     *                             referrer (HTTP_REFERER)</span></li>
<li><a name="a3586"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">           true    : access</span></li>
<li><a name="a3587"></a><span class="src-doc">     *                             false    : no access</span></li>
<li><a name="a3588"></a><span class="src-doc">     */</span></li>
<li><a name="a3589"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodnet_access">net_access</a><span class="src-sym">(</span><span class="src-var">$hosts</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$ips</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$mode</span>=<span class="src-str">&quot;client&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3590"></a>    <span class="src-sym">{</span></li>
<li><a name="a3591"></a>        <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3592"></a>&nbsp;</li>
<li><a name="a3593"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-str">&quot;server&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3594"></a>        <span class="src-sym">{</span></li>
<li><a name="a3595"></a>            <span class="src-var">$test_ip    </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_ADDR'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3596"></a>            <span class="src-var">$test_host    </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_NAME'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3597"></a>        <span class="src-sym">}</span></li>
<li><a name="a3598"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$mode</span>==<span class="src-str">&quot;referer&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3599"></a>        <span class="src-sym">{</span></li>
<li><a name="a3600"></a>            <span class="src-var">$referer </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_REFERER'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3601"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$referer</span><span class="src-sym">))</span></li>
<li><a name="a3602"></a>            <span class="src-sym">{</span></li>
<li><a name="a3603"></a>                <span class="src-key">return </span><span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3604"></a>            <span class="src-sym">}</span></li>
<li><a name="a3605"></a>            <span class="src-key">else</span></li>
<li><a name="a3606"></a>            <span class="src-sym">{</span></li>
<li><a name="a3607"></a>                <span class="src-var">$uinfo </span>= <a href="http://www.php.net/parse_url">parse_url</a><span class="src-sym">(</span><span class="src-var">$referer</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3608"></a>                <span class="src-var">$test_host    </span>= <span class="src-var">$uinfo</span><span class="src-sym">[</span><span class="src-str">'host'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3609"></a>                <span class="src-var">$test_ip    </span>= <a href="http://www.php.net/gethostbyname">gethostbyname</a><span class="src-sym">(</span><span class="src-var">$test_host</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3610"></a>            <span class="src-sym">}</span></li>
<li><a name="a3611"></a>        <span class="src-sym">}</span></li>
<li><a name="a3612"></a>        <span class="src-key">else </span><span class="src-comm">// client</span></li>
<li><a name="a3613"></a>        <span class="src-sym">{</span></li>
<li><a name="a3614"></a>            <span class="src-var">$test_ip    </span>= <span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'REMOTE_ADDR'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3615"></a>            <span class="src-var">$test_host    </span>= <a href="http://www.php.net/gethostbyaddr">gethostbyaddr</a><span class="src-sym">(</span><span class="src-var">$test_ip</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3616"></a>        <span class="src-sym">}</span></li>
<li><a name="a3617"></a>&nbsp;</li>
<li><a name="a3618"></a>        <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$ips</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$test_ip</span><span class="src-sym">)))</span></li>
<li><a name="a3619"></a>        <span class="src-sym">{</span></li>
<li><a name="a3620"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$ips </span><span class="src-key">as </span><span class="src-var">$tmp_ip</span><span class="src-sym">)</span></li>
<li><a name="a3621"></a>            <span class="src-sym">{</span></li>
<li><a name="a3622"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$tmp_ip</span><span class="src-sym">) </span><span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3623"></a>                <span class="src-var">$regexp </span>= <a href="http://www.php.net/preg_quote">preg_quote</a><span class="src-sym">(</span><span class="src-var">$tmp_ip</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3624"></a>                <span class="src-var">$regexp </span>= <span class="src-str">&quot;</span><span class="src-str">/<span class="src-var">$regexp</span>/<span class="src-id">i</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3625"></a>                <span class="src-key">if </span><span class="src-sym">( </span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$regexp</span><span class="src-sym">, </span><span class="src-var">$test_ip</span><span class="src-sym">) </span>== <span class="src-id">true </span><span class="src-sym">)</span></li>
<li><a name="a3626"></a>                    <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3627"></a>            <span class="src-sym">}</span></li>
<li><a name="a3628"></a>        <span class="src-sym">}</span></li>
<li><a name="a3629"></a>&nbsp;</li>
<li><a name="a3630"></a>        <span class="src-comm">// if no valid ip was found, check host names</span></li>
<li><a name="a3631"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$rc</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$hosts</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$test_host</span><span class="src-sym">)))</span></li>
<li><a name="a3632"></a>        <span class="src-sym">{</span></li>
<li><a name="a3633"></a>            <span class="src-key">foreach </span><span class="src-sym">(</span><span class="src-var">$hosts </span><span class="src-key">as </span><span class="src-var">$tmp_host</span><span class="src-sym">)</span></li>
<li><a name="a3634"></a>            <span class="src-sym">{</span></li>
<li><a name="a3635"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$tmp_host</span><span class="src-sym">) </span><span class="src-key">continue</span><span class="src-sym">;</span></li>
<li><a name="a3636"></a>                <span class="src-var">$regexp </span>= <a href="http://www.php.net/preg_quote">preg_quote</a><span class="src-sym">(</span><span class="src-var">$tmp_host</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3637"></a>                <span class="src-var">$regexp </span>= <span class="src-str">&quot;</span><span class="src-str">/<span class="src-var">$regexp</span>/<span class="src-id">i</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3638"></a>                <span class="src-key">if </span><span class="src-sym">( </span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-var">$regexp</span><span class="src-sym">, </span><span class="src-var">$test_host</span><span class="src-sym">) </span>== <span class="src-id">true </span><span class="src-sym">)</span></li>
<li><a name="a3639"></a>                    <span class="src-var">$rc </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3640"></a>            <span class="src-sym">}</span></li>
<li><a name="a3641"></a>        <span class="src-sym">}</span></li>
<li><a name="a3642"></a>&nbsp;</li>
<li><a name="a3643"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3644"></a>    <span class="src-sym">}</span></li>
<li><a name="a3645"></a>&nbsp;</li>
<li><a name="a3646"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3647"></a><span class="src-doc">     * pager (navigation) for list</span></li>
<li><a name="a3648"></a><span class="src-doc">     *</span></li>
<li><a name="a3649"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$url </span><span class="src-doc">           link for urls</span></li>
<li><a name="a3650"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$current_entry </span><span class="src-doc">   current page number for navigation</span></li>
<li><a name="a3651"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$max_entries </span><span class="src-doc">   highest page number in navigation</span></li>
<li><a name="a3652"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$page_entries </span><span class="src-doc">   entries per page {default: $this-&gt;page_entries}</span></li>
<li><a name="a3653"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$image_url </span><span class="src-doc">       overwrite global image url</span></li>
<li><a name="a3654"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   html string for paper</span></li>
<li><a name="a3655"></a><span class="src-doc">     */</span></li>
<li><a name="a3656"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodpager">pager</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">, </span><span class="src-var">$current_entry</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$max_entries</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$page_entries</span>=<span class="src-id">null</span><span class="src-sym">, </span><span class="src-var">$image_url</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a3657"></a>    <span class="src-sym">{</span></li>
<li><a name="a3658"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$image_url</span><span class="src-sym">))    </span><span class="src-var">$image_url </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a><span class="src-sym">;</span></li>
<li><a name="a3659"></a>&nbsp;</li>
<li><a name="a3660"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3661"></a>&nbsp;</li>
<li><a name="a3662"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$page_entries</span><span class="src-sym">)) </span><span class="src-var">$page_entries </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$page_entries">page_entries</a><span class="src-sym">;</span></li>
<li><a name="a3663"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$page_entries</span><span class="src-sym">))</span></li>
<li><a name="a3664"></a>        <span class="src-sym">{</span></li>
<li><a name="a3665"></a>            <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-str">&quot;pager&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;page_entries variable not defined!&quot;</span><span class="src-sym">, </span><span class="src-var">$page_entries</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3666"></a>        <span class="src-sym">}</span></li>
<li><a name="a3667"></a>&nbsp;</li>
<li><a name="a3668"></a>        <span class="src-var">$current_page </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$current_entry</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3669"></a>        <span class="src-var">$max_pages      </span>= <a href="http://www.php.net/intval">intval</a><span class="src-sym">(</span><span class="src-var">$max_entries</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3670"></a>&nbsp;</li>
<li><a name="a3671"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">0</span><span class="src-sym">)    </span><span class="src-var">$current_page </span>= <span class="src-num">1</span><span class="src-sym">; </span><span class="src-comm">// 0 is not valid!</span></li>
<li><a name="a3672"></a>&nbsp;</li>
<li><a name="a3673"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$max_entries </span>% <span class="src-var">$page_entries</span>==<span class="src-num">0</span><span class="src-sym">) </span><span class="src-comm">// no rest</span></li>
<li><a name="a3674"></a>            <span class="src-var">$last_page </span>= <span class="src-sym">((</span><span class="src-var">$max_entries</span>/<span class="src-var">$page_entries</span><span class="src-sym">)</span>-<span class="src-num">1</span><span class="src-sym">)</span>*<span class="src-var">$page_entries</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3675"></a>        <span class="src-key">else</span></li>
<li><a name="a3676"></a>            <span class="src-var">$last_page </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$max_entries</span>/<span class="src-var">$page_entries</span><span class="src-sym">)</span>*<span class="src-var">$page_entries</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3677"></a>&nbsp;</li>
<li><a name="a3678"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==-<span class="src-num">1</span><span class="src-sym">) </span><span class="src-var">$current_page </span>= <span class="src-var">$current_entry </span>= <span class="src-var">$last_page</span><span class="src-sym">;</span></li>
<li><a name="a3679"></a>&nbsp;</li>
<li><a name="a3680"></a>        <span class="src-key">if </span><span class="src-sym">((</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$max_entries</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$max_entries</span>&lt;<span class="src-var">$current_entry</span><span class="src-sym">)) </span><span class="src-var">$max_entries </span>= <span class="src-var">$current_entry</span><span class="src-sym">;</span></li>
<li><a name="a3681"></a>&nbsp;</li>
<li><a name="a3682"></a>        <span class="src-var">$current_page </span>= <a href="http://www.php.net/floor">floor</a><span class="src-sym">(</span><span class="src-var">$current_entry</span>/<span class="src-var">$page_entries</span><span class="src-sym">)</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3683"></a>        <span class="src-var">$max_pages    </span>= <a href="http://www.php.net/ceil">ceil</a><span class="src-sym">(</span><span class="src-var">$max_entries</span>/<span class="src-var">$page_entries</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3684"></a>&nbsp;</li>
<li><a name="a3685"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$max_pages</span>&gt;<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a3686"></a>        <span class="src-sym">{</span></li>
<li><a name="a3687"></a>            <span class="src-comm">// Zeige mindestens 5 und wachse bis auf 10</span></li>
<li><a name="a3688"></a>&nbsp;</li>
<li><a name="a3689"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">1</span><span class="src-sym">)      </span><span class="src-var">$show_max </span>= <span class="src-num">5</span><span class="src-sym">;</span></li>
<li><a name="a3690"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">2</span><span class="src-sym">) </span><span class="src-var">$show_max </span>= <span class="src-num">6</span><span class="src-sym">;</span></li>
<li><a name="a3691"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">3</span><span class="src-sym">) </span><span class="src-var">$show_max </span>= <span class="src-num">7</span><span class="src-sym">;</span></li>
<li><a name="a3692"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">4</span><span class="src-sym">) </span><span class="src-var">$show_max </span>= <span class="src-num">8</span><span class="src-sym">;</span></li>
<li><a name="a3693"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-num">5</span><span class="src-sym">) </span><span class="src-var">$show_max </span>= <span class="src-num">9</span><span class="src-sym">;</span></li>
<li><a name="a3694"></a>            <span class="src-key">else                        </span><span class="src-var">$show_max </span>= <span class="src-num">10</span><span class="src-sym">;</span></li>
<li><a name="a3695"></a>&nbsp;</li>
<li><a name="a3696"></a>            <span class="src-var">$prev_page </span>= <span class="src-var">$current_page</span>-<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3697"></a>            <span class="src-var">$next_page </span>= <span class="src-var">$current_page</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3698"></a>&nbsp;</li>
<li><a name="a3699"></a>            <span class="src-var">$prev_entry </span>= <span class="src-sym">(</span><span class="src-var">$prev_page</span>*<span class="src-var">$page_entries</span><span class="src-sym">)</span>-<span class="src-var">$page_entries</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3700"></a>            <span class="src-var">$next_entry </span>= <span class="src-sym">(</span><span class="src-var">$next_page</span>*<span class="src-var">$page_entries</span><span class="src-sym">)</span>-<span class="src-var">$page_entries</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3701"></a>&nbsp;</li>
<li><a name="a3702"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$max_pages</span>&lt;<span class="src-var">$show_max</span><span class="src-sym">)  </span><span class="src-var">$show_max </span>= <span class="src-var">$max_pages</span><span class="src-sym">;</span></li>
<li><a name="a3703"></a>&nbsp;</li>
<li><a name="a3704"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>&gt;<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a3705"></a>            <span class="src-sym">{</span></li>
<li><a name="a3706"></a>                <span class="src-var">$rc </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span>.<span class="src-str">&quot;&amp;amp;spage=1&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$image_url</span>.<span class="src-str">&quot;/arrow_small_prev.gif\&quot; alt=\&quot;&quot;</span>.<span class="src-id">STR_PAGE_FIRST</span>.<span class="src-str">&quot;\&quot; style=\&quot;border: none; vertical-align: bottom;\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_PAGE_FIRST</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status=''\&quot;&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3707"></a>                <span class="src-var">$rc </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span>.<span class="src-str">&quot;</span><span class="src-str">&amp;<span class="src-id">amp</span>;<span class="src-id">spage</span>=<span class="src-var">$prev_entry</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$image_url</span>.<span class="src-str">&quot;/arrow_small_prev2.gif\&quot; alt=\&quot;&quot;</span>.<span class="src-id">STR_PAGE_PREV</span>.<span class="src-str">&quot;\&quot; style=\&quot;border: none; vertical-align: bottom;\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_PAGE_PREV</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status=''\&quot;&quot;</span><span class="src-sym">)</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3708"></a>            <span class="src-sym">}</span></li>
<li><a name="a3709"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;[&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3710"></a>&nbsp;</li>
<li><a name="a3711"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>&gt;<span class="src-num">6</span><span class="src-sym">)</span></li>
<li><a name="a3712"></a>            <span class="src-sym">{</span></li>
<li><a name="a3713"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-var">$max_pages</span><span class="src-sym">)            </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">9</span><span class="src-sym">;</span></li>
<li><a name="a3714"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-sym">(</span><span class="src-var">$max_pages</span>-<span class="src-num">1</span><span class="src-sym">))    </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">8</span><span class="src-sym">;</span></li>
<li><a name="a3715"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-sym">(</span><span class="src-var">$max_pages</span>-<span class="src-num">2</span><span class="src-sym">))    </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">7</span><span class="src-sym">;</span></li>
<li><a name="a3716"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-sym">(</span><span class="src-var">$max_pages</span>-<span class="src-num">3</span><span class="src-sym">))    </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">6</span><span class="src-sym">;</span></li>
<li><a name="a3717"></a>                <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>==<span class="src-sym">(</span><span class="src-var">$max_pages</span>-<span class="src-num">4</span><span class="src-sym">))    </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">5</span><span class="src-sym">;</span></li>
<li><a name="a3718"></a>                <span class="src-key">else                                     </span><span class="src-var">$seite</span>=<span class="src-var">$current_page</span>-<span class="src-num">4</span><span class="src-sym">;</span></li>
<li><a name="a3719"></a>&nbsp;</li>
<li><a name="a3720"></a>                <span class="src-var">$show_max_real</span>=<span class="src-var">$seite</span>+<span class="src-num">9</span><span class="src-sym">;</span></li>
<li><a name="a3721"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$show_max_real</span>&gt;<span class="src-var">$max_pages</span><span class="src-sym">)     </span><span class="src-var">$show_max_real </span>= <span class="src-var">$max_pages</span><span class="src-sym">; </span><span class="src-comm">// error correction</span></li>
<li><a name="a3722"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$seite</span>&lt;<span class="src-num">1</span><span class="src-sym">)                    </span><span class="src-var">$seite</span>=<span class="src-num">1</span><span class="src-sym">;                     </span><span class="src-comm">// error correction</span></li>
<li><a name="a3723"></a>            <span class="src-sym">}</span></li>
<li><a name="a3724"></a>            <span class="src-key">else</span></li>
<li><a name="a3725"></a>            <span class="src-sym">{</span></li>
<li><a name="a3726"></a>                <span class="src-var">$seite</span>=<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3727"></a>                <span class="src-var">$show_max_real</span>=<span class="src-var">$show_max</span><span class="src-sym">;</span></li>
<li><a name="a3728"></a>            <span class="src-sym">}</span></li>
<li><a name="a3729"></a>&nbsp;</li>
<li><a name="a3730"></a>            <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$seite</span><span class="src-sym">;</span><span class="src-sym">(</span><span class="src-var">$seite</span>&lt;=<span class="src-var">$show_max_real</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$seite</span>++<span class="src-sym">)</span></li>
<li><a name="a3731"></a>            <span class="src-sym">{</span></li>
<li><a name="a3732"></a>                <span class="src-var">$site_no </span>= <span class="src-sym">(</span><span class="src-var">$seite</span>*<span class="src-var">$page_entries</span><span class="src-sym">)</span>-<span class="src-var">$page_entries</span>+<span class="src-num">1</span><span class="src-sym">;</span></li>
<li><a name="a3733"></a>                <span class="src-var">$tmp_url </span>= <span class="src-var">$url</span>.<span class="src-str">&quot;</span><span class="src-str">&amp;<span class="src-id">amp</span>;<span class="src-id">spage</span>=<span class="src-var">$site_no</span></span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3734"></a>                <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$seite</span>==<span class="src-var">$current_page</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-var">$seite</span><span class="src-sym">;</span></li>
<li><a name="a3735"></a>                <span class="src-key">else                        </span><span class="src-var">$rc </span>.= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$tmp_url</span><span class="src-sym">,</span><span class="src-var">$seite</span><span class="src-sym">,</span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_PAGE</span>.<span class="src-str">&quot;</span><span class="src-str"> <span class="src-var">$seite</span>';<span class="src-id">return</span> <span class="src-id">true</span>\&quot; <span class="src-id">onmouseout</span>=\&quot;<span class="src-id">window</span>.<span class="src-id">status</span>=''\&quot; <span class="src-id">style</span>=\&quot;<span class="src-id">color</span>: <span class="src-id">black</span>;\&quot;</span><span class="src-str">&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3736"></a>                <span class="src-var">$rc </span>.= <span class="src-str">&quot;&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3737"></a>            <span class="src-sym">}</span></li>
<li><a name="a3738"></a>&nbsp;</li>
<li><a name="a3739"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;]&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3740"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$current_page</span>!=<span class="src-var">$max_pages</span><span class="src-sym">)</span></li>
<li><a name="a3741"></a>            <span class="src-sym">{</span></li>
<li><a name="a3742"></a>                <span class="src-var">$rc </span>.= <span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span>.<span class="src-str">&quot;</span><span class="src-str">&amp;<span class="src-id">amp</span>;<span class="src-id">spage</span>=<span class="src-var">$next_entry</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$image_url</span>.<span class="src-str">&quot;/arrow_small_next2.gif\&quot; alt=\&quot;&quot;</span>.<span class="src-id">STR_PAGE_NEXT</span>.<span class="src-str">&quot;\&quot; style=\&quot;border: none; vertical-align: bottom;\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_PAGE_NEXT</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status=''\&quot;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3743"></a>                <span class="src-var">$rc </span>.= <span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$url</span>.<span class="src-str">&quot;</span><span class="src-str">&amp;<span class="src-id">amp</span>;<span class="src-id">spage</span>=<span class="src-var">$last_page</span></span><span class="src-str">&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$image_url</span>.<span class="src-str">&quot;/arrow_small_next.gif\&quot; alt=\&quot;&quot;</span>.<span class="src-id">STR_PAGE_LAST</span>.<span class="src-str">&quot;\&quot; style=\&quot;border: none; vertical-align: bottom;\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">, </span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_PAGE_LAST</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status=''\&quot;&quot;</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3744"></a>            <span class="src-sym">}</span></li>
<li><a name="a3745"></a>&nbsp;</li>
<li><a name="a3746"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&lt;br&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodend_tag">end_tag</a><span class="src-sym">(</span><span class="src-sym">)</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3747"></a>        <span class="src-sym">}</span></li>
<li><a name="a3748"></a>&nbsp;</li>
<li><a name="a3749"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3750"></a>    <span class="src-sym">}</span></li>
<li><a name="a3751"></a>&nbsp;</li>
<li><a name="a3752"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3753"></a><span class="src-doc">     * Setup HTML header</span></li>
<li><a name="a3754"></a><span class="src-doc">     *</span></li>
<li><a name="a3755"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$customize </span><span class="src-doc">   charset        set charset</span></li>
<li><a name="a3756"></a><span class="src-doc">     *                                 no_cache    if true, page will not be cachable</span></li>
<li><a name="a3757"></a><span class="src-doc">     *                                 gzip        if true, gzip compression will be used</span></li>
<li><a name="a3758"></a><span class="src-doc">     */</span></li>
<li><a name="a3759"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodhtml_header">html_header</a><span class="src-sym">(</span><span class="src-var">$customize</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a3760"></a>    <span class="src-sym">{</span></li>
<li><a name="a3761"></a>        <span class="src-comm">// default values</span></li>
<li><a name="a3762"></a>        <span class="src-var">$charset  </span>= <span class="src-id">STR_CHARACTER_SET</span><span class="src-sym">;</span></li>
<li><a name="a3763"></a>        <span class="src-var">$no_cache </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3764"></a>        <span class="src-var">$gzip     </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3765"></a>&nbsp;</li>
<li><a name="a3766"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'charset'</span><span class="src-sym">]</span><span class="src-sym">))  </span><span class="src-var">$charset  </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'charset'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3767"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'no_cache'</span><span class="src-sym">]</span><span class="src-sym">)) </span><span class="src-var">$no_cache </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'no_cache'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3768"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'gzip'</span><span class="src-sym">]</span><span class="src-sym">))     </span><span class="src-var">$gzip     </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'gzip'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3769"></a>        <span class="src-comm">/////////////////////////////////////////////////////////////////////////////</span></li>
<li><a name="a3770"></a>&nbsp;</li>
<li><a name="a3771"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$gzip</span><span class="src-sym">) </span><a href="http://www.php.net/ob_start">ob_start</a><span class="src-sym">(</span><span class="src-str">'ob_gzhandler'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3772"></a>&nbsp;</li>
<li><a name="a3773"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$no_cache</span><span class="src-sym">)</span></li>
<li><a name="a3774"></a>        <span class="src-sym">{</span></li>
<li><a name="a3775"></a>            <span class="src-var">$now </span>= <a href="http://www.php.net/gmdate">gmdate</a><span class="src-sym">(</span><span class="src-str">'D, d M Y H:i:s'</span><span class="src-sym">)</span>.<span class="src-str">' GMT'</span><span class="src-sym">;</span></li>
<li><a name="a3776"></a>            <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">'Expires: '</span>.<span class="src-var">$now</span><span class="src-sym">)</span><span class="src-sym">;                                                                            </span><span class="src-comm">// rfc2616 - Section 14.21</span></li>
<li><a name="a3777"></a>            <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">'Last-Modified: '</span>.<span class="src-var">$now</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3778"></a>            <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">'Cache-Control: no-store, no-cache, must-revalidate, pre-check=0, post-check=0, max-age=0'</span><span class="src-sym">)</span><span class="src-sym">;  </span><span class="src-comm">// HTTP/1.1</span></li>
<li><a name="a3779"></a>            <a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">'Pragma: no-cache'</span><span class="src-sym">)</span><span class="src-sym">;                                                                          </span><span class="src-comm">// HTTP/1.0</span></li>
<li><a name="a3780"></a>        <span class="src-sym">}</span></li>
<li><a name="a3781"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$charset</span><span class="src-sym">))  </span><a href="http://www.php.net/header">header</a><span class="src-sym">(</span><span class="src-str">'Content-Type: text/html; charset=&quot;'</span>.<span class="src-var">$charset</span>.<span class="src-str">'&quot;'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3782"></a>    <span class="src-sym">}</span></li>
<li><a name="a3783"></a>&nbsp;</li>
<li><a name="a3784"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3785"></a><span class="src-doc">     * Write HTML head</span></li>
<li><a name="a3786"></a><span class="src-doc">     *</span></li>
<li><a name="a3787"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$customize </span><span class="src-doc">   title</span></li>
<li><a name="a3788"></a><span class="src-doc">     *                                 charset</span></li>
<li><a name="a3789"></a><span class="src-doc">     *                                 no_cache</span></li>
<li><a name="a3790"></a><span class="src-doc">     *                                 lang</span></li>
<li><a name="a3791"></a><span class="src-doc">     *                                 seo</span></li>
<li><a name="a3792"></a><span class="src-doc">     *                                 with_header</span></li>
<li><a name="a3793"></a><span class="src-doc">     *                                 print</span></li>
<li><a name="a3794"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a3795"></a><span class="src-doc">     */</span></li>
<li><a name="a3796"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodhtml_head">html_head</a><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">)</span></li>
<li><a name="a3797"></a>    <span class="src-sym">{</span></li>
<li><a name="a3798"></a>        <span class="src-comm">// default values</span></li>
<li><a name="a3799"></a>        <span class="src-var">$title            </span>= <span class="src-str">&quot;no title&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3800"></a>        <span class="src-var">$charset        </span>= <span class="src-id">STR_CHARACTER_SET</span><span class="src-sym">;</span></li>
<li><a name="a3801"></a>        <span class="src-var">$no_cache        </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3802"></a>        <span class="src-var">$lang            </span>= <span class="src-str">&quot;de&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3803"></a>        <span class="src-var">$seo            </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3804"></a>        <span class="src-var">$with_header    </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3805"></a>        <span class="src-var">$print            </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a3806"></a>&nbsp;</li>
<li><a name="a3807"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$xhtml">xhtml</a><span class="src-sym">)    </span><span class="src-var">$doc_mode        </span>= <span class="src-str">&quot;xhtml&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3808"></a>        <span class="src-key">else                 </span><span class="src-var">$doc_mode        </span>= <span class="src-str">&quot;html&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3809"></a>&nbsp;</li>
<li><a name="a3810"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$doc_mode</span>==<span class="src-str">&quot;frame&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3811"></a>        <span class="src-sym">{</span></li>
<li><a name="a3812"></a>            <span class="src-var">$end_sign </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3813"></a>            <span class="src-var">$doctype </span>= <span class="src-str">&quot;&lt;!DOCTYPE html\n\tPUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot;\n\t\&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3814"></a>        <span class="src-sym">}</span></li>
<li><a name="a3815"></a>        <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$doc_mode</span>==<span class="src-str">&quot;html&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3816"></a>        <span class="src-sym">{</span></li>
<li><a name="a3817"></a>            <span class="src-var">$end_sign </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3818"></a>            <span class="src-var">$doctype </span>= <span class="src-str">&quot;&lt;!DOCTYPE html\n\tPUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot;\n\t\&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3819"></a>        <span class="src-sym">}</span></li>
<li><a name="a3820"></a>        <span class="src-key">else</span></li>
<li><a name="a3821"></a>        <span class="src-sym">{</span></li>
<li><a name="a3822"></a>            <span class="src-var">$end_sign </span>= <span class="src-str">&quot; /&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3823"></a>            <span class="src-var">$doc_mode </span>= <span class="src-str">&quot;xhtml&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3824"></a>            <span class="src-var">$doctype </span>= <span class="src-str">&quot;&lt;!DOCTYPE html\n\tPUBLIC \&quot;-//W3C//DTD XHTML 1.0 Transitional//EN\&quot;\n\t\&quot;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3825"></a>        <span class="src-sym">}</span></li>
<li><a name="a3826"></a>&nbsp;</li>
<li><a name="a3827"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">))            </span><span class="src-var">$title            </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'title'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3828"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'charset'</span><span class="src-sym">]</span><span class="src-sym">))        </span><span class="src-var">$charset        </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'charset'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3829"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'no_cache'</span><span class="src-sym">]</span><span class="src-sym">))        </span><span class="src-var">$no_cache        </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'no_cache'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3830"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'lang'</span><span class="src-sym">]</span><span class="src-sym">))            </span><span class="src-var">$lang            </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'lang'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3831"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'seo'</span><span class="src-sym">]</span><span class="src-sym">))            </span><span class="src-var">$seo            </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'seo'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3832"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'print'</span><span class="src-sym">]</span><span class="src-sym">))            </span><span class="src-var">$print            </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'print'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3833"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'with_header'</span><span class="src-sym">]</span><span class="src-sym">))    </span><span class="src-var">$with_header    </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'with_header'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3834"></a>&nbsp;</li>
<li><a name="a3835"></a>        <span class="src-comm">/////////////////////////////////////////////////////////////////////////////</span></li>
<li><a name="a3836"></a>&nbsp;</li>
<li><a name="a3837"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$with_header</span><span class="src-sym">)    </span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodhtml_header">html_header</a><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3838"></a>&nbsp;</li>
<li><a name="a3839"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3840"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$doc_mode</span>==<span class="src-str">&quot;xhtml&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3841"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;?<span class="src-id">xml</span> <span class="src-id">version</span>=\&quot;1.0\&quot; <span class="src-id">encoding</span>=\&quot;<span class="src-var">$charset</span>\&quot;?&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3842"></a>        <span class="src-var">$rc </span>.= <span class="src-var">$doctype</span><span class="src-sym">;</span></li>
<li><a name="a3843"></a>&nbsp;</li>
<li><a name="a3844"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$doc_mode</span>==<span class="src-str">&quot;xhtml&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3845"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;</span><span class="src-str">&lt;<span class="src-id">html</span> <span class="src-id">xmlns</span>=\&quot;<span class="src-id">http</span>://<span class="src-id">www</span>.<span class="src-id">w3</span>.<span class="src-id">org</span>/1999/<span class="src-id">xhtml</span>\&quot; <span class="src-id">xml</span>:<span class="src-id">lang</span>=\&quot;<span class="src-var">$lang</span>\&quot; <span class="src-id">lang</span>=\&quot;<span class="src-var">$lang</span>\&quot;&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3846"></a>&nbsp;</li>
<li><a name="a3847"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;&lt;head&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3848"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;</span><span class="src-str">\t&lt;<span class="src-id">title</span>&gt;<span class="src-var">$title</span>&lt;/<span class="src-id">title</span>&gt;\n</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3849"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;meta name=\&quot;content-language\&quot; content=\&quot;&quot;</span>.<span class="src-var">$lang</span>.<span class="src-str">&quot;\&quot;&quot;</span>.<span class="src-var">$end_sign</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3850"></a>&nbsp;</li>
<li><a name="a3851"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$seo</span><span class="src-sym">)</span></li>
<li><a name="a3852"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;meta name=\&quot;robots\&quot; content=\&quot;index,follow\&quot;&quot;</span>.<span class="src-var">$end_sign</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3853"></a>        <span class="src-key">else</span></li>
<li><a name="a3854"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;meta name=\&quot;robots\&quot; content=\&quot;noindex,nofollow\&quot;&quot;</span>.<span class="src-var">$end_sign</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3855"></a>&nbsp;</li>
<li><a name="a3856"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$no_cache</span><span class="src-sym">)</span></li>
<li><a name="a3857"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;meta http-equiv=\&quot;expires\&quot; content=\&quot;0\&quot;&quot;</span>.<span class="src-var">$end_sign</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3858"></a>&nbsp;</li>
<li><a name="a3859"></a>        <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'addon'</span><span class="src-sym">]</span><span class="src-sym">))    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;\n&quot;</span>.<span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'addon'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3860"></a>&nbsp;</li>
<li><a name="a3861"></a>        <span class="src-comm">//$rc .= &quot;&lt;/head&gt;\n&quot;;</span></li>
<li><a name="a3862"></a>&nbsp;</li>
<li><a name="a3863"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$print</span><span class="src-sym">)    </span>print <span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3864"></a>&nbsp;</li>
<li><a name="a3865"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3866"></a>    <span class="src-sym">}</span></li>
<li><a name="a3867"></a>&nbsp;</li>
<li><a name="a3868"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3869"></a><span class="src-doc">     * Calculate active URL of an array for validation</span></li>
<li><a name="a3870"></a><span class="src-doc">     * (can be used for multi URL sites (e.g. dyndns)</span></li>
<li><a name="a3871"></a><span class="src-doc">     *</span></li>
<li><a name="a3872"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">    </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$urls </span><span class="src-doc">   an url or an array of urls</span></li>
<li><a name="a3873"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">    </span><span class="src-doc-type">string </span><span class="src-doc">           validated base url</span></li>
<li><a name="a3874"></a><span class="src-doc">     */</span></li>
<li><a name="a3875"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_base_url">get_base_url</a><span class="src-sym">(</span><span class="src-var">$urls</span><span class="src-sym">)</span></li>
<li><a name="a3876"></a>    <span class="src-sym">{</span></li>
<li><a name="a3877"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$urls</span><span class="src-sym">))</span></li>
<li><a name="a3878"></a>        <span class="src-sym">{</span></li>
<li><a name="a3879"></a>            <span class="src-var">$rc </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a3880"></a>&nbsp;</li>
<li><a name="a3881"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'SERVER_PORT'</span><span class="src-sym">]</span>==<span class="src-str">&quot;443&quot;</span><span class="src-sym">)    </span><span class="src-var">$tmp_prot </span>= <span class="src-str">&quot;https&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3882"></a>            <span class="src-key">else                                </span><span class="src-var">$tmp_prot </span>= <span class="src-str">&quot;http&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3883"></a>            <span class="src-var">$tmp_url </span>= <span class="src-var">$tmp_prot</span>.<span class="src-str">&quot;://&quot;</span>.<span class="src-var">$_SERVER</span><span class="src-sym">[</span><span class="src-str">'HTTP_HOST'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a3884"></a>            <span class="src-key">while </span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-sym">, </span><span class="src-var">$url</span><span class="src-sym">) </span>= <a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$urls</span><span class="src-sym">))</span></li>
<li><a name="a3885"></a>            <span class="src-sym">{</span></li>
<li><a name="a3886"></a>                <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/substr_count">substr_count</a><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">, </span><span class="src-var">$tmp_url</span><span class="src-sym">)</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3887"></a>                <span class="src-sym">{</span></li>
<li><a name="a3888"></a>                    <span class="src-var">$rc </span>= <span class="src-var">$url</span><span class="src-sym">;</span></li>
<li><a name="a3889"></a>                    <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a3890"></a>                <span class="src-sym">}</span></li>
<li><a name="a3891"></a>            <span class="src-sym">}</span></li>
<li><a name="a3892"></a>&nbsp;</li>
<li><a name="a3893"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$rc</span>===<span class="src-id">false</span><span class="src-sym">)</span></li>
<li><a name="a3894"></a>            <span class="src-sym">{</span></li>
<li><a name="a3895"></a>                <span class="src-key">die</span><span class="src-sym">(</span><span class="src-id">STR_ACCESS_DENIED</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3896"></a>            <span class="src-sym">}</span></li>
<li><a name="a3897"></a>        <span class="src-sym">}</span></li>
<li><a name="a3898"></a>        <span class="src-key">else</span></li>
<li><a name="a3899"></a>        <span class="src-sym">{</span></li>
<li><a name="a3900"></a>            <span class="src-var">$rc </span>= <span class="src-var">$urls</span><span class="src-sym">;</span></li>
<li><a name="a3901"></a>        <span class="src-sym">}</span></li>
<li><a name="a3902"></a>&nbsp;</li>
<li><a name="a3903"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a3904"></a>    <span class="src-sym">}</span></li>
<li><a name="a3905"></a>&nbsp;</li>
<li><a name="a3906"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3907"></a><span class="src-doc">     * Convert string to javascript compatible output</span></li>
<li><a name="a3908"></a><span class="src-doc">     *</span></li>
<li><a name="a3909"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc-type">string </span><span class="src-doc-var">$string </span></li>
<li><a name="a3910"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc-type">string </span></li>
<li><a name="a3911"></a><span class="src-doc">     */</span></li>
<li><a name="a3912"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodjs_conv">js_conv</a><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span></li>
<li><a name="a3913"></a>    <span class="src-sym">{</span></li>
<li><a name="a3914"></a>        <span class="src-var">$new_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;'&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;\\'&quot;</span><span class="src-sym">, </span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3915"></a>        <span class="src-var">$new_string </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">,</span><span class="src-str">&quot;&amp;quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$new_string</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3916"></a>&nbsp;</li>
<li><a name="a3917"></a>        <span class="src-key">return </span><span class="src-var">$new_string</span><span class="src-sym">;</span></li>
<li><a name="a3918"></a>    <span class="src-sym">}</span></li>
<li><a name="a3919"></a>&nbsp;</li>
<li><a name="a3920"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3921"></a><span class="src-doc">     * Show cphplib error</span></li>
<li><a name="a3922"></a><span class="src-doc">     *</span></li>
<li><a name="a3923"></a><span class="src-doc">     * like error_level is defined</span></li>
<li><a name="a3924"></a><span class="src-doc">     *</span></li>
<li><a name="a3925"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$function </span><span class="src-doc">   cphplib function name</span></li>
<li><a name="a3926"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$message </span><span class="src-doc">   error message</span></li>
<li><a name="a3927"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">mixed </span><span class="src-doc">   </span><span class="src-doc-var">$rc </span><span class="src-doc">           return code</span></li>
<li><a name="a3928"></a><span class="src-doc">     */</span></li>
<li><a name="a3929"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodshow_error">show_error</a><span class="src-sym">(</span><span class="src-var">$function</span><span class="src-sym">, </span><span class="src-var">$message</span><span class="src-sym">, </span><span class="src-var">$rc</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a3930"></a>    <span class="src-sym">{</span></li>
<li><a name="a3931"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$error_level">error_level</a>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a3932"></a>        <span class="src-sym">{</span></li>
<li><a name="a3933"></a>            <span class="src-var">$message </span>= <span class="src-var">$function</span>.<span class="src-str">&quot; error: &quot;</span>.<span class="src-var">$message</span><span class="src-sym">;</span></li>
<li><a name="a3934"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">))</span></li>
<li><a name="a3935"></a>            <span class="src-sym">{</span></li>
<li><a name="a3936"></a>                <span class="src-var">$message </span>.= <span class="src-str">&quot;</span><span class="src-str"> (<span class="src-id">rc</span>=<span class="src-var">$rc</span>)</span><span class="src-str">&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3937"></a>            <span class="src-sym">}</span></li>
<li><a name="a3938"></a>&nbsp;</li>
<li><a name="a3939"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$error_level">error_level</a>==<span class="src-num">3</span><span class="src-sym">)</span></li>
<li><a name="a3940"></a>            <span class="src-sym">{</span></li>
<li><a name="a3941"></a>                <a href="http://www.php.net/call_user_func">call_user_func</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$error_user_function">error_user_function</a><span class="src-sym">, </span><span class="src-var">$message</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3942"></a>            <span class="src-sym">}</span></li>
<li><a name="a3943"></a>            <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$error_level">error_level</a>==<span class="src-num">1</span><span class="src-sym">)</span></li>
<li><a name="a3944"></a>            <span class="src-sym">{</span></li>
<li><a name="a3945"></a>                echo <span class="src-var">$message</span><span class="src-sym">;</span></li>
<li><a name="a3946"></a>            <span class="src-sym">}</span></li>
<li><a name="a3947"></a>            <span class="src-key">else</span></li>
<li><a name="a3948"></a>            <span class="src-sym">{</span></li>
<li><a name="a3949"></a>                <span class="src-key">die</span><span class="src-sym">(</span><span class="src-var">$message</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3950"></a>            <span class="src-sym">}</span></li>
<li><a name="a3951"></a>        <span class="src-sym">}</span></li>
<li><a name="a3952"></a>    <span class="src-sym">}</span></li>
<li><a name="a3953"></a>&nbsp;</li>
<li><a name="a3954"></a>    <span class="src-doc">/**</span></li>
<li><a name="a3955"></a><span class="src-doc">     * Get url for mod_rewrite</span></li>
<li><a name="a3956"></a><span class="src-doc">     *</span></li>
<li><a name="a3957"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$prefix </span><span class="src-doc">           prefix of URL</span></li>
<li><a name="a3958"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$id </span></li>
<li><a name="a3959"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$name </span></li>
<li><a name="a3960"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">bool </span><span class="src-doc">   </span><span class="src-doc-var">$invert_prefix </span><span class="src-doc">   if true, use prefix and id as suffix</span></li>
<li><a name="a3961"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$extension </span><span class="src-doc">       file extention</span></li>
<li><a name="a3962"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a3963"></a><span class="src-doc">     */</span></li>
<li><a name="a3964"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_mod_rewrite_url">get_mod_rewrite_url</a><span class="src-sym">(</span><span class="src-var">$prefix</span><span class="src-sym">, </span><span class="src-var">$id</span><span class="src-sym">, </span><span class="src-var">$name</span>=<span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-var">$invert_prefix</span>=<span class="src-id">false</span><span class="src-sym">, </span><span class="src-var">$extension</span>=<span class="src-str">&quot;.html&quot;</span><span class="src-sym">)</span></li>
<li><a name="a3965"></a>    <span class="src-sym">{</span></li>
<li><a name="a3966"></a>        <span class="src-comm">// configuration for name</span></li>
<li><a name="a3967"></a>        <span class="src-var">$max_length </span>= <span class="src-num">50</span><span class="src-sym">;</span></li>
<li><a name="a3968"></a>        <span class="src-var">$max_hyphen </span>= <span class="src-num">5</span><span class="src-sym">;</span></li>
<li><a name="a3969"></a>&nbsp;</li>
<li><a name="a3970"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$invert_prefix</span><span class="src-sym">)    </span><span class="src-var">$rc </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3971"></a>        <span class="src-key">else                 </span><span class="src-var">$rc </span>= <span class="src-var">$prefix</span>.<span class="src-var">$id</span><span class="src-sym">;</span></li>
<li><a name="a3972"></a>&nbsp;</li>
<li><a name="a3973"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">))</span></li>
<li><a name="a3974"></a>        <span class="src-sym">{</span></li>
<li><a name="a3975"></a>            <span class="src-key">if </span><span class="src-sym">((</span><span class="src-sym">!</span><span class="src-var">$invert_prefix</span><span class="src-sym">) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$rc</span><span class="src-sym">)))    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;_&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3976"></a>&nbsp;</li>
<li><a name="a3977"></a>            <span class="src-var">$name </span>= <span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodget_filename_from_text">get_filename_from_text</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3978"></a>&nbsp;</li>
<li><a name="a3979"></a>            <span class="src-var">$pieces    </span>= <a href="http://www.php.net/explode">explode</a><span class="src-sym">(</span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a3980"></a>&nbsp;</li>
<li><a name="a3981"></a>            <span class="src-comm">// get allowed length and hyphen</span></li>
<li><a name="a3982"></a>            <span class="src-key">if </span><span class="src-sym">((</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span>&gt;<span class="src-var">$max_length</span><span class="src-sym">) </span>|| <span class="src-sym">(</span><span class="src-var">$pieces</span>&gt;<span class="src-num">0</span><span class="src-sym">))</span></li>
<li><a name="a3983"></a>            <span class="src-sym">{</span></li>
<li><a name="a3984"></a>                <span class="src-var">$tmp_name    </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3985"></a>                <span class="src-var">$rc_name    </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3986"></a>&nbsp;</li>
<li><a name="a3987"></a>                <span class="src-var">$cnt</span>=<span class="src-num">0</span><span class="src-sym">;</span></li>
<li><a name="a3988"></a>                <span class="src-key">while</span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-sym">, </span><span class="src-var">$word</span><span class="src-sym">)</span>=<a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$pieces</span><span class="src-sym">))</span></li>
<li><a name="a3989"></a>                <span class="src-sym">{</span></li>
<li><a name="a3990"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cnt</span>&gt;<span class="src-num">0</span><span class="src-sym">)    </span><span class="src-var">$tmp_name </span>.= <span class="src-str">&quot;_&quot;</span><span class="src-sym">;</span></li>
<li><a name="a3991"></a>                    <span class="src-var">$tmp_name </span>.= <span class="src-var">$word</span><span class="src-sym">;</span></li>
<li><a name="a3992"></a>&nbsp;</li>
<li><a name="a3993"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$tmp_name</span><span class="src-sym">)</span>&lt;=<span class="src-var">$max_length</span><span class="src-sym">)</span></li>
<li><a name="a3994"></a>                    <span class="src-sym">{</span></li>
<li><a name="a3995"></a>                        <span class="src-var">$rc_name </span>= <span class="src-var">$tmp_name</span><span class="src-sym">;</span></li>
<li><a name="a3996"></a>                    <span class="src-sym">}</span></li>
<li><a name="a3997"></a>                    <span class="src-key">else</span></li>
<li><a name="a3998"></a>                    <span class="src-sym">{</span></li>
<li><a name="a3999"></a>                        <span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4000"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4001"></a>&nbsp;</li>
<li><a name="a4002"></a>                    <span class="src-var">$cnt</span>++<span class="src-sym">;</span></li>
<li><a name="a4003"></a>&nbsp;</li>
<li><a name="a4004"></a>                    <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cnt</span>==<span class="src-var">$max_hyphen</span><span class="src-sym">) </span><span class="src-key">break</span><span class="src-sym">;</span></li>
<li><a name="a4005"></a>                <span class="src-sym">}</span></li>
<li><a name="a4006"></a>&nbsp;</li>
<li><a name="a4007"></a>                <span class="src-var">$name </span>= <span class="src-var">$rc_name</span><span class="src-sym">;</span></li>
<li><a name="a4008"></a>            <span class="src-sym">}</span></li>
<li><a name="a4009"></a>&nbsp;</li>
<li><a name="a4010"></a>            <span class="src-var">$rc </span>.= <span class="src-var">$name</span><span class="src-sym">;</span></li>
<li><a name="a4011"></a>&nbsp;</li>
<li><a name="a4012"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$invert_prefix</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot;_&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4013"></a>        <span class="src-sym">}</span></li>
<li><a name="a4014"></a>&nbsp;</li>
<li><a name="a4015"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$invert_prefix</span><span class="src-sym">)    </span><span class="src-var">$rc </span>.= <span class="src-var">$prefix</span>.<span class="src-var">$id</span><span class="src-sym">;</span></li>
<li><a name="a4016"></a>&nbsp;</li>
<li><a name="a4017"></a>        <span class="src-var">$rc </span>.= <span class="src-var">$extension</span><span class="src-sym">;</span></li>
<li><a name="a4018"></a>&nbsp;</li>
<li><a name="a4019"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a4020"></a>    <span class="src-sym">}</span></li>
<li><a name="a4021"></a>&nbsp;</li>
<li><a name="a4022"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4023"></a><span class="src-doc">     * Cleanup text from invalid characters for filename</span></li>
<li><a name="a4024"></a><span class="src-doc">     *</span></li>
<li><a name="a4025"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$name </span></li>
<li><a name="a4026"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span></li>
<li><a name="a4027"></a><span class="src-doc">     */</span></li>
<li><a name="a4028"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodget_filename_from_text">get_filename_from_text</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span></li>
<li><a name="a4029"></a>    <span class="src-sym">{</span></li>
<li><a name="a4030"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/strtolower">strtolower</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4031"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;- &quot;</span><span class="src-sym">, </span><span class="src-str">&quot; &quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4032"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot; &quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4033"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;__&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4034"></a>&nbsp;</li>
<li><a name="a4035"></a>        <span class="src-comm">// Umlaute</span></li>
<li><a name="a4036"></a>        <span class="src-var">$trans </span>= <a href="http://www.php.net/get_html_translation_table">get_html_translation_table</a><span class="src-sym">(</span><span class="src-id">HTML_ENTITIES</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4037"></a>        <span class="src-var">$trans </span>= <a href="http://www.php.net/array_flip">array_flip</a><span class="src-sym">(</span><span class="src-var">$trans</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4038"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/strtr">strtr</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">, </span><span class="src-var">$trans</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4039"></a>&nbsp;</li>
<li><a name="a4040"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;ae&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4041"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;oe&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4042"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;ue&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4043"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;ss&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4044"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Ae&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4045"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Oe&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4046"></a>        <span class="src-var">$name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;Ue&quot;</span><span class="src-sym">, </span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4047"></a>&nbsp;</li>
<li><a name="a4048"></a>        <span class="src-comm">// valid characters</span></li>
<li><a name="a4049"></a>        <span class="src-var">$valid </span>= <a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-str">'A'</span><span class="src-sym">, </span><span class="src-str">'Z'</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4050"></a>        <span class="src-var">$valid </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-str">'a'</span><span class="src-sym">, </span><span class="src-str">'z'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$valid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4051"></a>        <span class="src-var">$valid </span>= <a href="http://www.php.net/array_merge">array_merge</a><span class="src-sym">(</span><a href="http://www.php.net/range">range</a><span class="src-sym">(</span><span class="src-str">'0'</span><span class="src-sym">, </span><span class="src-str">'9'</span><span class="src-sym">)</span><span class="src-sym">, </span><span class="src-var">$valid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4052"></a>        <span class="src-var">$valid</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">&quot;-&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4053"></a>        <span class="src-var">$valid</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">&quot;_&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4054"></a>        <span class="src-var">$valid</span><span class="src-sym">[</span><span class="src-sym">] </span>= <span class="src-str">&quot; &quot;</span><span class="src-sym">;</span></li>
<li><a name="a4055"></a>&nbsp;</li>
<li><a name="a4056"></a>        <span class="src-var">$valid </span>= <a href="http://www.php.net/array_flip">array_flip</a><span class="src-sym">(</span><span class="src-var">$valid</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4057"></a>&nbsp;</li>
<li><a name="a4058"></a>        <span class="src-var">$max        </span>= <a href="http://www.php.net/strlen">strlen</a><span class="src-sym">(</span><span class="src-var">$name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4059"></a>        <span class="src-var">$rc_name    </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4060"></a>        <span class="src-key">for</span><span class="src-sym">(</span><span class="src-var">$i</span>=<span class="src-num">0</span><span class="src-sym">; </span><span class="src-var">$i</span>&lt;<span class="src-var">$max</span><span class="src-sym">; </span><span class="src-var">$i</span>++<span class="src-sym">)</span></li>
<li><a name="a4061"></a>        <span class="src-sym">{</span></li>
<li><a name="a4062"></a>            <span class="src-var">$chr </span>= <span class="src-var">$name</span><span class="src-sym">[</span><span class="src-var">$i</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4063"></a>            <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/array_key_exists">array_key_exists</a><span class="src-sym">(</span><span class="src-var">$chr</span><span class="src-sym">, </span><span class="src-var">$valid</span><span class="src-sym">))</span></li>
<li><a name="a4064"></a>            <span class="src-sym">{</span></li>
<li><a name="a4065"></a>                <span class="src-var">$rc_name </span>.= <span class="src-var">$chr</span><span class="src-sym">;</span></li>
<li><a name="a4066"></a>            <span class="src-sym">}</span></li>
<li><a name="a4067"></a>        <span class="src-sym">}</span></li>
<li><a name="a4068"></a>&nbsp;</li>
<li><a name="a4069"></a>        <span class="src-var">$rc_name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;-_&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$rc_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4070"></a>&nbsp;</li>
<li><a name="a4071"></a>        <span class="src-comm">// twice!!!</span></li>
<li><a name="a4072"></a>        <span class="src-var">$rc_name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;__&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$rc_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4073"></a>        <span class="src-var">$rc_name </span>= <a href="http://www.php.net/str_replace">str_replace</a><span class="src-sym">(</span><span class="src-str">&quot;__&quot;</span><span class="src-sym">, </span><span class="src-str">&quot;_&quot;</span><span class="src-sym">, </span><span class="src-var">$rc_name</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4074"></a>&nbsp;</li>
<li><a name="a4075"></a>        <span class="src-key">return </span><span class="src-var">$rc_name</span><span class="src-sym">;</span></li>
<li><a name="a4076"></a>    <span class="src-sym">}</span></li>
<li><a name="a4077"></a>&nbsp;</li>
<li><a name="a4078"></a>    <span class="src-doc">/**</span></li>
<li><a name="a4079"></a><span class="src-doc">     * table header for all tables with optional sort support</span></li>
<li><a name="a4080"></a><span class="src-doc">     *</span></li>
<li><a name="a4081"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$cols </span><span class="src-doc">           colomns array</span></li>
<li><a name="a4082"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">int </span><span class="src-doc">       </span><span class="src-doc-var">$default_col </span><span class="src-doc">   default colomn</span></li>
<li><a name="a4083"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$sort </span><span class="src-doc">           sort order</span></li>
<li><a name="a4084"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">   </span><span class="src-doc-var">$base_url </span><span class="src-doc">       base url for all links</span></li>
<li><a name="a4085"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@param </span><span class="src-doc">   </span><span class="src-doc-type">array </span><span class="src-doc">   </span><span class="src-doc-var">$customize </span><span class="src-doc">       bool    $static            true:    don't use sort header</span></li>
<li><a name="a4086"></a><span class="src-doc">     *                                                               false:    sort header                        {default}</span></li>
<li><a name="a4087"></a><span class="src-doc">     *                                      bool    $use_th            true: th for table vill be used            {default}</span></li>
<li><a name="a4088"></a><span class="src-doc">     *                                                              false: td for table will be used</span></li>
<li><a name="a4089"></a><span class="src-doc">     *                                     int        $max_entries    if &gt; 0: static mode, if max_entries &lt; 2 {default: 2}</span></li>
<li><a name="a4090"></a><span class="src-doc">     *                                     string    $mask            if exists, it will be added on the end of the URL, e.g #mask</span></li>
<li><a name="a4091"></a><span class="src-doc">     *                                      string    $tr_class        CSS class for TR</span></li>
<li><a name="a4092"></a><span class="src-doc">     *                                      string    $th_class        CSS class for TD/TH</span></li>
<li><a name="a4093"></a><span class="src-doc">     * </span><span class="src-doc-coretag">@return </span><span class="src-doc">   </span><span class="src-doc-type">string </span><span class="src-doc">                   html output</span></li>
<li><a name="a4094"></a><span class="src-doc">     */</span></li>
<li><a name="a4095"></a>    <span class="src-key">function </span><a href="../cphplib/cphplib.html#methodtable_header">table_header</a><span class="src-sym">(</span><span class="src-var">$cols</span><span class="src-sym">, </span><span class="src-var">$default_col</span><span class="src-sym">, </span><span class="src-var">$sort</span><span class="src-sym">, </span><span class="src-var">$base_url</span><span class="src-sym">, </span><span class="src-var">$customize</span>=<span class="src-id">null</span><span class="src-sym">)</span></li>
<li><a name="a4096"></a>    <span class="src-sym">{</span></li>
<li><a name="a4097"></a>        <span class="src-var">$static            </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a4098"></a>        <span class="src-var">$use_th            </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a4099"></a>        <span class="src-var">$max_entries    </span>= <span class="src-num">2</span><span class="src-sym">;</span></li>
<li><a name="a4100"></a>        <span class="src-var">$mask            </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4101"></a>        <span class="src-var">$tr_class        </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4102"></a>        <span class="src-var">$td_class        </span>= <span class="src-str">&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4103"></a>&nbsp;</li>
<li><a name="a4104"></a>        <span class="src-key">if </span><span class="src-sym">(</span><a href="http://www.php.net/is_array">is_array</a><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">))</span></li>
<li><a name="a4105"></a>        <span class="src-sym">{</span></li>
<li><a name="a4106"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'static'</span><span class="src-sym">]</span><span class="src-sym">)                </span><span class="src-var">$static         </span>= <span class="src-id">true</span><span class="src-sym">;</span></li>
<li><a name="a4107"></a>            <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'use_th'</span><span class="src-sym">]</span><span class="src-sym">)                </span><span class="src-var">$use_th         </span>= <span class="src-id">false</span><span class="src-sym">;</span></li>
<li><a name="a4108"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'max_entries'</span><span class="src-sym">]</span><span class="src-sym">))    </span><span class="src-var">$max_entries    </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'max_entries'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4109"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'mask'</span><span class="src-sym">]</span><span class="src-sym">))            </span><span class="src-var">$mask            </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'mask'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4110"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'tr_class'</span><span class="src-sym">]</span><span class="src-sym">))        </span><span class="src-var">$tr_class        </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'tr_class'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4111"></a>            <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'td_class'</span><span class="src-sym">]</span><span class="src-sym">))        </span><span class="src-var">$td_class        </span>= <span class="src-var">$customize</span><span class="src-sym">[</span><span class="src-str">'td_class'</span><span class="src-sym">]</span><span class="src-sym">;</span></li>
<li><a name="a4112"></a>        <span class="src-sym">}</span></li>
<li><a name="a4113"></a>&nbsp;</li>
<li><a name="a4114"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$use_th</span><span class="src-sym">)    </span><span class="src-var">$th </span>= <span class="src-str">&quot;th&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4115"></a>        <span class="src-key">else             </span><span class="src-var">$th </span>= <span class="src-str">&quot;td&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4116"></a>&nbsp;</li>
<li><a name="a4117"></a>        <span class="src-var">$rc </span>= <span class="src-str">&quot;\n&lt;!-- ############################## table header ############################ --&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4118"></a>&nbsp;</li>
<li><a name="a4119"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;&lt;tr align=\&quot;left\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4120"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-key">empty</span><span class="src-sym">(</span><span class="src-var">$tr_class</span><span class="src-sym">))    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; class=\&quot;&quot;</span>.<span class="src-var">$tr_class</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4121"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4122"></a>&nbsp;</li>
<li><a name="a4123"></a>        <span class="src-var">$cols_sum </span>= <a href="http://www.php.net/count">count</a><span class="src-sym">(</span><span class="src-var">$cols</span><span class="src-sym">)</span><span class="src-sym">;</span></li>
<li><a name="a4124"></a>&nbsp;</li>
<li><a name="a4125"></a>        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$cols_sum</span>&gt;<span class="src-num">0</span><span class="src-sym">)</span></li>
<li><a name="a4126"></a>        <span class="src-sym">{</span></li>
<li><a name="a4127"></a>            <span class="src-key">while</span><span class="src-sym">(</span>list<span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">)</span>=<a href="http://www.php.net/each">each</a><span class="src-sym">(</span><span class="src-var">$cols</span><span class="src-sym">))</span></li>
<li><a name="a4128"></a>            <span class="src-sym">{</span></li>
<li><a name="a4129"></a>                <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'turn'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'turn'</span><span class="src-sym">]</span>==<span class="src-num">1</span><span class="src-sym">))</span></li>
<li><a name="a4130"></a>                <span class="src-sym">{</span></li>
<li><a name="a4131"></a>                    <span class="src-var">$sort_suffix1    </span>= <span class="src-str">&quot;_asc&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4132"></a>                    <span class="src-var">$sort_suffix2    </span>= <span class="src-str">&quot;_desc&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4133"></a>                    <span class="src-var">$sort_img1        </span>= <span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif\&quot; id=\&quot;order_desc\&quot; alt=\&quot;\&quot; /&gt;&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4134"></a>                    <span class="src-var">$sort_img2         </span>= <span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif\&quot; id=\&quot;order_asc\&quot; alt=\&quot;\&quot; /&gt;&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4135"></a>                    <span class="src-var">$url_addon2        </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_DESC</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status=''\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4136"></a>                    <span class="src-var">$url_img_addon1 </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_ASC</span>.<span class="src-str">&quot;';document.getElementById('order_desc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif';return true\&quot; onmouseout=\&quot;window.status='';document.getElementById('order_desc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif';\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4137"></a>                    <span class="src-var">$url_img_addon2 </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_DESC</span>.<span class="src-str">&quot;';document.getElementById('order_asc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif';return true\&quot; onmouseout=\&quot;window.status='';document.getElementById('order_asc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif';\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4138"></a>                <span class="src-sym">}</span></li>
<li><a name="a4139"></a>                <span class="src-key">else</span></li>
<li><a name="a4140"></a>                <span class="src-sym">{</span></li>
<li><a name="a4141"></a>                    <span class="src-var">$sort_suffix1    </span>= <span class="src-str">&quot;_desc&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4142"></a>                    <span class="src-var">$sort_suffix2    </span>= <span class="src-str">&quot;_asc&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4143"></a>                    <span class="src-var">$sort_img1         </span>= <span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif\&quot; id=\&quot;order_asc\&quot; alt=\&quot;\&quot; /&gt;&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4144"></a>                    <span class="src-var">$sort_img2          </span>= <span class="src-str">&quot;&lt;img src=\&quot;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif\&quot; id=\&quot;order_desc\&quot; alt=\&quot;\&quot; /&gt;&amp;nbsp;&amp;nbsp;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4145"></a>                    <span class="src-var">$url_addon2     </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_ASC</span>.<span class="src-str">&quot;';return true\&quot; onmouseout=\&quot;window.status='';\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4146"></a>                    <span class="src-var">$url_img_addon1 </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_DESC</span>.<span class="src-str">&quot;';document.getElementById('order_asc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif';return true\&quot; onmouseout=\&quot;window.status='';document.getElementById('order_asc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif';\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4147"></a>                    <span class="src-var">$url_img_addon2 </span>= <span class="src-str">&quot;style=\&quot;background: none;\&quot; onmouseover=\&quot;window.status='&quot;</span>.<span class="src-id">STR_SORT_ASC</span>.<span class="src-str">&quot;';document.getElementById('order_desc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_asc.gif';return true\&quot; onmouseout=\&quot;window.status='';document.getElementById('order_desc').src='&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#var$image_url">image_url</a>.<span class="src-str">&quot;/order_desc.gif';\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4148"></a>                <span class="src-sym">}</span></li>
<li><a name="a4149"></a>&nbsp;</li>
<li><a name="a4150"></a>                <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;&quot;</span>.<span class="src-var">$th</span><span class="src-sym">;</span></li>
<li><a name="a4151"></a>                <span class="src-key">if </span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$td_class</span><span class="src-sym">))                                            </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; class=\&quot;&quot;</span>.<span class="src-var">$td_class</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4152"></a>                <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'width'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'width'</span><span class="src-sym">]</span><span class="src-sym">)))</span></li>
<li><a name="a4153"></a>                <span class="src-sym">{</span></li>
<li><a name="a4154"></a>                    <span class="src-var">$rc </span>.= <span class="src-str">&quot; style=\&quot;width: &quot;</span>.<span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'width'</span><span class="src-sym">]</span>*<span class="src-num">1.2</span><span class="src-sym">)</span>.<span class="src-str">&quot;px\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4155"></a>                <span class="src-sym">}</span></li>
<li><a name="a4156"></a>                <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'colspan'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'colspan'</span><span class="src-sym">]</span><span class="src-sym">)))    </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; colspan=\&quot;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'colspan'</span><span class="src-sym">]</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4157"></a>&nbsp;</li>
<li><a name="a4158"></a>                <span class="src-key">if </span><span class="src-sym">((</span>isset<span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'align'</span><span class="src-sym">]</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-sym">!</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'align'</span><span class="src-sym">]</span><span class="src-sym">)))        </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; align=\&quot;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'align'</span><span class="src-sym">]</span>.<span class="src-str">&quot;\&quot;&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4159"></a>                <span class="src-key">else                                                             </span><span class="src-var">$rc </span>.= <span class="src-str">&quot; align=\&quot;left\&quot;&quot;</span><span class="src-sym">;    </span><span class="src-comm">// required for konqueror</span></li>
<li><a name="a4160"></a>&nbsp;</li>
<li><a name="a4161"></a>                <span class="src-key">if </span><span class="src-sym">((</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span><span class="src-sym">)) </span>|| <span class="src-sym">(</span><span class="src-var">$max_entries</span>&lt;<span class="src-num">2</span><span class="src-sym">))</span></li>
<li><a name="a4162"></a>                <span class="src-sym">{</span></li>
<li><a name="a4163"></a>                    <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;nbsp;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4164"></a>                <span class="src-sym">}</span></li>
<li><a name="a4165"></a>                <span class="src-key">else</span></li>
<li><a name="a4166"></a>                <span class="src-sym">{</span></li>
<li><a name="a4167"></a>                    <span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$sort</span>==<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span>.<span class="src-var">$sort_suffix2</span><span class="src-sym">) </span>|| <span class="src-sym">((</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$sort</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$key</span>==<span class="src-var">$default_col</span><span class="src-sym">)))</span></li>
<li><a name="a4168"></a>                    <span class="src-sym">{</span></li>
<li><a name="a4169"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$static</span>==<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a4170"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$sort_img1</span>.<span class="src-str">&quot;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4171"></a>                        <span class="src-key">else</span></li>
<li><a name="a4172"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$base_url</span>.<span class="src-str">&quot;&amp;amp;sort=&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span>.<span class="src-var">$sort_suffix1</span>.<span class="src-var">$mask</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$url_img_addon1</span><span class="src-sym">)</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$sort_img1</span>.<span class="src-str">&quot;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4173"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4174"></a>                    <span class="src-key">else </span><span class="src-key">if </span><span class="src-sym">((</span><span class="src-var">$sort</span>==<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span>.<span class="src-var">$sort_suffix1</span><span class="src-sym">) </span>|| <span class="src-sym">((</span><a href="../cphplib/_cphplib_inc.html#functionisvoid">isvoid</a><span class="src-sym">(</span><span class="src-var">$sort</span><span class="src-sym">)) </span>&amp;&amp; <span class="src-sym">(</span><span class="src-var">$key</span>==<span class="src-var">$default_col</span><span class="src-sym">)))</span></li>
<li><a name="a4175"></a>                    <span class="src-sym">{</span></li>
<li><a name="a4176"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$static</span>==<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a4177"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$sort_img2</span>.<span class="src-str">&quot;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4178"></a>                        <span class="src-key">else</span></li>
<li><a name="a4179"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$base_url</span>.<span class="src-str">&quot;&amp;amp;sort=&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span>.<span class="src-var">$sort_suffix2</span>.<span class="src-var">$mask</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$url_img_addon2</span><span class="src-sym">)</span>.<span class="src-str">&quot;&amp;nbsp;&quot;</span>.<span class="src-var">$sort_img2</span>.<span class="src-str">&quot;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4180"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4181"></a>                    <span class="src-key">else</span></li>
<li><a name="a4182"></a>                    <span class="src-sym">{</span></li>
<li><a name="a4183"></a>                        <span class="src-key">if </span><span class="src-sym">(</span><span class="src-var">$static</span>==<span class="src-id">true</span><span class="src-sym">)</span></li>
<li><a name="a4184"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span>.<span class="src-str">&quot;&amp;nbsp;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4185"></a>                        <span class="src-key">else</span></li>
<li><a name="a4186"></a>                            <span class="src-var">$rc </span>.= <span class="src-str">&quot;&gt;&quot;</span>.<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../cphplib/cphplib.html#methodurl">url</a><span class="src-sym">(</span><span class="src-var">$base_url</span>.<span class="src-str">&quot;&amp;amp;sort=&quot;</span>.<span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'value'</span><span class="src-sym">]</span>.<span class="src-var">$sort_suffix2</span>.<span class="src-var">$mask</span><span class="src-sym">, </span><span class="src-var">$value</span><span class="src-sym">[</span><span class="src-str">'name'</span><span class="src-sym">]</span><span class="src-sym">, </span><span class="src-num">1</span><span class="src-sym">,</span><span class="src-str">&quot;&quot;</span><span class="src-sym">,</span><span class="src-var">$url_addon2</span><span class="src-sym">)</span>.<span class="src-str">&quot;&amp;nbsp;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4187"></a>                    <span class="src-sym">}</span></li>
<li><a name="a4188"></a>                <span class="src-sym">}</span></li>
<li><a name="a4189"></a>            <span class="src-sym">}</span></li>
<li><a name="a4190"></a>        <span class="src-sym">}</span></li>
<li><a name="a4191"></a>        <span class="src-key">else</span></li>
<li><a name="a4192"></a>        <span class="src-sym">{</span></li>
<li><a name="a4193"></a>            <span class="src-var">$rc </span>.= <span class="src-str">&quot;\t&lt;&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;&amp;nbsp;&lt;/&quot;</span>.<span class="src-var">$th</span>.<span class="src-str">&quot;&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4194"></a>        <span class="src-sym">}</span></li>
<li><a name="a4195"></a>&nbsp;</li>
<li><a name="a4196"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;&lt;/tr&gt;\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4197"></a>        <span class="src-var">$rc </span>.= <span class="src-str">&quot;&lt;!-- ############################## table header end ############################ --&gt;\n\n&quot;</span><span class="src-sym">;</span></li>
<li><a name="a4198"></a>&nbsp;</li>
<li><a name="a4199"></a>        <span class="src-key">return </span><span class="src-var">$rc</span><span class="src-sym">;</span></li>
<li><a name="a4200"></a>    <span class="src-sym">}</span></li>
<li><a name="a4201"></a><span class="src-sym">}</span></li>
<li><a name="a4202"></a>&nbsp;</li>
<li><a name="a4203"></a><span class="src-php">?&gt;</span></li>
</ol></pre>
</div>
	<p class="notes" id="credit">
		Documentation generated on Fri, 11 Nov 2005 10:39:55 +0100 by <a href="http://www.phpdoc.org" target="_blank">phpDocumentor 1.3.0RC3</a>
	</p>
	</body>
</html>